!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){for(var e=s.indexOf(document.readyState);u<=e;++u){var t=c[s[u]];t&&t()}}var o=n(2),a=r(o),s=["loading","interactive","complete"],c={loading:function(){document.addEventListener("readystatechange",i)},interactive:function(){(0,a["default"])(document.querySelector("canvas"),null,!0),document.removeEventListener("readystatechange",i)}},u=0;i()},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n(3),n(4);var c=n(5),u=i(c),l=n(7),f=i(l),h=n(18),d=i(h),p=n(19),v=i(p),g=n(31),m=i(g),_=n(32),y=i(_),b=n(41),w=i(b),E=n(47),x=i(E),A=n(49),T=i(A),S=n(21),R=i(S),C=n(50),M=i(C),O=n(53),P=n(113),I=(n(127),n(128)),N=r(I),D=n(130),L=i(D),F=n(131),k=i(F),U=n(132),j=i(U),B=n(136),V=i(B),z=n(250),G=i(z),H=n(251),X=n(255),Y=R["default"].parse(location.search.slice(1)),q=(0,O.defaults)().state;t["default"]=function(e,t,n){function r(){T["default"].div(B.spawnSize,z,p.viewSize),B.respawn(p)}function i(){W.buffer=p.particles.buffers[0],W.spawnSize=p.particles.shape,W.respawn(p)}function c(){J&&(K.setPixels(J),K.respawn(p))}function l(){K.buffer.shape=[J.videoWidth,J.videoHeight],x["default"].scale(K.spawnMatrix,K.spawnMatrix,[-1,1])}function h(){e.width=self.innerWidth,e.height=self.innerHeight}var p=void 0,g=void 0,_=void 0,b=void 0,E=void 0,A=void 0,S=void 0,R={audible:!("mute"in Y),track:!0,trackBeatAt:.1,trackLoudAt:9,mic:!0,micBeatAt:1,micLoudAt:5},C=s({},R),I=(0,u["default"])(e,O.glSettings,function(){p.draw(),I.viewport.apply(I,[0,0].concat(o(p.flow.shape))),p.flow.bind(),Object.assign(g.line.uniforms,p.state),g.trimOld(1/p.state.flowDecay+100,p.getTime()).update().draw();var e=null;if(C.track&&b&&E&&(b.frequencies((0,P.step)(E[0])),(0,X.orderLogRates)(E,p.dt),(0,X.mean)(E[E.length-1][0])>C.trackBeatAt?(e=c,console.log("track beat")):(0,X.sum)(E[1][0])>C.trackLoudAt&&(e=r,console.log("track volume"))),!e&&C.mic&&A&&S){A.frequencies((0,P.step)(S[0])),(0,X.orderLogRates)(S,p.dt);var t=S[S.length-1][0];(0,X.weightedMean)(t,.2*t.length)>C.micBeatAt?(e=c,console.log("mic beat")):(0,X.peak)(S[1][0])>C.micLoudAt&&(e=r(),console.log("mic volume"))}e&&e()});p=new O.Tendrils(I),g=new V["default"](I);var D=function(t){g.times.push(p.getTime());var n=(0,m["default"])(t,e,T["default"].create());n[0]=(0,w["default"])(n[0],0,p.viewRes[0],-1,1),n[1]=(0,w["default"])(n[1],0,p.viewRes[1],1,-1),g.line.path.push(n)};e.addEventListener("pointermove",D,!1);var F=(0,j["default"])(I),U=p.state,B=new N.SpawnPixels(I,{shader:[N.defaults().shader[0],L["default"]],buffer:p.flow}),z=[1,-1],W=new N.SpawnPixels(I,{shader:[N.defaults().shader[0],k["default"]],buffer:null}),K=new N.SpawnPixels(I),J=null;(0,f["default"])({video:!0,audio:!0},function(e,t){if(e)throw e;!function(){J=document.createElement("video"),J.muted=!0,J.src=self.URL.createObjectURL(t),J.play(),J.addEventListener("canplay",l),A=(0,d["default"])(t,{audible:!1}),A.analyser.fftSize=Math.pow(2,8);var e=2;S=(0,H.makeOrderLog)(e,function(t){return(0,H.makeLog)(t,function(){return(0,G["default"])(A,t===e?Uint8Array:Float32Array)})})}()});var $=function(e){var t=arguments.length<=1||void 0===arguments[1]?document.body:arguments[1],n=Object.assign(new Audio,{crossOrigin:"Anonymous",src:e,controls:!0});b=(0,d["default"])(n,{audible:C.audible}),b.analyser.fftSize=Math.pow(2,5);var r=3;return E=(0,H.makeOrderLog)(r,function(e){return(0,H.makeLog)(e,function(){return(0,G["default"])(b,e===r?Uint8Array:Float32Array)})}),n.play(),t.appendChild(n),n},Z=Y.track||"https://soundcloud.com/max-cooper/waves-1";Z.match(/^(https?\:\/\/)?(www\.)?soundcloud\.com\//gi)?(0,v["default"])({client_id:"75aca2e2b815f9f5d4e92916c7b80846",song:Z,dark:!1},function(e,t,n,r){if(e)throw e;_=$(t,r.querySelector(".npm-scb-info"))}):$(Z,e.parentElement),self.addEventListener("resize",(0,y["default"])(h,200),!1),h(),p.setup(),p.resetParticles(),F.respawn(p),n&&!function(){var e=function(){for(var e in n.__folders)n.__folders[e].__controllers.forEach(function(e){return e.updateDisplay()})},t=function(){p.clear(),F.respawn(p)},n=new M["default"].GUI;n.close();var u=n.addFolder("settings");for(var l in U)if(!a(U[l]).match(/(object|array)/gi)){var f=u.add(U,l);"rootNum"===l&&f.onFinishChange(function(e){p.setup(e),t()}),"respawnAmount"===l&&f.onFinishChange(function(e){p.setupRespawn(U.rootNum,e),p.setupSpawnCache()})}var h={color:U.color.slice(0,3).map(function(e){return 255*e}),alpha:U.color[3],baseColor:U.baseColor.slice(0,3).map(function(e){return 255*e}),baseAlpha:U.baseColor[3]},d=s({},h),v=function(){return Object.assign(U,{color:[].concat(o(d.color.map(function(e){return e/255})),[d.alpha]),baseColor:[].concat(o(d.baseColor.map(function(e){return e/255})),[d.baseAlpha])})};u.addColor(d,"color").onChange(v),u.add(d,"alpha").onChange(v),u.addColor(d,"baseColor").onChange(v),u.add(d,"baseAlpha").onChange(v),v();var g=n.addFolder("respawn");for(var m in F.uniforms)a(F.uniforms[m]).match(/(object|array)/gi)||g.add(F.uniforms,m);var _=n.addFolder("audio");for(var y in C){var w=_.add(C,y);"audible"===y&&w.onChange(function(e){var t=b.merger||b.analyser;e?t.connect(b.ctx.destination):t.disconnect()})}var E={cyclingColor:!1,clear:function(){return p.clear()},clearView:function(){return p.clearView()},clearFlow:function(){return p.clearFlow()},respawn:function(){return F.respawn(p)},respawnCam:c,respawnFlow:r,respawnFastest:i,reset:function(){return p.reset()},restart:t},x=n.addFolder("controls");for(var A in E)x.add(E,A);var T=function I(){E.cyclingColor&&(Object.assign(d,{alpha:.2,color:[200*Math.sin(.009*Date.now()),100+155*Math.sin(.006*Date.now()),200+55*Math.sin(.003*Date.now())]}),v()),requestAnimationFrame(I)};T();var S=n.addFolder("presets"),R=function(){E.restart(),e(),v()},O={Flow:function(){Object.assign(U,q,{showFlow:!0,flowWidth:5}),Object.assign(F.uniforms,{radius:.25,speed:.01}),Object.assign(d,h,{alpha:.01,color:[255,255,255]}),E.cyclingColor=!1,R()},Wings:function(){Object.assign(U,q,{showFlow:!1}),Object.assign(F.uniforms,{radius:.1,speed:0}),Object.assign(d,h),E.cyclingColor=!1,R()},Fluid:function(){Object.assign(U,q,{autoClearView:!0,showFlow:!1}),Object.assign(d,h,{alpha:.2,color:[255,255,255]}),E.cyclingColor=!1,R()},"Flow only":function(){Object.assign(U,q,{showFlow:!1,autoClearView:!1,flowDecay:5e-4,forceWeight:.015,wanderWeight:0,speedAlpha:0,respawnAmount:.03}),Object.assign(F.uniforms,{radius:.25,speed:.015}),Object.assign(d,h,{alpha:.8,color:[100,200,255],baseAlpha:.1,baseColor:[0,0,0]}),E.cyclingColor=!1,R()},"Noise only":function(){Object.assign(U,q,{autoClearView:!1,showFlow:!1,flowWeight:0,wanderWeight:.002,noiseSpeed:0,speedAlpha:0}),Object.assign(d,h,{alpha:.01,color:[255,150,0]}),E.cyclingColor=!1,R()},Sea:function(){Object.assign(U,q,{showFlow:!1,flowWidth:5,forceWeight:.015,wanderWeight:.0014,flowDecay:.001,fadeAlpha:10,speedAlpha:0}),Object.assign(F.uniforms,{radius:1,speed:0}),Object.assign(d,h,{alpha:.8,color:[55,155,255]}),E.cyclingColor=!1,R()},"Mad styles":function(){Object.assign(U,q,{showFlow:!1}),Object.assign(d,h),E.cyclingColor=!0,R()},Ghostly:function(){Object.assign(U,q,{showFlow:!1,autoClearView:!1,flowDecay:0}),Object.assign(d,h,{alpha:.006,color:[255,255,255]}),E.cyclingColor=!1,R()},Turbulent:function(){Object.assign(U,q,{showFlow:!1,autoClearView:!1,noiseSpeed:1e-5,noiseScale:18,forceWeight:.014,wanderWeight:.0021,speedAlpha:2e-6}),Object.assign(d,h,{alpha:.9,color:[255,10,10],baseAlpha:.01,baseColor:[0,0,0]}),E.cyclingColor=!1,R()},Crawlink:function(){Object.assign(U,q,{showFlow:!1,autoClearView:!1,noiseSpeed:1e-5,noiseScale:60,forceWeight:.014,wanderWeight:.0021,speedAlpha:2e-6}),Object.assign(d,h,{alpha:1,color:[0,0,0],baseAlpha:.005,baseColor:[255,255,255]}),E.cyclingColor=!1,R()},Roots:function(){Object.assign(U,q,{showFlow:!1,autoClearView:!1,flowDecay:0,noiseSpeed:0,noiseScale:18,forceWeight:.015,wanderWeight:.0023,speedAlpha:5e-5,lineWidth:3}),Object.assign(d,h,{alpha:.03,color:[50,255,50]}),E.cyclingColor=!1,R()},Hairy:function(){Object.assign(U,q,{showFlow:!1,autoClearView:!1,timeStep:1e3/60,flowDecay:.001,wanderWeight:.002,speedAlpha:0}),Object.assign(d,h,{alpha:.9,color:[255,150,255],baseAlpha:.005,baseColor:[0,0,0]}),E.cyclingColor=!1,R()}};for(var P in O)S.add(O,P);O.Flow()}()}},function(e,t){"use strict";var n=["127.0.0.1","0.0.0.0","localhost"];"https:"!==document.location.protocol&&n.indexOf(document.location.hostname)<0&&(document.location.protocol="https:")},function(e,t,n){/*!
	 * PEP v0.4.1 | https://github.com/jquery/PEP
	 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
	 */
!function(t,n){e.exports=n()}(this,function(){"use strict";function e(e,t){t=t||Object.create(null);var n=document.createEvent("Event");n.initEvent(e,t.bubbles||!1,t.cancelable||!1);for(var r,i=2;i<l.length;i++)r=l[i],n[r]=t[r]||f[i];n.buttons=t.buttons||0;var o=0;return o=t.pressure?t.pressure:n.buttons?.5:0,n.x=n.clientX,n.y=n.clientY,n.pointerId=t.pointerId||0,n.width=t.width||0,n.height=t.height||0,n.pressure=o,n.tiltX=t.tiltX||0,n.tiltY=t.tiltY||0,n.pointerType=t.pointerType||"",n.hwTimestamp=t.hwTimestamp||0,n.isPrimary=t.isPrimary||!1,n}function t(){this.array=[],this.size=0}function n(e,t,n,r){this.addCallback=e.bind(r),this.removeCallback=t.bind(r),this.changedCallback=n.bind(r),R&&(this.observer=new R(this.mutationWatcher.bind(this)))}function r(e){return"body /shadow-deep/ "+i(e)}function i(e){return'[touch-action="'+e+'"]'}function o(e){return"{ -ms-touch-action: "+e+"; touch-action: "+e+"; touch-action-delay: none; }"}function a(){if(N){P.forEach(function(e){String(e)===e?(I+=i(e)+o(e)+"\n",D&&(I+=r(e)+o(e)+"\n")):(I+=e.selectors.map(i)+o(e.rule)+"\n",D&&(I+=e.selectors.map(r)+o(e.rule)+"\n"))});var e=document.createElement("style");e.textContent=I,document.head.appendChild(e)}}function s(){if(!window.PointerEvent){if(window.PointerEvent=h,window.navigator.msPointerEnabled){var e=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:e,enumerable:!0}),w.registerSource("ms",ie)}else w.registerSource("mouse",z),void 0!==window.ontouchstart&&w.registerSource("touch",ee);w.register(document)}}function c(e){if(!w.pointermap.has(e))throw new Error("InvalidPointerId")}function u(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:Z},releasePointerCapture:{value:Q}})}var l=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],f=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],h=e,d=window.Map&&window.Map.prototype.forEach,p=d?Map:t;t.prototype={set:function(e,t){return void 0===t?this["delete"](e):(this.has(e)||this.size++,void(this.array[e]=t))},has:function(e){return void 0!==this.array[e]},"delete":function(e){this.has(e)&&(delete this.array[e],this.size--)},get:function(e){return this.array[e]},clear:function(){this.array.length=0,this.size=0},forEach:function(e,t){return this.array.forEach(function(n,r){e.call(t,n,r,this)},this)}};var v=p,g=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],m=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],_={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},y="undefined"!=typeof SVGElementInstance,b={pointermap:new v,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(e,t){var n=t,r=n.events;r&&(r.forEach(function(e){n[e]&&(this.eventMap[e]=n[e].bind(n))},this),this.eventSources[e]=n,this.eventSourceList.push(n))},register:function(e){for(var t,n=this.eventSourceList.length,r=0;r<n&&(t=this.eventSourceList[r]);r++)t.register.call(t,e)},unregister:function(e){for(var t,n=this.eventSourceList.length,r=0;r<n&&(t=this.eventSourceList[r]);r++)t.unregister.call(t,e)},contains:function(e,t){try{return e.contains(t)}catch(n){return!1}},down:function(e){e.bubbles=!0,this.fireEvent("pointerdown",e)},move:function(e){e.bubbles=!0,this.fireEvent("pointermove",e)},up:function(e){e.bubbles=!0,this.fireEvent("pointerup",e)},enter:function(e){e.bubbles=!1,this.fireEvent("pointerenter",e)},leave:function(e){e.bubbles=!1,this.fireEvent("pointerleave",e)},over:function(e){e.bubbles=!0,this.fireEvent("pointerover",e)},out:function(e){e.bubbles=!0,this.fireEvent("pointerout",e)},cancel:function(e){e.bubbles=!0,this.fireEvent("pointercancel",e)},leaveOut:function(e){this.out(e),this.contains(e.target,e.relatedTarget)||this.leave(e)},enterOver:function(e){this.over(e),this.contains(e.target,e.relatedTarget)||this.enter(e)},eventHandler:function(e){if(!e._handledByPE){var t=e.type,n=this.eventMap&&this.eventMap[t];n&&n(e),e._handledByPE=!0}},listen:function(e,t){t.forEach(function(t){this.addEvent(e,t)},this)},unlisten:function(e,t){t.forEach(function(t){this.removeEvent(e,t)},this)},addEvent:function(e,t){e.addEventListener(t,this.boundHandler)},removeEvent:function(e,t){e.removeEventListener(t,this.boundHandler)},makeEvent:function(e,t){this.captureInfo[t.pointerId]&&(t.relatedTarget=null);var n=new h(e,t);return t.preventDefault&&(n.preventDefault=t.preventDefault),n._target=n._target||t.target,n},fireEvent:function(e,t){var n=this.makeEvent(e,t);return this.dispatchEvent(n)},cloneEvent:function(e){for(var t,n=Object.create(null),r=0;r<g.length;r++)t=g[r],n[t]=e[t]||m[r],!y||"target"!==t&&"relatedTarget"!==t||n[t]instanceof SVGElementInstance&&(n[t]=n[t].correspondingUseElement);return e.preventDefault&&(n.preventDefault=function(){e.preventDefault()}),n},getTarget:function(e){var t=this.captureInfo[e.pointerId];return t?e._target!==t&&e.type in _?void 0:t:e._target},setCapture:function(e,t){this.captureInfo[e]&&this.releaseCapture(e),this.captureInfo[e]=t;var n=document.createEvent("Event");n.initEvent("gotpointercapture",!0,!1),n.pointerId=e,this.implicitRelease=this.releaseCapture.bind(this,e),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease),n._target=t,this.asyncDispatchEvent(n)},releaseCapture:function(e){var t=this.captureInfo[e];if(t){var n=document.createEvent("Event");n.initEvent("lostpointercapture",!0,!1),n.pointerId=e,this.captureInfo[e]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease),n._target=t,this.asyncDispatchEvent(n)}},dispatchEvent:function(e){var t=this.getTarget(e);if(t)return t.dispatchEvent(e)},asyncDispatchEvent:function(e){requestAnimationFrame(this.dispatchEvent.bind(this,e))}};b.boundHandler=b.eventHandler.bind(b);var w=b,E={shadow:function(e){if(e)return e.shadowRoot||e.webkitShadowRoot},canTarget:function(e){return e&&Boolean(e.elementFromPoint)},targetingShadow:function(e){var t=this.shadow(e);if(this.canTarget(t))return t},olderShadow:function(e){var t=e.olderShadowRoot;if(!t){var n=e.querySelector("shadow");n&&(t=n.olderShadowRoot)}return t},allShadows:function(e){for(var t=[],n=this.shadow(e);n;)t.push(n),n=this.olderShadow(n);return t},searchRoot:function(e,t,n){if(e){var r,i,o=e.elementFromPoint(t,n);for(i=this.targetingShadow(o);i;){if(r=i.elementFromPoint(t,n)){var a=this.targetingShadow(r);return this.searchRoot(a,t,n)||r}i=this.olderShadow(i)}return o}},owner:function(e){for(var t=e;t.parentNode;)t=t.parentNode;return t.nodeType!==Node.DOCUMENT_NODE&&t.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(t=document),t},findTarget:function(e){var t=e.clientX,n=e.clientY,r=this.owner(e.target);return r.elementFromPoint(t,n)||(r=document),this.searchRoot(r,t,n)}},x=Array.prototype.forEach.call.bind(Array.prototype.forEach),A=Array.prototype.map.call.bind(Array.prototype.map),T=Array.prototype.slice.call.bind(Array.prototype.slice),S=Array.prototype.filter.call.bind(Array.prototype.filter),R=window.MutationObserver||window.WebKitMutationObserver,C="[touch-action]",M={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};n.prototype={watchSubtree:function(e){this.observer&&E.canTarget(e)&&this.observer.observe(e,M)},enableOnSubtree:function(e){this.watchSubtree(e),e===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(e)},installNewSubtree:function(e){x(this.findElements(e),this.addElement,this)},findElements:function(e){return e.querySelectorAll?e.querySelectorAll(C):[]},removeElement:function(e){this.removeCallback(e)},addElement:function(e){this.addCallback(e)},elementChanged:function(e,t){this.changedCallback(e,t)},concatLists:function(e,t){return e.concat(T(t))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(e){return e.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(e){var t=A(e,this.findElements,this);return t.push(S(e,this.isElement)),t.reduce(this.concatLists,[])},mutationWatcher:function(e){e.forEach(this.mutationHandler,this)},mutationHandler:function(e){if("childList"===e.type){var t=this.flattenMutationTree(e.addedNodes);t.forEach(this.addElement,this);var n=this.flattenMutationTree(e.removedNodes);n.forEach(this.removeElement,this)}else"attributes"===e.type&&this.elementChanged(e.target,e.oldValue)}};var O=n,P=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],I="",N=window.PointerEvent||window.MSPointerEvent,D=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,L=w.pointermap,F=25,k=[1,4,2,8,16],U=!1;try{U=1===new MouseEvent("test",{buttons:1}).buttons}catch(j){}var B,V={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(e){w.listen(e,this.events)},unregister:function(e){w.unlisten(e,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(e){for(var t,n=this.lastTouches,r=e.clientX,i=e.clientY,o=0,a=n.length;o<a&&(t=n[o]);o++){var s=Math.abs(r-t.x),c=Math.abs(i-t.y);if(s<=F&&c<=F)return!0}},prepareEvent:function(e){var t=w.cloneEvent(e),n=t.preventDefault;return t.preventDefault=function(){e.preventDefault(),n()},t.pointerId=this.POINTER_ID,t.isPrimary=!0,t.pointerType=this.POINTER_TYPE,t},prepareButtonsForMove:function(e,t){var n=L.get(this.POINTER_ID);e.buttons=n?n.buttons:0,t.buttons=e.buttons},mousedown:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=L.get(this.POINTER_ID),n=this.prepareEvent(e);U||(n.buttons=k[n.button],t&&(n.buttons|=t.buttons),e.buttons=n.buttons),L.set(this.POINTER_ID,e),t?w.move(n):w.down(n)}},mousemove:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);U||this.prepareButtonsForMove(t,e),w.move(t)}},mouseup:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=L.get(this.POINTER_ID),n=this.prepareEvent(e);if(!U){var r=k[n.button];n.buttons=t?t.buttons&~r:0,e.buttons=n.buttons}L.set(this.POINTER_ID,e),0===n.buttons||n.buttons===k[n.button]?(this.cleanupMouse(),w.up(n)):w.move(n)}},mouseover:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);U||this.prepareButtonsForMove(t,e),w.enterOver(t)}},mouseout:function(e){if(!this.isEventSimulatedFromTouch(e)){var t=this.prepareEvent(e);U||this.prepareButtonsForMove(t,e),w.leaveOut(t)}},cancel:function(e){var t=this.prepareEvent(e);w.cancel(t),this.cleanupMouse()},cleanupMouse:function(){L["delete"](this.POINTER_ID)}},z=V,G=w.captureInfo,H=E.findTarget.bind(E),X=E.allShadows.bind(E),Y=w.pointermap,q=2500,W=200,K="touch-action",J=!1,$={events:["touchstart","touchmove","touchend","touchcancel"],register:function(e){J?w.listen(e,this.events):B.enableOnSubtree(e)},unregister:function(e){J&&w.unlisten(e,this.events)},elementAdded:function(e){var t=e.getAttribute(K),n=this.touchActionToScrollType(t);n&&(e._scrollType=n,w.listen(e,this.events),X(e).forEach(function(e){e._scrollType=n,w.listen(e,this.events)},this))},elementRemoved:function(e){e._scrollType=void 0,w.unlisten(e,this.events),X(e).forEach(function(e){e._scrollType=void 0,w.unlisten(e,this.events)},this)},elementChanged:function(e,t){var n=e.getAttribute(K),r=this.touchActionToScrollType(n),i=this.touchActionToScrollType(t);r&&i?(e._scrollType=r,X(e).forEach(function(e){e._scrollType=r},this)):i?this.elementRemoved(e):r&&this.elementAdded(e)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(e){var t=e,n=this.scrollTypes;return"none"===t?"none":t===n.XSCROLLER?"X":t===n.YSCROLLER?"Y":n.SCROLLER.exec(t)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(e){return this.firstTouch===e.identifier},setPrimaryTouch:function(e){(0===Y.size||1===Y.size&&Y.has(1))&&(this.firstTouch=e.identifier,this.firstXY={X:e.clientX,Y:e.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(e){e.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var e=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(e,W)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(e){var t=0;return"touchstart"!==e&&"touchmove"!==e||(t=1),t},touchToPointer:function(e){var t=this.currentTouchEvent,n=w.cloneEvent(e),r=n.pointerId=e.identifier+2;n.target=G[r]||H(n),n.bubbles=!0,n.cancelable=!0,n.detail=this.clickCount,n.button=0,n.buttons=this.typeToButtons(t.type),n.width=e.radiusX||e.webkitRadiusX||0,n.height=e.radiusY||e.webkitRadiusY||0,n.pressure=e.force||e.webkitForce||.5,n.isPrimary=this.isPrimaryTouch(e),n.pointerType=this.POINTER_TYPE;var i=this;return n.preventDefault=function(){i.scrolling=!1,i.firstXY=null,t.preventDefault()},n},processTouches:function(e,t){var n=e.changedTouches;this.currentTouchEvent=e;for(var r,i=0;i<n.length;i++)r=n[i],t.call(this,this.touchToPointer(r))},shouldScroll:function(e){if(this.firstXY){var t,n=e.currentTarget._scrollType;if("none"===n)t=!1;else if("XY"===n)t=!0;else{var r=e.changedTouches[0],i=n,o="Y"===n?"X":"Y",a=Math.abs(r["client"+i]-this.firstXY[i]),s=Math.abs(r["client"+o]-this.firstXY[o]);t=a>=s}return this.firstXY=null,t}},findTouch:function(e,t){for(var n,r=0,i=e.length;r<i&&(n=e[r]);r++)if(n.identifier===t)return!0},vacuumTouches:function(e){var t=e.touches;if(Y.size>=t.length){var n=[];Y.forEach(function(e,r){if(1!==r&&!this.findTouch(t,r-2)){var i=e.out;n.push(i)}},this),n.forEach(this.cancelOut,this)}},touchstart:function(e){this.vacuumTouches(e),this.setPrimaryTouch(e.changedTouches[0]),this.dedupSynthMouse(e),this.scrolling||(this.clickCount++,this.processTouches(e,this.overDown))},overDown:function(e){Y.set(e.pointerId,{target:e.target,out:e,outTarget:e.target}),w.over(e),w.enter(e),w.down(e)},touchmove:function(e){this.scrolling||(this.shouldScroll(e)?(this.scrolling=!0,this.touchcancel(e)):(e.preventDefault(),this.processTouches(e,this.moveOverOut)))},moveOverOut:function(e){var t=e,n=Y.get(t.pointerId);if(n){var r=n.out,i=n.outTarget;w.move(t),r&&i!==t.target&&(r.relatedTarget=t.target,t.relatedTarget=i,r.target=i,t.target?(w.leaveOut(r),w.enterOver(t)):(t.target=i,t.relatedTarget=null,this.cancelOut(t))),n.out=t,n.outTarget=t.target}},touchend:function(e){this.dedupSynthMouse(e),this.processTouches(e,this.upOut)},upOut:function(e){this.scrolling||(w.up(e),w.out(e),w.leave(e)),this.cleanUpPointer(e)},touchcancel:function(e){this.processTouches(e,this.cancelOut)},cancelOut:function(e){w.cancel(e),w.out(e),w.leave(e),this.cleanUpPointer(e)},cleanUpPointer:function(e){Y["delete"](e.pointerId),this.removePrimaryPointer(e)},dedupSynthMouse:function(e){var t=z.lastTouches,n=e.changedTouches[0];if(this.isPrimaryTouch(n)){var r={x:n.clientX,y:n.clientY};t.push(r);var i=function(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}.bind(null,t,r);setTimeout(i,q)}}};J||(B=new O($.elementAdded,$.elementRemoved,$.elementChanged,$));var Z,Q,ee=$,te=w.pointermap,ne=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,re={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(e){w.listen(e,this.events)},unregister:function(e){w.unlisten(e,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(e){var t=e;return ne&&(t=w.cloneEvent(e),t.pointerType=this.POINTER_TYPES[e.pointerType]),t},cleanup:function(e){te["delete"](e)},MSPointerDown:function(e){te.set(e.pointerId,e);var t=this.prepareEvent(e);w.down(t)},MSPointerMove:function(e){var t=this.prepareEvent(e);w.move(t)},MSPointerUp:function(e){var t=this.prepareEvent(e);w.up(t),this.cleanup(e.pointerId)},MSPointerOut:function(e){var t=this.prepareEvent(e);w.leaveOut(t)},MSPointerOver:function(e){var t=this.prepareEvent(e);w.enterOver(t)},MSPointerCancel:function(e){var t=this.prepareEvent(e);w.cancel(t),this.cleanup(e.pointerId)},MSLostPointerCapture:function(e){var t=w.makeEvent("lostpointercapture",e);w.dispatchEvent(t)},MSGotPointerCapture:function(e){var t=w.makeEvent("gotpointercapture",e);w.dispatchEvent(t)}},ie=re,oe=window.navigator;oe.msPointerEnabled?(Z=function(e){c(e),this.msSetPointerCapture(e)},Q=function(e){c(e),this.msReleasePointerCapture(e)}):(Z=function(e){c(e),w.setCapture(e,this)},Q=function(e){c(e),w.releaseCapture(e,this)}),a(),s(),u();var ae={dispatcher:w,Installer:O,PointerEvent:h,PointerMap:v,targetFinding:E};return ae})},function(e,t,n){function r(e,t,n){function r(){n(o),i(r)}"function"==typeof t?(n=t,t={}):t=t||{};var o=e.getContext("webgl",t)||e.getContext("webgl-experimental",t)||e.getContext("experimental-webgl",t);if(!o)throw new Error("Unable to initialize WebGL");return n&&i(r),o}var i=n(6);e.exports=r},function(e,t){function n(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-r)),i=setTimeout(e,n);return r=t,i}t=e.exports=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||n;var r=(new Date).getTime(),i=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout;t.cancel=function(e){i.call(window,e)}},function(e,t,n){n(8);e.exports=function(e,t){var n,r=2===arguments.length,i={video:!0,audio:!0},o="PermissionDeniedError",a="PERMISSION_DENIED",s="ConstraintNotSatisfiedError";return r||(t=e,e=i),"undefined"!=typeof navigator&&navigator.getUserMedia?e.audio||e.video?(localStorage&&"true"===localStorage.useFirefoxFakeDevice&&(e.fake=!0),void navigator.mediaDevices.getUserMedia(e).then(function(e){t(null,e)})["catch"](function(e){var n;"string"==typeof e?(n=new Error("MediaStreamError"),e===o||e===a?n.name=o:n.name=s):(n=e,n.name||(n[o]?e.name=o:e.name=s)),t(n)})):(n=new Error("MediaStreamError"),n.name="NoMediaRequestedError",setTimeout(function(){t(n)},0)):(n=new Error("MediaStreamError"),n.name="NotSupportedError",setTimeout(function(){t(n)},0))}},function(e,t,n){"use strict";!function(){var t=n(9).log,r=n(9).browserDetails;e.exports.browserDetails=r,e.exports.extractVersion=n(9).extractVersion,e.exports.disableLog=n(9).disableLog;var i=n(10)||null,o=n(12)||null,a=n(15)||null,s=n(17)||null;switch(r.browser){case"opera":case"chrome":if(!i||!i.shimPeerConnection)return void t("Chrome shim is not included in this adapter release.");t("adapter.js shimming chrome."),e.exports.browserShim=i,i.shimGetUserMedia(),i.shimMediaStream(),i.shimSourceObject(),i.shimPeerConnection(),i.shimOnTrack();break;case"firefox":if(!a||!a.shimPeerConnection)return void t("Firefox shim is not included in this adapter release.");t("adapter.js shimming firefox."),e.exports.browserShim=a,a.shimGetUserMedia(),a.shimSourceObject(),a.shimPeerConnection(),a.shimOnTrack();break;case"edge":if(!o||!o.shimPeerConnection)return void t("MS edge shim is not included in this adapter release.");t("adapter.js shimming edge."),e.exports.browserShim=o,o.shimGetUserMedia(),o.shimPeerConnection();break;case"safari":if(!s)return void t("Safari shim is not included in this adapter release.");t("adapter.js shimming safari."),e.exports.browserShim=s,s.shimGetUserMedia();break;default:t("Unsupported browser!")}}()},function(e,t){"use strict";var n=!0,r={disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(n=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},log:function(){if("object"==typeof window){if(n)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)},detectBrowser:function(){var e={};if(e.browser=null,e.version=null,e.minVersion=null,"undefined"==typeof window||!window.navigator)return e.browser="Not a browser.",e;if(navigator.mozGetUserMedia)e.browser="firefox",e.version=this.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),e.minVersion=31;else if(navigator.webkitGetUserMedia)if(window.webkitRTCPeerConnection)e.browser="chrome",e.version=this.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),e.minVersion=38;else{if(!navigator.userAgent.match(/Version\/(\d+).(\d+)/))return e.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",e;e.browser="safari",e.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/([0-9]+)\./,1),e.minVersion=602}else{if(!navigator.mediaDevices||!navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))return e.browser="Not a supported browser.",e;e.browser="edge",e.version=this.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),e.minVersion=10547}return e.version<e.minVersion&&r.log("Browser: "+e.browser+" Version: "+e.version+" < minimum supported version: "+e.minVersion+"\n some things might not work!"),e}};e.exports={log:r.log,disableLog:r.disableLog,browserDetails:r.detectBrowser(),extractVersion:r.extractVersion}},function(e,t,n){"use strict";var r=n(9).log,i=n(9).browserDetails,o={shimMediaStream:function(){window.MediaStream=window.MediaStream||window.webkitMediaStream},shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){var t=this;this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.addEventListener("addtrack",function(n){var r=new Event("track");r.track=n.track,r.receiver={track:n.track},r.streams=[e.stream],t.dispatchEvent(r)}),e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var t=this;return this._srcObject=e,this.src&&URL.revokeObjectURL(this.src),e?(this.src=URL.createObjectURL(e),e.addEventListener("addtrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)}),void e.addEventListener("removetrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)})):void(this.src="")}}))},shimPeerConnection:function(){window.RTCPeerConnection=function(e,t){r("PeerConnection"),e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=new webkitRTCPeerConnection(e,t),i=n.getStats.bind(n);return n.getStats=function(e,t,n){var r=this,o=arguments;if(arguments.length>0&&"function"==typeof e)return i(e,t);var a=function(e){var t={},n=e.result();return n.forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},s=function(e,t){var n=new Map(Object.keys(e).map(function(t){return[t,e[t]]}));return t=t||e,Object.keys(t).forEach(function(e){n[e]=t[e]}),n};if(arguments.length>=2){var c=function(e){o[1](s(a(e)))};return i.apply(this,[c,arguments[0]])}return new Promise(function(t,n){1===o.length&&"object"==typeof e?i.apply(r,[function(e){t(s(a(e)))},n]):i.apply(r,[function(e){t(s(a(e),e.result()))},n])}).then(t,n)},n},window.RTCPeerConnection.prototype=webkitRTCPeerConnection.prototype,webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return webkitRTCPeerConnection.generateCertificate}}),["createOffer","createAnswer"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var n=1===arguments.length?arguments[0]:void 0;return new Promise(function(r,i){t.apply(e,[r,i,n])})}return t.apply(this,arguments)}}),i.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,n=this,r=new Promise(function(r,i){t.apply(n,[e[0],r,i])});return e.length<2?r:r.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}});var e=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return null===arguments[0]?Promise.resolve():e.apply(this,arguments)},["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}})},attachMediaStream:function(e,t){r("DEPRECATED, attachMediaStream will soon be removed."),i.version>=43?e.srcObject=t:"undefined"!=typeof e.src?e.src=URL.createObjectURL(t):r("Error attaching stream to element.")},reattachMediaStream:function(e,t){r("DEPRECATED, reattachMediaStream will soon be removed."),i.version>=43?e.srcObject=t.srcObject:e.src=t.src}};e.exports={shimMediaStream:o.shimMediaStream,shimOnTrack:o.shimOnTrack,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:n(11),attachMediaStream:o.attachMediaStream,reattachMediaStream:o.reattachMediaStream}},function(e,t,n){"use strict";var r=n(9).log;e.exports=function(){var e=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};"number"==typeof r.ideal?(o[i("min",n)]=r.ideal,t.optional.push(o),o={},o[i("max",n)]=r.ideal,t.optional.push(o)):(o[i("",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},t=function(t,n){if(t=JSON.parse(JSON.stringify(t)),t&&t.audio&&(t.audio=e(t.audio)),t&&"object"==typeof t.video){var i=t.video.facingMode;if(i=i&&("object"==typeof i?i:{ideal:i}),i&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!navigator.mediaDevices.getSupportedConstraints||!navigator.mediaDevices.getSupportedConstraints().facingMode)&&(delete t.video.facingMode,"environment"===i.exact||"environment"===i.ideal))return navigator.mediaDevices.enumerateDevices().then(function(o){o=o.filter(function(e){return"videoinput"===e.kind});var a=o.find(function(e){return e.label.toLowerCase().indexOf("back")!==-1})||o.length&&o[o.length-1];return a&&(t.video.deviceId=i.exact?{exact:a.deviceId}:{ideal:a.deviceId}),t.video=e(t.video),r("chrome: "+JSON.stringify(t)),n(t)});t.video=e(t.video)}return r("chrome: "+JSON.stringify(t)),n(t)},n=function(e){return{name:{PermissionDeniedError:"NotAllowedError",ConstraintNotSatisfiedError:"OverconstrainedError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},i=function(e,r,i){t(e,function(e){navigator.webkitGetUserMedia(e,r,function(e){i(n(e))})})};navigator.getUserMedia=i;var o=function(e){return new Promise(function(t,n){navigator.getUserMedia(e,t,n)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:o,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var a=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return t(e,function(e){return a(e)["catch"](function(e){return Promise.reject(n(e))})})}}else navigator.mediaDevices.getUserMedia=function(e){return o(e)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){r("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){r("Dummy mediaDevices.removeEventListener called.")})}},function(e,t,n){"use strict";var r=n(13),i=n(9).log,o={shimPeerConnection:function(){window.RTCIceGatherer&&(window.RTCIceCandidate||(window.RTCIceCandidate=function(e){return e}),window.RTCSessionDescription||(window.RTCSessionDescription=function(e){return e})),window.RTCPeerConnection=function(e){var t=this,n=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){t[e]=n[e].bind(n)}),this.onicecandidate=null,this.onaddstream=null,this.ontrack=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.localStreams=[],this.remoteStreams=[],this.getLocalStreams=function(){return t.localStreams},this.getRemoteStreams=function(){return t.remoteStreams},this.localDescription=new RTCSessionDescription({type:"",sdp:""}),this.remoteDescription=new RTCSessionDescription({type:"",sdp:""}),this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",this.iceOptions={gatherPolicy:"all",iceServers:[]},e&&e.iceTransportPolicy)switch(e.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=e.iceTransportPolicy;break;case"none":throw new TypeError('iceTransportPolicy "none" not supported')}if(this.usingBundle=e&&"max-bundle"===e.bundlePolicy,e&&e.iceServers){var r=JSON.parse(JSON.stringify(e.iceServers));this.iceOptions.iceServers=r.filter(function(e){if(e&&e.urls){var t=e.urls;return"string"==typeof t&&(t=[t]),t=t.filter(function(e){return 0===e.indexOf("turn:")&&e.indexOf("transport=udp")!==-1})[0],!!t}return!1})}this.transceivers=[],this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype._emitBufferedCandidates=function(){var e=this,t=r.splitSections(e.localDescription.sdp);this._localIceCandidatesBuffer.forEach(function(n){var r=!n.candidate||0===Object.keys(n.candidate).length;if(r)for(var i=1;i<t.length;i++)t[i].indexOf("\r\na=end-of-candidates\r\n")===-1&&(t[i]+="a=end-of-candidates\r\n");else n.candidate.candidate.indexOf("typ endOfCandidates")===-1&&(t[n.candidate.sdpMLineIndex+1]+="a="+n.candidate.candidate+"\r\n");if(e.localDescription.sdp=t.join(""),e.dispatchEvent(n),null!==e.onicecandidate&&e.onicecandidate(n),!n.candidate&&"complete"!==e.iceGatheringState){var o=e.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state;
});o&&(e.iceGatheringState="complete")}}),this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype.addStream=function(e){this.localStreams.push(e.clone()),this._maybeFireNegotiationNeeded()},window.RTCPeerConnection.prototype.removeStream=function(e){var t=this.localStreams.indexOf(e);t>-1&&(this.localStreams.splice(t,1),this._maybeFireNegotiationNeeded())},window.RTCPeerConnection.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},window.RTCPeerConnection.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},window.RTCPeerConnection.prototype._getCommonCapabilities=function(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]};return e.codecs.forEach(function(e){for(var r=0;r<t.codecs.length;r++){var i=t.codecs[r];if(e.name.toLowerCase()===i.name.toLowerCase()&&e.clockRate===i.clockRate&&e.numChannels===i.numChannels){n.codecs.push(i);break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n},window.RTCPeerConnection.prototype._createIceAndDtlsTransports=function(e,t){var n=this,i=new RTCIceGatherer(n.iceOptions),o=new RTCIceTransport(i);i.onlocalcandidate=function(a){var s=new Event("icecandidate");s.candidate={sdpMid:e,sdpMLineIndex:t};var c=a.candidate,u=!c||0===Object.keys(c).length;u?(void 0===i.state&&(i.state="completed"),s.candidate.candidate="candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates"):(c.component="RTCP"===o.component?2:1,s.candidate.candidate=r.writeCandidate(c));var l=r.splitSections(n.localDescription.sdp);s.candidate.candidate.indexOf("typ endOfCandidates")===-1?l[s.candidate.sdpMLineIndex+1]+="a="+s.candidate.candidate+"\r\n":l[s.candidate.sdpMLineIndex+1]+="a=end-of-candidates\r\n",n.localDescription.sdp=l.join("");var f=n.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});switch(n.iceGatheringState){case"new":n._localIceCandidatesBuffer.push(s),u&&f&&n._localIceCandidatesBuffer.push(new Event("icecandidate"));break;case"gathering":n._emitBufferedCandidates(),n.dispatchEvent(s),null!==n.onicecandidate&&n.onicecandidate(s),f&&(n.dispatchEvent(new Event("icecandidate")),null!==n.onicecandidate&&n.onicecandidate(new Event("icecandidate")),n.iceGatheringState="complete");break;case"complete":}},o.onicestatechange=function(){n._updateConnectionState()};var a=new RTCDtlsTransport(o);return a.ondtlsstatechange=function(){n._updateConnectionState()},a.onerror=function(){a.state="failed",n._updateConnectionState()},{iceGatherer:i,iceTransport:o,dtlsTransport:a}},window.RTCPeerConnection.prototype._transceive=function(e,t,n){var i=this._getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:r.localCName},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),n&&e.rtpReceiver&&(i.encodings=e.recvEncodingParameters,i.rtcp={cname:e.cname},e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},window.RTCPeerConnection.prototype.setLocalDescription=function(e){var t,n,i=this;if("offer"===e.type)this._pendingOffer&&(t=r.splitSections(e.sdp),n=t.shift(),t.forEach(function(e,t){var n=r.parseRtpParameters(e);i._pendingOffer[t].localCapabilities=n}),this.transceivers=this._pendingOffer,delete this._pendingOffer);else if("answer"===e.type){t=r.splitSections(i.remoteDescription.sdp),n=t.shift();var o=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach(function(e,t){var a=i.transceivers[t],s=a.iceGatherer,c=a.iceTransport,u=a.dtlsTransport,l=a.localCapabilities,f=a.remoteCapabilities,h="0"===e.split("\n",1)[0].split(" ",2)[1];if(!h){var d=r.getIceParameters(e,n);if(o){var p=r.matchPrefix(e,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return"1"===e.component});p.length&&c.setRemoteCandidates(p)}var v=r.getDtlsParameters(e,n);o&&(v.role="server"),i.usingBundle&&0!==t||(c.start(s,d,o?"controlling":"controlled"),u.start(v));var g=i._getCommonCapabilities(l,f);i._transceive(a,g.codecs.length>0,!1)}})}switch(this.localDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}var a=arguments.length>1&&"function"==typeof arguments[1];if(a){var s=arguments[1];window.setTimeout(function(){s(),"new"===i.iceGatheringState&&(i.iceGatheringState="gathering"),i._emitBufferedCandidates()},0)}var c=Promise.resolve();return c.then(function(){a||("new"===i.iceGatheringState&&(i.iceGatheringState="gathering"),window.setTimeout(i._emitBufferedCandidates.bind(i),500))}),c},window.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t=this,n=new MediaStream,i=[],o=r.splitSections(e.sdp),a=o.shift(),s=r.matchPrefix(a,"a=ice-lite").length>0;switch(this.usingBundle=r.matchPrefix(a,"a=group:BUNDLE ").length>0,o.forEach(function(o,c){var u,l,f,h,d,p,v,g,m,_,y,b,w=r.splitLines(o),E=w[0].substr(2).split(" "),x=E[0],A="0"===E[1],T=r.getDirection(o,a),S=r.parseRtpParameters(o);A||(y=r.getIceParameters(o,a),b=r.getDtlsParameters(o,a),b.role="client"),g=r.parseRtpEncodingParameters(o);var R=r.matchPrefix(o,"a=mid:");R=R.length?R[0].substr(6):r.generateIdentifier();var C,M=r.matchPrefix(o,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];M&&(C=M.value);var O=r.matchPrefix(o,"a=end-of-candidates").length>0,P=r.matchPrefix(o,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return"1"===e.component});if("offer"!==e.type||A)"answer"!==e.type||A||(u=t.transceivers[c],l=u.iceGatherer,f=u.iceTransport,h=u.dtlsTransport,d=u.rtpSender,p=u.rtpReceiver,v=u.sendEncodingParameters,m=u.localCapabilities,t.transceivers[c].recvEncodingParameters=g,t.transceivers[c].remoteCapabilities=S,t.transceivers[c].cname=C,(s||O)&&P.length&&f.setRemoteCandidates(P),t.usingBundle&&0!==c||(f.start(l,y,"controlling"),h.start(b)),t._transceive(u,"sendrecv"===T||"recvonly"===T,"sendrecv"===T||"sendonly"===T),!p||"sendrecv"!==T&&"sendonly"!==T?delete u.rtpReceiver:(_=p.track,i.push([_,p]),n.addTrack(_)));else{var I=t.usingBundle&&c>0?{iceGatherer:t.transceivers[0].iceGatherer,iceTransport:t.transceivers[0].iceTransport,dtlsTransport:t.transceivers[0].dtlsTransport}:t._createIceAndDtlsTransports(R,c);if(O&&I.iceTransport.setRemoteCandidates(P),m=RTCRtpReceiver.getCapabilities(x),v=[{ssrc:1001*(2*c+2)}],p=new RTCRtpReceiver(I.dtlsTransport,x),_=p.track,i.push([_,p]),n.addTrack(_),t.localStreams.length>0&&t.localStreams[0].getTracks().length>=c){var N=t.localStreams[0].getTracks()[c];d=new RTCRtpSender(N,I.dtlsTransport)}t.transceivers[c]={iceGatherer:I.iceGatherer,iceTransport:I.iceTransport,dtlsTransport:I.dtlsTransport,localCapabilities:m,remoteCapabilities:S,rtpSender:d,rtpReceiver:p,kind:x,mid:R,cname:C,sendEncodingParameters:v,recvEncodingParameters:g},t._transceive(t.transceivers[c],!1,"sendrecv"===T||"sendonly"===T)}}),this.remoteDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}return n.getTracks().length&&(t.remoteStreams.push(n),window.setTimeout(function(){var e=new Event("addstream");e.stream=n,t.dispatchEvent(e),null!==t.onaddstream&&window.setTimeout(function(){t.onaddstream(e)},0),i.forEach(function(r){var i=r[0],o=r[1],a=new Event("track");a.track=i,a.receiver=o,a.streams=[n],t.dispatchEvent(e),null!==t.ontrack&&window.setTimeout(function(){t.ontrack(a)},0)})},0)),arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._updateSignalingState("closed")},window.RTCPeerConnection.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this.dispatchEvent(t),null!==this.onsignalingstatechange&&this.onsignalingstatechange(t)},window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){var e=new Event("negotiationneeded");this.dispatchEvent(e),null!==this.onnegotiationneeded&&this.onnegotiationneeded(e)},window.RTCPeerConnection.prototype._updateConnectionState=function(){var e,t=this,n={"new":0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};if(this.transceivers.forEach(function(e){n[e.iceTransport.state]++,n[e.dtlsTransport.state]++}),n.connected+=n.completed,e="new",n.failed>0?e="failed":n.connecting>0||n.checking>0?e="connecting":n.disconnected>0?e="disconnected":n["new"]>0?e="new":(n.connected>0||n.completed>0)&&(e="connected"),e!==t.iceConnectionState){t.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this.dispatchEvent(r),null!==this.oniceconnectionstatechange&&this.oniceconnectionstatechange(r)}},window.RTCPeerConnection.prototype.createOffer=function(){var e=this;if(this._pendingOffer)throw new Error("createOffer called while there is a pending offer.");var t;1===arguments.length&&"function"!=typeof arguments[0]?t=arguments[0]:3===arguments.length&&(t=arguments[2]);var n=[],i=0,o=0;if(this.localStreams.length&&(i=this.localStreams[0].getAudioTracks().length,o=this.localStreams[0].getVideoTracks().length),t){if(t.mandatory||t.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==t.offerToReceiveAudio&&(i=t.offerToReceiveAudio),void 0!==t.offerToReceiveVideo&&(o=t.offerToReceiveVideo)}for(this.localStreams.length&&this.localStreams[0].getTracks().forEach(function(e){n.push({kind:e.kind,track:e,wantReceive:"audio"===e.kind?i>0:o>0}),"audio"===e.kind?i--:"video"===e.kind&&o--});i>0||o>0;)i>0&&(n.push({kind:"audio",wantReceive:!0}),i--),o>0&&(n.push({kind:"video",wantReceive:!0}),o--);var a=r.writeSessionBoilerplate(),s=[];n.forEach(function(t,n){var i,o,a=t.track,c=t.kind,u=r.generateIdentifier(),l=e.usingBundle&&n>0?{iceGatherer:s[0].iceGatherer,iceTransport:s[0].iceTransport,dtlsTransport:s[0].dtlsTransport}:e._createIceAndDtlsTransports(u,n),f=RTCRtpSender.getCapabilities(c),h=[{ssrc:1001*(2*n+1)}];a&&(i=new RTCRtpSender(a,l.dtlsTransport)),t.wantReceive&&(o=new RTCRtpReceiver(l.dtlsTransport,c)),s[n]={iceGatherer:l.iceGatherer,iceTransport:l.iceTransport,dtlsTransport:l.dtlsTransport,localCapabilities:f,remoteCapabilities:null,rtpSender:i,rtpReceiver:o,kind:c,mid:u,sendEncodingParameters:h,recvEncodingParameters:null}}),this.usingBundle&&(a+="a=group:BUNDLE "+s.map(function(e){return e.mid}).join(" ")+"\r\n"),n.forEach(function(t,n){var i=s[n];a+=r.writeMediaSection(i,i.localCapabilities,"offer",e.localStreams[0])}),this._pendingOffer=s;var c=new RTCSessionDescription({type:"offer",sdp:a});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,c),Promise.resolve(c)},window.RTCPeerConnection.prototype.createAnswer=function(){var e=this,t=r.writeSessionBoilerplate();this.usingBundle&&(t+="a=group:BUNDLE "+this.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),this.transceivers.forEach(function(n){var i=e._getCommonCapabilities(n.localCapabilities,n.remoteCapabilities);t+=r.writeMediaSection(n,i,"answer",e.localStreams[0])});var n=new RTCSessionDescription({type:"answer",sdp:t});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,n),Promise.resolve(n)},window.RTCPeerConnection.prototype.addIceCandidate=function(e){if(null===e)this.transceivers.forEach(function(e){e.iceTransport.addRemoteCandidate({})});else{var t=e.sdpMLineIndex;if(e.sdpMid)for(var n=0;n<this.transceivers.length;n++)if(this.transceivers[n].mid===e.sdpMid){t=n;break}var i=this.transceivers[t];if(i){var o=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===o.protocol&&0===o.port)return;if("1"!==o.component)return;"endOfCandidates"===o.type&&(o={}),i.iceTransport.addRemoteCandidate(o);var a=r.splitSections(this.remoteDescription.sdp);a[t+1]+=(o.type?e.candidate.trim():"a=end-of-candidates")+"\r\n",this.remoteDescription.sdp=a.join("")}}return arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.getStats=function(){var e=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(n){t[n]&&e.push(t[n].getStats())})});var t=arguments.length>1&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(n){var r=new Map;Promise.all(e).then(function(e){e.forEach(function(e){Object.keys(e).forEach(function(t){r.set(t,e[t]),r[t]=e[t]})}),t&&window.setTimeout(t,0,r),n(r)})})}},attachMediaStream:function(e,t){i("DEPRECATED, attachMediaStream will soon be removed."),e.srcObject=t},reattachMediaStream:function(e,t){i("DEPRECATED, reattachMediaStream will soon be removed."),e.srcObject=t.srcObject}};e.exports={shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:n(14),attachMediaStream:o.attachMediaStream,reattachMediaStream:o.reattachMediaStream}},function(e,t){"use strict";var n={};n.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},n.localCName=n.generateIdentifier(),n.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},n.splitSections=function(e){var t=e.split("\nm=");return t.map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},n.matchPrefix=function(e,t){return n.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},n.parseCandidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var n={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1]}return n},n.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),"candidate:"+t.join(" ")},n.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.numChannels=3===t.length?parseInt(t[2],10):1,n},n.writeRtpMap=function(e){var t=e.payloadType;return void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType),"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==e.numChannels?"/"+e.numChannels:"")+"\r\n"},n.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),uri:t[1]}},n.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+" "+e.uri+"\r\n"},n.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)t=r[i].trim().split("="),n[t[0].trim()]=t[1];return n},n.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){r.push(t+"="+e.parameters[t])}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},n.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},n.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},n.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},n.getDtlsParameters=function(e,t){var r=n.splitLines(e);r=r.concat(n.splitLines(t));var i=r.filter(function(e){return 0===e.indexOf("a=fingerprint:")})[0].substr(14),o={role:"auto",fingerprints:[{algorithm:i.split(" ")[0],value:i.split(" ")[1]}]};return o},n.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},n.getIceParameters=function(e,t){var r=n.splitLines(e);r=r.concat(n.splitLines(t));var i={usernameFragment:r.filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:r.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)};return i},n.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},n.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=n.splitLines(e),i=r[0].split(" "),o=3;o<i.length;o++){var a=i[o],s=n.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(s){var c=n.parseRtpMap(s),u=n.matchPrefix(e,"a=fmtp:"+a+" ");switch(c.parameters=u.length?n.parseFmtp(u[0]):{},c.rtcpFeedback=n.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(n.parseRtcpFb),t.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(c.name.toUpperCase())}}}return n.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(n.parseExtmap(e))}),t},n.writeRtpDescription=function(e,t){var r="";return r+="m="+e+" ",r+=t.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){r+=n.writeRtpMap(e),r+=n.writeFmtp(e),r+=n.writeRtcpFb(e)}),r+="a=rtcp-mux\r\n"},n.parseRtpEncodingParameters=function(e){var t,r=[],i=n.parseRtpParameters(e),o=i.fecMechanisms.indexOf("RED")!==-1,a=i.fecMechanisms.indexOf("ULPFEC")!==-1,s=n.matchPrefix(e,"a=ssrc:").map(function(e){return n.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),c=s.length>0&&s[0].ssrc,u=n.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.split(" ");return t.shift(),t.map(function(e){return parseInt(e,10)})});u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var n={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10),rtx:{payloadType:e.payloadType,ssrc:t}};r.push(n),o&&(n=JSON.parse(JSON.stringify(n)),n.fec={ssrc:t,mechanism:a?"red+ulpfec":"red"},r.push(n))}}),0===r.length&&c&&r.push({ssrc:c});var l=n.matchPrefix(e,"b=");return l.length&&(0===l[0].indexOf("b=TIAS:")?l=parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")&&(l=parseInt(l[0].substr(5),10)),r.forEach(function(e){e.maxBitrate=l})),r},n.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},n.writeMediaSection=function(e,t,r,i){var o=n.writeRtpDescription(e.kind,t);if(o+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",o+=e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n"},n.getDirection=function(e,t){for(var r=n.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return t?n.getDirection(t):"sendrecv"},e.exports=n},function(e,t){"use strict";e.exports=function(){var e=function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}},t=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(n){return t(n)["catch"](function(t){return Promise.reject(e(t))})}}},function(e,t,n){"use strict";var r=n(9).log,i=n(9).browserDetails,o={shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(){if("object"==typeof window&&(window.RTCPeerConnection||window.mozRTCPeerConnection)){window.RTCPeerConnection||(window.RTCPeerConnection=function(e,t){if(i.version<38&&e&&e.iceServers){for(var n=[],r=0;r<e.iceServers.length;r++){var o=e.iceServers[r];if(o.hasOwnProperty("urls"))for(var a=0;a<o.urls.length;a++){var s={url:o.urls[a]};0===o.urls[a].indexOf("turn")&&(s.username=o.username,s.credential=o.credential),n.push(s)}else n.push(e.iceServers[r])}e.iceServers=n}return new mozRTCPeerConnection(e,t)},window.RTCPeerConnection.prototype=mozRTCPeerConnection.prototype,mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return null===arguments[0]?Promise.resolve():e.apply(this,arguments)};var t=function(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n]),t[n]=e[n]}),t},n=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(e,r,i){return n.apply(this,[e||null]).then(function(e){return t(e)}).then(r,i)}}},attachMediaStream:function(e,t){r("DEPRECATED, attachMediaStream will soon be removed."),e.srcObject=t},reattachMediaStream:function(e,t){r("DEPRECATED, reattachMediaStream will soon be removed."),e.srcObject=t.srcObject}};e.exports={shimOnTrack:o.shimOnTrack,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:n(16),attachMediaStream:o.attachMediaStream,reattachMediaStream:o.reattachMediaStream}},function(e,t,n){"use strict";var r=n(9).log,i=n(9).browserDetails;e.exports=function(){var e=function(e){return{name:{SecurityError:"NotAllowedError",PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},t=function(t,n,o){var a=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||t.push(n),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var i={};"number"==typeof r.ideal?i[n]={min:r.ideal,max:r.ideal}:i[n]=r.ideal,e.advanced.push(i),delete r.ideal,Object.keys(r).length||delete e[n]}}}),t.length&&(e.require=t),e};return t=JSON.parse(JSON.stringify(t)),i.version<38&&(r("spec: "+JSON.stringify(t)),t.audio&&(t.audio=a(t.audio)),t.video&&(t.video=a(t.video)),r("ff37: "+JSON.stringify(t))),navigator.mozGetUserMedia(t,n,function(t){o(e(t))})},n=function(e){return new Promise(function(n,r){t(e,n,r)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:n,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})},i.version<41){var o=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return o().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(i.version<49){var a=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(t){return a(t)["catch"](function(t){return Promise.reject(e(t))})}}navigator.getUserMedia=function(e,n,r){return i.version<44?t(e,n,r):(console.warn("navigator.getUserMedia has been replaced by navigator.mediaDevices.getUserMedia"),void navigator.mediaDevices.getUserMedia(e).then(n,r))}}},function(e,t){"use strict";var n={shimGetUserMedia:function(){navigator.getUserMedia=navigator.webkitGetUserMedia}};e.exports={shimGetUserMedia:n.shimGetUserMedia}},function(e,t){function n(e,t,i){if(!(this instanceof n))return new n(e,t,i);if(t instanceof r||(i=t,t=null),i=i||{},this.ctx=t=t||new r,e instanceof AudioNode||(e=e instanceof Audio||e instanceof HTMLAudioElement?t.createMediaElementSource(e):t.createMediaStreamSource(e)),this.analyser=t.createAnalyser(),this.stereo=!!i.stereo,this.audible=i.audible!==!1,this.wavedata=null,this.freqdata=null,this.splitter=null,this.merger=null,this.source=e,this.stereo){this.analyser=[this.analyser],this.analyser.push(t.createAnalyser()),this.splitter=t.createChannelSplitter(2),this.merger=t.createChannelMerger(2),this.output=this.merger,this.source.connect(this.splitter);for(var o=0;o<2;o++)this.splitter.connect(this.analyser[o],o,0),this.analyser[o].connect(this.merger,0,o);this.audible&&this.merger.connect(t.destination)}else this.output=this.source,this.source.connect(this.analyser),this.audible&&this.analyser.connect(t.destination)}var r=window.AudioContext||window.webkitAudioContext;e.exports=n,n.prototype.waveform=function(e,t){e||(e=this.wavedata||(this.wavedata=new Uint8Array((this.analyser[0]||this.analyser).frequencyBinCount)));var n=this.stereo?this.analyser[t||0]:this.analyser;return n.getByteTimeDomainData(e),e},n.prototype.frequencies=function(e,t){e||(e=this.freqdata||(this.freqdata=new Uint8Array((this.analyser[0]||this.analyser).frequencyBinCount)));var n=this.stereo?this.analyser[t||0]:this.analyser;return n.getByteFrequencyData(e),e}},function(e,t,n){function r(e){if(e)throw e}function i(e,t){l||(c(".npm-scb-wrap {\n  font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  font-weight: 200;\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 999;\n}\n\n.npm-scb-wrap a {\n  text-decoration: none;\n  color: #000;\n}\n.npm-scb-white\n.npm-scb-wrap a {\n  color: #fff;\n}\n\n.npm-scb-inner {\n  position: absolute;\n  top: -120px; left: 0;\n  padding: 8px;\n  width: 100%;\n  height: 150px;\n  z-index: 2;\n  -webkit-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n     -moz-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n      -ms-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n       -o-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n          transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n}\n.npm-scb-wrap:hover\n.npm-scb-inner {\n  top: 0;\n}\n\n.npm-scb-artwork {\n  position: absolute;\n  top: 16px; left: 16px;\n  width: 104px; height: 104px;\n  box-shadow: 0 0 8px -3px #000;\n  outline: 1px solid rgba(0,0,0,0.1);\n  z-index: 2;\n}\n.npm-scb-white\n.npm-scb-artwork {\n  outline: 1px solid rgba(255,255,255,0.1);\n  box-shadow: 0 0 10px -2px rgba(255,255,255,0.9);\n}\n\n.npm-scb-info {\n  position: absolute;\n  top: 16px;\n  left: 120px;\n  width: 300px;\n  z-index: 1;\n}\n\n.npm-scb-info > a {\n  display: block;\n}\n\n.npm-scb-now-playing {\n  font-size: 12px;\n  line-height: 12px;\n  position: absolute;\n  width: 500px;\n  z-index: 1;\n  padding: 15px 0;\n  top: 0; left: 138px;\n  opacity: 1;\n  -webkit-transition: opacity 0.25s;\n     -moz-transition: opacity 0.25s;\n      -ms-transition: opacity 0.25s;\n       -o-transition: opacity 0.25s;\n          transition: opacity 0.25s;\n}\n\n.npm-scb-wrap:hover\n.npm-scb-now-playing {\n  opacity: 0;\n}\n\n.npm-scb-white\n.npm-scb-now-playing {\n  color: #fff;\n}\n.npm-scb-now-playing > a {\n  font-weight: bold;\n}\n\n.npm-scb-info > a > p {\n  margin: 0;\n  padding-bottom: 0.25em;\n  line-height: 1.35em;\n  margin-left: 1em;\n  font-size: 1em;\n}\n\n.npm-scb-title {\n  font-weight: bold;\n}\n\n.npm-scb-icon {\n  position: absolute;\n  top: 120px;\n  padding-top: 0.75em;\n  left: 16px;\n}\n"),l=!0),h||(h=s.compile('<div class="npm-scb-wrap">\n  <div class="npm-scb-inner">\n    <a target="_blank" href="{{!urls.song}}">\n      <img class="npm-scb-icon" src="{{!icon}}">\n      <img class="npm-scb-artwork" src="{{!artwork}}">\n    </a>\n    <div class="npm-scb-info">\n      <a target="_blank" href="{{!urls.song}}">\n        <p class="npm-scb-title">{{!title}}</p>\n      </a>\n      <a target="_blank" href="{{!urls.artist}}">\n        <p class="npm-scb-artist">{{!artist}}</p>\n      </a>\n    </div>\n  </div>\n  <div class="npm-scb-now-playing">\n    Now Playing:\n    <a href="{{!urls.song}}">{{!title}}</a>\n    by\n    <a href="{{!urls.artist}}">{{!artist}}</a>\n  </div>\n</div>')),!f&&e.getFonts&&(a.add({"Open Sans":[300,600]}),f=!0),e=e||{},t=t||r;var n=e.el||document.createElement("div"),i="dark"in e&&!e.dark?"white":"black",d=e.client_id,p=e.song;return o(d,p,function(e,r){if(e)return t(e);if("track"!==r.kind)throw new Error("soundcloud-badge only supports individual tracks at the moment");n.classList["black"===i?"remove":"add"]("npm-scb-white"),n.innerHTML=h({artwork:r.artwork_url||r.user.avatar_url,artist:r.user.username,title:r.title,icon:u[i],urls:{song:r.permalink_url,artist:r.user.permalink_url}}),document.body.appendChild(n),t(null,r.stream_url+"?client_id="+d,r,n)}),n}var o=n(20),a=n(27),s=n(28),c=n(29),u=(n(30),{black:"https://developers.soundcloud.com/assets/logo_black.png",white:"https://developers.soundcloud.com/assets/logo_white.png"});e.exports=i;var l=!1,f=!1,h=null},function(e,t,n){function r(e,t,n){var r="https://api.soundcloud.com/resolve.json?"+i.stringify({url:t,client_id:e});o({uri:r,method:"GET"},function(t,r,i){if(t)return n(t);try{i=JSON.parse(i)}catch(o){return n(o)}if(i.errors)return n(new Error(i.errors[0].error_message));var a="track"===i.kind&&i.stream_url+"?client_id="+e;return n(null,i,a)})}var i=n(21),o=n(24);e.exports=r},function(e,t,n){"use strict";t.decode=t.parse=n(22),t.encode=t.stringify=n(23);
},function(e,t){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,i){t=t||"&",r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var a=/\+/g;e=e.split(t);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var c=e.length;s>0&&c>s&&(c=s);for(var u=0;u<c;++u){var l,f,h,d,p=e[u].replace(a,"%20"),v=p.indexOf(r);v>=0?(l=p.substr(0,v),f=p.substr(v+1)):(l=p,f=""),h=decodeURIComponent(l),d=decodeURIComponent(f),n(o,h)?Array.isArray(o[h])?o[h].push(d):o[h]=[o[h],d]:o[h]=d}return o}},function(e,t){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,i){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(i){var o=encodeURIComponent(n(i))+r;return Array.isArray(e[i])?e[i].map(function(e){return o+encodeURIComponent(n(e))}).join(t):o+encodeURIComponent(n(e[i]))}).join(t):i?encodeURIComponent(n(i))+r+encodeURIComponent(n(e)):""}},function(e,t,n){function r(e,t){function n(){4===l.readyState&&r()}function r(){var e=null,n=l.statusCode=l.status,r=l.body=l.response||l.responseText||l.responseXML;if(0===n||n>=400&&n<600){var i=l.responseText||s[String(l.status).charAt(0)];e=new Error(i),e.statusCode=l.status}if(v)try{r=l.body=JSON.parse(r)}catch(o){}t(e,l,r)}function o(e){t(e,l)}"string"==typeof e&&(e={uri:e}),e=e||{},t=a(t);var l;l=e.cors?new u:new c;var f=l.url=e.uri,h=l.method=e.method||"GET",d=e.body||e.data,p=l.headers=e.headers||{},v=!1;return"json"in e&&(v=!0,p["Content-Type"]="application/json",d=JSON.stringify(e.json)),l.onreadystatechange=n,l.onload=r,l.onerror=o,l.onprogress=function(){},l.ontimeout=i,l.open(h,f),e.cors&&(l.withCredentials=!0),l.timeout="timeout"in e?e.timeout:5e3,l.setRequestHeader&&Object.keys(p).forEach(function(e){l.setRequestHeader(e,p[e])}),l.send(d),l}function i(){}var o=n(25),a=n(26),s={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"},c=o.XMLHttpRequest||i,u="withCredentials"in new c?o.XMLHttpRequest:o.XDomainRequest;e.exports=r},function(e,t){(function(t){"undefined"!=typeof window?e.exports=window:"undefined"!=typeof t?e.exports=t:e.exports={}}).call(t,function(){return this}())},function(e,t){function n(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}e.exports=n,n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0})})},function(e,t){function n(e){var t=i(e);return'<link href="'+t+'" rel="stylesheet" type="text/css">'}function r(e){var t=i(e),n=document.createElement("link");return n.setAttribute("href",t),n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n}function i(e){var t=Object.keys(e).map(function(t){var n=e[t];return t=t.replace(/\s+/,"+"),"boolean"==typeof n?t:t+":"+a(n).join(",")}).join("|");return"http://fonts.googleapis.com/css?family="+t}function o(e){var t=r(e);return document.head.appendChild(t),t}function a(e){return Array.isArray(e)?e:[e]}e.exports=n,e.exports.add=o},function(e,t){function n(e,t){t=t||{};var n=r(e);return n(t)}function r(e){for(var t,n=[],r=o(e),u=0;u<r.length;++u)if(t=r[u],u%2==0)n.push('"'+t.replace(/"/g,'\\"')+'"');else switch(t[0]){case"/":t=t.slice(1),n.push(") + ");break;case"^":t=t.slice(1),i(t),n.push(' + section(obj, "'+t+'", true, ');break;case"#":t=t.slice(1),i(t),n.push(' + section(obj, "'+t+'", false, ');break;case"!":t=t.slice(1),i(t),n.push(" + obj."+t+" + ");break;default:i(t),n.push(" + escape(obj."+t+") + ")}return n="\n"+a(c.toString())+";\n\n"+a(s.toString())+";\n\n  return "+n.join("").replace(/\n/g,"\\n"),new Function("obj",n)}function i(e){if(!e.match(/^[\w.]+$/))throw new Error('invalid property "'+e+'"')}function o(e){return e.split(/\{\{|\}\}/)}function a(e){return e.replace(/^/gm,"  ")}function s(e,t,n,r){var i=e[t];return"function"==typeof i?i.call(e,r):(n&&(i=!i),i?r:"")}function c(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}t=e.exports=n,t.compile=r},function(e,t){var n=[];e.exports=function(e){if(!(n.indexOf(e)>=0)){n.push(e);var t=document.createElement("style"),r=document.createTextNode(e);t.appendChild(r),document.head.childNodes.length?document.head.insertBefore(t,document.head.childNodes[0]):document.head.appendChild(t)}}},function(e,t){},function(e,t){function n(e,t,n){t=t||e.currentTarget||e.srcElement,Array.isArray(n)||(n=[0,0]);var i=e.clientX||0,o=e.clientY||0,a=r(t);return n[0]=i-a.left,n[1]=o-a.top,n}function r(e){return e===window||e===document||e===document.body?i:e.getBoundingClientRect()}var i={left:0,top:0};e.exports=n},function(e,t,n){function r(e,t,n){var r=!0,s=!0;if("function"!=typeof e)throw new TypeError(a);return o(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),i(e,t,{leading:r,maxWait:t,trailing:s})}var i=n(33),o=n(34),a="Expected a function";e.exports=r},function(e,t,n){function r(e,t,n){function r(t){var n=_,r=y;return _=y=void 0,A=t,w=e.apply(r,n)}function l(e){return A=e,E=setTimeout(d,t),T?r(e):w}function f(e){var n=e-x,r=e-A,i=t-n;return S?u(i,b-r):i}function h(e){var n=e-x,r=e-A;return void 0===x||n>=t||n<0||S&&r>=b}function d(){var e=o();return h(e)?p(e):void(E=setTimeout(d,f(e)))}function p(e){return E=void 0,R&&_?r(e):(_=y=void 0,w)}function v(){void 0!==E&&clearTimeout(E),A=0,_=x=y=E=void 0}function g(){return void 0===E?w:p(o())}function m(){var e=o(),n=h(e);if(_=arguments,y=this,x=e,n){if(void 0===E)return l(x);if(S)return E=setTimeout(d,t),r(x)}return void 0===E&&(E=setTimeout(d,t)),w}var _,y,b,w,E,x,A=0,T=!1,S=!1,R=!0;if("function"!=typeof e)throw new TypeError(s);return t=a(t)||0,i(n)&&(T=!!n.leading,S="maxWait"in n,b=S?c(a(n.maxWait)||0,t):b,R="trailing"in n?!!n.trailing:R),m.cancel=v,m.flush=g,m}var i=n(34),o=n(35),a=n(38),s="Expected a function",c=Math.max,u=Math.min;e.exports=r},function(e,t){function n(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=n},function(e,t,n){var r=n(36),i=function(){return r.Date.now()};e.exports=i},function(e,t,n){var r=n(37),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},function(e,t){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(t,function(){return this}())},function(e,t,n){function r(e){if("number"==typeof e)return e;if(o(e))return a;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var n=u.test(e);return n||l.test(e)?f(e.slice(2),n?2:8):c.test(e)?a:+e}var i=n(34),o=n(39),a=NaN,s=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,l=/^0o[0-7]+$/i,f=parseInt;e.exports=r},function(e,t,n){function r(e){return"symbol"==typeof e||i(e)&&s.call(e)==o}var i=n(40),o="[object Symbol]",a=Object.prototype,s=a.toString;e.exports=r},function(e,t){function n(e){return!!e&&"object"==typeof e}e.exports=n},function(e,t,n){function r(e,t,n){o(typeof e===t,"range-fit expects typeof("+n+") to be "+t)}function i(e,t){r(e,"number",t)}var o=n(42);e.exports=function(e,t,n,r,a){i(e,"value"),i(t,"lowerInitial"),i(n,"upperInitial"),i(r,"lowerNew"),i(a,"upperNew");var s=n-t;if(0===s)return r;o(t<=e,"range-fit expects lowerInitial<=value"),o(n>=e,"range-fit expects upperInitial>=value");var c=a-r;return(e-t)*c/s+r}},function(e,t,n){(function(t){"use strict";/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
function r(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function i(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}function o(e){return Object.prototype.toString.call(e)}function a(e){return!i(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}function s(e){if(b.isFunction(e)){if(x)return e.name;var t=e.toString(),n=t.match(T);return n&&n[1]}}function c(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function u(e){if(x||!b.isFunction(e))return b.inspect(e);var t=s(e),n=t?": "+t:"";return"[Function"+n+"]"}function l(e){return c(u(e.actual),128)+" "+e.operator+" "+c(u(e.expected),128)}function f(e,t,n,r,i){throw new A.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function h(e,t){e||f(e,!0,t,"==",A.ok)}function d(e,t,n,s){if(e===t)return!0;if(i(e)&&i(t))return 0===r(e,t);if(b.isDate(e)&&b.isDate(t))return e.getTime()===t.getTime();if(b.isRegExp(e)&&b.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(a(e)&&a(t)&&o(e)===o(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===r(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(i(e)!==i(t))return!1;s=s||{actual:[],expected:[]};var c=s.actual.indexOf(e);return c!==-1&&c===s.expected.indexOf(t)||(s.actual.push(e),s.expected.push(t),v(e,t,n,s))}return n?e===t:e==t}function p(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function v(e,t,n,r){if(null===e||void 0===e||null===t||void 0===t)return!1;if(b.isPrimitive(e)||b.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=p(e),o=p(t);if(i&&!o||!i&&o)return!1;if(i)return e=E.call(e),t=E.call(t),d(e,t,n);var a,s,c=S(e),u=S(t);if(c.length!==u.length)return!1;for(c.sort(),u.sort(),s=c.length-1;s>=0;s--)if(c[s]!==u[s])return!1;for(s=c.length-1;s>=0;s--)if(a=c[s],!d(e[a],t[a],n,r))return!1;return!0}function g(e,t,n){d(e,t,!0)&&f(e,t,n,"notDeepStrictEqual",g)}function m(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(n){}return!Error.isPrototypeOf(t)&&t.call({},e)===!0}function _(e){var t;try{e()}catch(n){t=n}return t}function y(e,t,n,r){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=_(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&f(i,n,"Missing expected exception"+r);var o="string"==typeof r,a=!e&&b.isError(i),s=!e&&i&&!n;if((a&&o&&m(i,n)||s)&&f(i,n,"Got unwanted exception"+r),e&&i&&n&&!m(i,n)||!e&&i)throw i}var b=n(43),w=Object.prototype.hasOwnProperty,E=Array.prototype.slice,x=function(){return"foo"===function(){}.name}(),A=e.exports=h,T=/\s*function\s+([^\(\s]*)\s*/;A.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=l(this),this.generatedMessage=!0);var t=e.stackStartFunction||f;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,i=s(t),o=r.indexOf("\n"+i);if(o>=0){var a=r.indexOf("\n",o+1);r=r.substring(a+1)}this.stack=r}}},b.inherits(A.AssertionError,Error),A.fail=f,A.ok=h,A.equal=function(e,t,n){e!=t&&f(e,t,n,"==",A.equal)},A.notEqual=function(e,t,n){e==t&&f(e,t,n,"!=",A.notEqual)},A.deepEqual=function(e,t,n){d(e,t,!1)||f(e,t,n,"deepEqual",A.deepEqual)},A.deepStrictEqual=function(e,t,n){d(e,t,!0)||f(e,t,n,"deepStrictEqual",A.deepStrictEqual)},A.notDeepEqual=function(e,t,n){d(e,t,!1)&&f(e,t,n,"notDeepEqual",A.notDeepEqual)},A.notDeepStrictEqual=g,A.strictEqual=function(e,t,n){e!==t&&f(e,t,n,"===",A.strictEqual)},A.notStrictEqual=function(e,t,n){e===t&&f(e,t,n,"!==",A.notStrictEqual)},A["throws"]=function(e,t,n){y(!0,e,t,n)},A.doesNotThrow=function(e,t,n){y(!1,e,t,n)},A.ifError=function(e){if(e)throw e};var S=Object.keys||function(e){var t=[];for(var n in e)w.call(e,n)&&t.push(n);return t}}).call(t,function(){return this}())},function(e,t,n){(function(e,r){function i(e,n){var r={seen:[],stylize:a};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),v(n)?r.showHidden=n:n&&t._extend(r,n),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),c(r,e,r.depth)}function o(e,t){var n=i.styles[t];return n?"["+i.colors[n][0]+"m"+e+"["+i.colors[n][1]+"m":e}function a(e,t){return e}function s(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function c(e,n,r){if(e.customInspect&&n&&S(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return y(i)||(i=c(e,i,r)),i}var o=u(e,n);if(o)return o;var a=Object.keys(n),v=s(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),T(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(n);if(0===a.length){if(S(n)){var g=n.name?": "+n.name:"";return e.stylize("[Function"+g+"]","special")}if(E(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(A(n))return e.stylize(Date.prototype.toString.call(n),"date");if(T(n))return l(n)}var m="",_=!1,b=["{","}"];if(p(n)&&(_=!0,b=["[","]"]),S(n)){var w=n.name?": "+n.name:"";m=" [Function"+w+"]"}if(E(n)&&(m=" "+RegExp.prototype.toString.call(n)),A(n)&&(m=" "+Date.prototype.toUTCString.call(n)),T(n)&&(m=" "+l(n)),0===a.length&&(!_||0==n.length))return b[0]+m+b[1];if(r<0)return E(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special");e.seen.push(n);var x;return x=_?f(e,n,r,v,a):a.map(function(t){return h(e,n,r,v,t,_)}),e.seen.pop(),d(x,m,b)}function u(e,t){if(w(t))return e.stylize("undefined","undefined");if(y(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return _(t)?e.stylize(""+t,"number"):v(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)P(t,String(a))?o.push(h(e,t,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(e,t,n,r,i,!0))}),o}function h(e,t,n,r,i,o){var a,s,u;if(u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},u.get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),P(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=g(n)?c(e,u.value,null):c(e,u.value,n-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n"))):s=e.stylize("[Circular]","special")),w(a)){if(o&&i.match(/^\d+$/))return s;a=JSON.stringify(""+i),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function d(e,t,n){var r=0,i=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function p(e){return Array.isArray(e)}function v(e){return"boolean"==typeof e}function g(e){return null===e}function m(e){return null==e}function _(e){return"number"==typeof e}function y(e){return"string"==typeof e}function b(e){return"symbol"==typeof e}function w(e){return void 0===e}function E(e){return x(e)&&"[object RegExp]"===C(e)}function x(e){return"object"==typeof e&&null!==e}function A(e){return x(e)&&"[object Date]"===C(e)}function T(e){return x(e)&&("[object Error]"===C(e)||e instanceof Error)}function S(e){return"function"==typeof e}function R(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function C(e){return Object.prototype.toString.call(e)}function M(e){return e<10?"0"+e.toString(10):e.toString(10)}function O(){var e=new Date,t=[M(e.getHours()),M(e.getMinutes()),M(e.getSeconds())].join(":");return[e.getDate(),L[e.getMonth()],t].join(" ")}function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var I=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,o=r.length,a=String(e).replace(I,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}}),s=r[n];n<o;s=r[++n])a+=g(s)||!x(s)?" "+s:" "+i(s);return a},t.deprecate=function(n,i){function o(){if(!a){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),a=!0}return n.apply(this,arguments)}if(w(e.process))return function(){return t.deprecate(n,i).apply(this,arguments)};if(r.noDeprecation===!0)return n;var a=!1;return o};var N,D={};t.debuglog=function(e){if(w(N)&&(N=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!D[e])if(new RegExp("\\b"+e+"\\b","i").test(N)){var n=r.pid;D[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else D[e]=function(){};return D[e]},t.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=v,t.isNull=g,t.isNullOrUndefined=m,t.isNumber=_,t.isString=y,t.isSymbol=b,t.isUndefined=w,t.isRegExp=E,t.isObject=x,t.isDate=A,t.isError=T,t.isFunction=S,t.isPrimitive=R,t.isBuffer=n(45);var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.log=function(){console.log("%s - %s",O(),t.format.apply(t,arguments))},t.inherits=n(46),t._extend=function(e,t){if(!t||!x(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(t,function(){return this}(),n(44))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function a(){v&&d&&(v=!1,d.length?p=d.concat(p):g=-1,p.length&&s())}function s(){if(!v){var e=i(a);v=!0;for(var t=p.length;t;){for(d=p,p=[];++g<t;)d&&d[g].run();g=-1,t=p.length}d=null,v=!1,o(e)}}function c(e,t){this.fun=e,this.array=t}function u(){}var l,f,h=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var d,p=[],v=!1,g=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new c(e,t)),1!==p.length||v||i(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){var r=n(48),i={};i.create=function(){var e=new r.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},i.clone=function(e){var t=new r.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.fromValues=function(e,t,n,i,o,a,s,c,u){var l=new r.ARRAY_TYPE(9);return l[0]=e,l[1]=t,l[2]=n,l[3]=i,l[4]=o,l[5]=a,l[6]=s,l[7]=c,l[8]=u,l},i.set=function(e,t,n,r,i,o,a,s,c,u){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=c,e[8]=u,e},i.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},i.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6],u=t[7],l=t[8],f=l*a-s*u,h=-l*o+s*c,d=u*o-a*c,p=n*f+r*h+i*d;return p?(p=1/p,e[0]=f*p,e[1]=(-l*r+i*u)*p,e[2]=(s*r-i*a)*p,e[3]=h*p,e[4]=(l*n-i*c)*p,e[5]=(-s*n+i*o)*p,e[6]=d*p,e[7]=(-u*n+r*c)*p,e[8]=(a*n-r*o)*p,e):null},i.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6],u=t[7],l=t[8];return e[0]=a*l-s*u,e[1]=i*u-r*l,e[2]=r*s-i*a,e[3]=s*c-o*l,e[4]=n*l-i*c,e[5]=i*o-n*s,e[6]=o*u-a*c,e[7]=r*c-n*u,e[8]=n*a-r*o,e},i.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],c=e[7],u=e[8];return t*(u*o-a*c)+n*(-u*i+a*s)+r*(c*i-o*s)},i.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],c=t[5],u=t[6],l=t[7],f=t[8],h=n[0],d=n[1],p=n[2],v=n[3],g=n[4],m=n[5],_=n[6],y=n[7],b=n[8];return e[0]=h*r+d*a+p*u,e[1]=h*i+d*s+p*l,e[2]=h*o+d*c+p*f,e[3]=v*r+g*a+m*u,e[4]=v*i+g*s+m*l,e[5]=v*o+g*c+m*f,e[6]=_*r+y*a+b*u,e[7]=_*i+y*s+b*l,e[8]=_*o+y*c+b*f,e},i.mul=i.multiply,i.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],c=t[5],u=t[6],l=t[7],f=t[8],h=n[0],d=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=c,e[6]=h*r+d*a+u,e[7]=h*i+d*s+l,e[8]=h*o+d*c+f,e},i.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],c=t[5],u=t[6],l=t[7],f=t[8],h=Math.sin(n),d=Math.cos(n);return e[0]=d*r+h*a,e[1]=d*i+h*s,e[2]=d*o+h*c,e[3]=d*a-h*r,e[4]=d*s-h*i,e[5]=d*c-h*o,e[6]=u,e[7]=l,e[8]=f,e},i.scale=function(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},i.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},i.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,c=i+i,u=n*a,l=r*a,f=r*s,h=i*a,d=i*s,p=i*c,v=o*a,g=o*s,m=o*c;return e[0]=1-f-p,e[3]=l-m,e[6]=h+g,e[1]=l+m,e[4]=1-u-p,e[7]=d-v,e[2]=h-g,e[5]=d+v,e[8]=1-u-f,e},i.normalFromMat4=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6],u=t[7],l=t[8],f=t[9],h=t[10],d=t[11],p=t[12],v=t[13],g=t[14],m=t[15],_=n*s-r*a,y=n*c-i*a,b=n*u-o*a,w=r*c-i*s,E=r*u-o*s,x=i*u-o*c,A=l*v-f*p,T=l*g-h*p,S=l*m-d*p,R=f*g-h*v,C=f*m-d*v,M=h*m-d*g,O=_*M-y*C+b*R+w*S-E*T+x*A;return O?(O=1/O,e[0]=(s*M-c*C+u*R)*O,e[1]=(c*S-a*M-u*T)*O,e[2]=(a*C-s*S+u*A)*O,e[3]=(i*C-r*M-o*R)*O,e[4]=(n*M-i*S+o*T)*O,e[5]=(r*S-n*C-o*A)*O,e[6]=(v*x-g*E+m*w)*O,e[7]=(g*b-p*x-m*y)*O,e[8]=(p*E-v*b+m*_)*O,e):null},i.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},i.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e},i.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e},i.sub=i.subtract,i.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e},i.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e},i.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},i.equals=function(e,t){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],c=e[5],u=e[6],l=e[7],f=e[8],h=t[0],d=t[1],p=t[2],v=t[3],g=t[4],m=t[5],_=e[6],y=t[7],b=t[8];return Math.abs(n-h)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-d)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-p)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-v)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-g)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-m)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(m))&&Math.abs(u-_)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(l-y)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(f-b)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(b))},e.exports=i},function(e,t){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.ENABLE_SIMD=!1,n.SIMD_AVAILABLE=n.ARRAY_TYPE===Float32Array&&"SIMD"in this,n.USE_SIMD=n.ENABLE_SIMD&&n.SIMD_AVAILABLE,n.setMatrixArrayType=function(e){n.ARRAY_TYPE=e};var r=Math.PI/180;n.toRadian=function(e){return e*r},n.equals=function(e,t){return Math.abs(e-t)<=n.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))},e.exports=n},function(e,t,n){var r=n(48),i={};i.create=function(){var e=new r.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e},i.clone=function(e){var t=new r.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},i.fromValues=function(e,t){var n=new r.ARRAY_TYPE(2);return n[0]=e,n[1]=t,n},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},i.set=function(e,t,n){return e[0]=t,e[1]=n,e},i.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},i.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e},i.sub=i.subtract,i.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e},i.mul=i.multiply,i.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e},i.div=i.divide,i.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},i.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},i.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},i.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e},i.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},i.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},i.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e},i.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},i.dist=i.distance,i.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r},i.sqrDist=i.squaredDistance,i.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},i.len=i.length,i.squaredLength=function(e){var t=e[0],n=e[1];return t*t+n*n},i.sqrLen=i.squaredLength,i.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},i.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},i.normalize=function(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},i.cross=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e},i.lerp=function(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e},i.random=function(e,t){t=t||1;var n=2*r.RANDOM()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},i.transformMat2=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e},i.transformMat2d=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e},i.transformMat3=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e},i.transformMat4=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e},i.forEach=function(){var e=i.create();return function(t,n,r,i,o,a){var s,c;for(n||(n=2),r||(r=0),c=i?Math.min(i*n+r,t.length):t.length,s=r;s<c;s+=n)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}(),i.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},i.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},i.equals=function(e,t){var n=e[0],i=e[1],o=t[0],a=t[1];return Math.abs(n-o)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-a)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))},e.exports=i},function(e,t,n){e.exports=n(51),e.exports.color=n(52)},function(e,t){var n=e.exports=n||{};n.gui=n.gui||{},n.utils=n.utils||{},n.controllers=n.controllers||{},n.dom=n.dom||{},n.color=n.color||{},n.utils.css=function(){return{load:function(e,t){t=t||document;var n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)},inject:function(e,t){t=t||document;var n=document.createElement("style");n.type="text/css",n.innerHTML=e,t.getElementsByTagName("head")[0].appendChild(n)}}}(),n.utils.common=function(){var e=Array.prototype.forEach,t=Array.prototype.slice;return{BREAK:{},extend:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(t[n])||(e[n]=t[n])},this),e},defaults:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(e[n])&&(e[n]=t[n])},this),e},compose:function(){var e=t.call(arguments);return function(){for(var n=t.call(arguments),r=e.length-1;r>=0;r--)n=[e[r].apply(this,n)];return n[0]}},each:function(t,n,r){if(e&&t.forEach===e)t.forEach(n,r);else if(t.length===t.length+0){for(var i=0,o=t.length;i<o;i++)if(i in t&&n.call(r,t[i],i)===this.BREAK)return}else for(var i in t)if(n.call(r,t[i],i)===this.BREAK)return},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():t.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return e!==e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}}}(),n.controllers.Controller=function(e){var t=function(e,t){this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0};return e.extend(t.prototype,{onChange:function(e){return this.__onChange=e,this},onFinishChange:function(e){return this.__onFinishChange=e,this},setValue:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),t}(n.utils.common),n.dom.dom=function(e){function t(t){if("0"===t||e.isUndefined(t))return 0;var n=t.match(i);return e.isNull(n)?0:parseFloat(n[1])}var n={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},r={};e.each(n,function(t,n){e.each(t,function(e){r[e]=n})});var i=/(\d+(\.\d+)?)px/,o={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(t,n,r){e.isUndefined(n)&&(n=!0),e.isUndefined(r)&&(r=!0),t.style.position="absolute",n&&(t.style.left=0,t.style.right=0),r&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,n,i,o){i=i||{};var a=r[n];if(!a)throw new Error("Event type "+n+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":var c=i.x||i.clientX||0,u=i.y||i.clientY||0;s.initMouseEvent(n,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,c,u,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var l=s.initKeyboardEvent||s.initKeyEvent;e.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),l(n,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:s.initEvent(n,i.bubbles||!1,i.cancelable||!0)}e.defaults(s,o),t.dispatchEvent(s)},bind:function(e,t,n,r){return r=r||!1,e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on"+t,n),o},unbind:function(e,t,n,r){return r=r||!1,e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on"+t,n),o},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);n.indexOf(t)==-1&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return o},removeClass:function(e,t){if(t)if(void 0===e.className);else if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),r=n.indexOf(t);r!=-1&&(n.splice(r,1),e.className=n.join(" "))}else e.className=void 0;return o},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var n=getComputedStyle(e);return t(n["border-left-width"])+t(n["border-right-width"])+t(n["padding-left"])+t(n["padding-right"])+t(n.width)},getHeight:function(e){var n=getComputedStyle(e);return t(n["border-top-width"])+t(n["border-bottom-width"])+t(n["padding-top"])+t(n["padding-bottom"])+t(n.height)},getOffset:function(e){var t={left:0,top:0};if(e.offsetParent)do t.left+=e.offsetLeft,t.top+=e.offsetTop;while(e=e.offsetParent);return t},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}};return o}(n.utils.common),n.controllers.OptionController=function(e,t,n){var r=function(e,i,o){r.superclass.call(this,e,i);var a=this;if(this.__select=document.createElement("select"),n.isArray(o)){var s={};n.each(o,function(e){s[e]=e}),o=s}n.each(o,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),a.__select.appendChild(n)}),this.updateDisplay(),t.bind(this.__select,"change",function(){var e=this.options[this.selectedIndex].value;a.setValue(e)}),this.domElement.appendChild(this.__select)};return r.superclass=e,n.extend(r.prototype,e.prototype,{setValue:function(e){var t=r.superclass.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),t},updateDisplay:function(){return this.__select.value=this.getValue(),r.superclass.prototype.updateDisplay.call(this)}}),r}(n.controllers.Controller,n.dom.dom,n.utils.common),n.controllers.NumberController=function(e,t){function n(e){return e=e.toString(),e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var r=function(e,i,o){r.superclass.call(this,e,i),o=o||{},this.__min=o.min,this.__max=o.max,this.__step=o.step,t.isUndefined(this.__step)?0==this.initialValue?this.__impliedStep=1:this.__impliedStep=Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__impliedStep=this.__step,this.__precision=n(this.__impliedStep)};return r.superclass=e,t.extend(r.prototype,e.prototype,{setValue:function(e){return void 0!==this.__min&&e<this.__min?e=this.__min:void 0!==this.__max&&e>this.__max&&(e=this.__max),void 0!==this.__step&&e%this.__step!=0&&(e=Math.round(e/this.__step)*this.__step),r.superclass.prototype.setValue.call(this,e)},min:function(e){return this.__min=e,this},max:function(e){return this.__max=e,this},step:function(e){return this.__step=e,this}}),r}(n.controllers.Controller,n.utils.common),n.controllers.NumberControllerBox=function(e,t,n){function r(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}var i=function(e,r,o){function a(){var e=parseFloat(h.__input.value);n.isNaN(e)||h.setValue(e)}function s(){a(),h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}function c(e){t.bind(window,"mousemove",u),t.bind(window,"mouseup",l),f=e.clientY}function u(e){var t=f-e.clientY;h.setValue(h.getValue()+t*h.__impliedStep),f=e.clientY}function l(){t.unbind(window,"mousemove",u),t.unbind(window,"mouseup",l)}this.__truncationSuspended=!1,i.superclass.call(this,e,r,o);var f,h=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"change",a),t.bind(this.__input,"blur",s),t.bind(this.__input,"mousedown",c),t.bind(this.__input,"keydown",function(e){13===e.keyCode&&(h.__truncationSuspended=!0,this.blur(),h.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return i.superclass=e,n.extend(i.prototype,e.prototype,{updateDisplay:function(){return this.__input.value=this.__truncationSuspended?this.getValue():r(this.getValue(),this.__precision),i.superclass.prototype.updateDisplay.call(this)}}),i}(n.controllers.NumberController,n.dom.dom,n.utils.common),n.controllers.NumberControllerSlider=function(e,t,n,r,i){function o(e,t,n,r,i){return r+(i-r)*((e-t)/(n-t))}var a=function(e,n,r,i,s){function c(e){t.bind(window,"mousemove",u),t.bind(window,"mouseup",l),u(e)}function u(e){e.preventDefault();var n=t.getOffset(f.__background),r=t.getWidth(f.__background);return f.setValue(o(e.clientX,n.left,n.left+r,f.__min,f.__max)),!1}function l(){t.unbind(window,"mousemove",u),t.unbind(window,"mouseup",l),f.__onFinishChange&&f.__onFinishChange.call(f,f.getValue())}a.superclass.call(this,e,n,{min:r,max:i,step:s});var f=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),t.bind(this.__background,"mousedown",c),t.addClass(this.__background,"slider"),t.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return a.superclass=e,a.useDefaultStyles=function(){n.inject(i)},r.extend(a.prototype,e.prototype,{updateDisplay:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",a.superclass.prototype.updateDisplay.call(this)}}),a}(n.controllers.NumberController,n.dom.dom,n.utils.css,n.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"),
n.controllers.FunctionController=function(e,t,n){var r=function(e,n,i){r.superclass.call(this,e,n);var o=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===i?"Fire":i,t.bind(this.__button,"click",function(e){return e.preventDefault(),o.fire(),!1}),t.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return r.superclass=e,n.extend(r.prototype,e.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),r}(n.controllers.Controller,n.dom.dom,n.utils.common),n.controllers.BooleanController=function(e,t,n){var r=function(e,n){function i(){o.setValue(!o.__prev)}r.superclass.call(this,e,n);var o=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),t.bind(this.__checkbox,"change",i,!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return r.superclass=e,n.extend(r.prototype,e.prototype,{setValue:function(e){var t=r.superclass.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),t},updateDisplay:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,r.superclass.prototype.updateDisplay.call(this)}}),r}(n.controllers.Controller,n.dom.dom,n.utils.common),n.color.toString=function(e){return function(t){if(1==t.a||e.isUndefined(t.a)){for(var n=t.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+","+t.a+")"}}(n.utils.common),n.color.interpret=function(e,t){var n,r,i=function(){r=!1;var e=arguments.length>1?t.toArray(arguments):arguments[0];return t.each(o,function(i){if(i.litmus(e))return t.each(i.conversions,function(i,o){if(n=i.read(e),r===!1&&n!==!1)return r=n,n.conversionName=o,n.conversion=i,t.BREAK}),t.BREAK}),r},o=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString())}},write:e},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString())}},write:e},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:e},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:e}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return i}(n.color.toString,n.utils.common),n.GUI=n.gui.GUI=function(e,t,n,r,i,o,a,s,c,u,l,f,h,d,p){function v(e,t,n,o){if(void 0===t[n])throw new Error("Object "+t+' has no property "'+n+'"');var a;if(o.color)a=new l(t,n);else{var s=[t,n].concat(o.factoryArgs);a=r.apply(e,s)}o.before instanceof i&&(o.before=o.before.__li),_(e,a),d.addClass(a.domElement,"c");var c=document.createElement("span");d.addClass(c,"property-name"),c.innerHTML=a.property;var u=document.createElement("div");u.appendChild(c),u.appendChild(a.domElement);var f=g(e,u,o.before);return d.addClass(f,U.CLASS_CONTROLLER_ROW),d.addClass(f,typeof a.getValue()),m(e,f,a),e.__controllers.push(a),a}function g(e,t,n){var r=document.createElement("li");return t&&r.appendChild(t),n?e.__ul.insertBefore(r,params.before):e.__ul.appendChild(r),e.onResize(),r}function m(e,t,n){if(n.__li=t,n.__gui=e,p.extend(n,{options:function(t){return arguments.length>1?(n.remove(),v(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[p.toArray(arguments)]})):p.isArray(t)||p.isObject(t)?(n.remove(),v(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[t]})):void 0},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof c){var r=new s(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});p.each(["updateDisplay","onChange","onFinishChange"],function(e){var t=n[e],i=r[e];n[e]=r[e]=function(){var e=Array.prototype.slice.call(arguments);return t.apply(n,e),i.apply(r,e)}}),d.addClass(t,"has-slider"),n.domElement.insertBefore(r.domElement,n.domElement.firstElementChild)}else if(n instanceof s){var i=function(t){return p.isNumber(n.__min)&&p.isNumber(n.__max)?(n.remove(),v(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]})):t};n.min=p.compose(i,n.min),n.max=p.compose(i,n.max)}else n instanceof o?(d.bind(t,"click",function(){d.fakeEvent(n.__checkbox,"click")}),d.bind(n.__checkbox,"click",function(e){e.stopPropagation()})):n instanceof a?(d.bind(t,"click",function(){d.fakeEvent(n.__button,"click")}),d.bind(t,"mouseover",function(){d.addClass(n.__button,"hover")}),d.bind(t,"mouseout",function(){d.removeClass(n.__button,"hover")})):n instanceof l&&(d.addClass(t,"color"),n.updateDisplay=p.compose(function(e){return t.style.borderLeftColor=n.__color.toString(),e},n.updateDisplay),n.updateDisplay());n.setValue=p.compose(function(t){return e.getRoot().__preset_select&&n.isModified()&&S(e.getRoot(),!0),t},n.setValue)}function _(e,t){var n=e.getRoot(),r=n.__rememberedObjects.indexOf(t.object);if(r!=-1){var i=n.__rememberedObjectIndecesToControllers[r];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[r]=i),i[t.property]=t,n.load&&n.load.remembered){var o,a=n.load.remembered;if(a[e.preset])o=a[e.preset];else{if(!a[N])return;o=a[N]}if(o[r]&&void 0!==o[r][t.property]){var s=o[r][t.property];t.initialValue=s,t.setValue(s)}}}}function y(e,t){return document.location.href+"."+t}function b(e){function t(){u.style.display=e.useLocalStorage?"block":"none"}var n=e.__save_row=document.createElement("li");d.addClass(e.domElement,"has-save"),e.__ul.insertBefore(n,e.__ul.firstChild),d.addClass(n,"save-row");var r=document.createElement("span");r.innerHTML="&nbsp;",d.addClass(r,"button gears");var i=document.createElement("span");i.innerHTML="Save",d.addClass(i,"button"),d.addClass(i,"save");var o=document.createElement("span");o.innerHTML="New",d.addClass(o,"button"),d.addClass(o,"save-as");var a=document.createElement("span");a.innerHTML="Revert",d.addClass(a,"button"),d.addClass(a,"revert");var s=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?p.each(e.load.remembered,function(t,n){A(e,n,n==e.preset)}):A(e,N,!1),d.bind(s,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),n.appendChild(s),n.appendChild(r),n.appendChild(i),n.appendChild(o),n.appendChild(a),D){var c=document.getElementById("dg-save-locally"),u=document.getElementById("dg-local-explain");c.style.display="block";var l=document.getElementById("dg-local-storage");"true"===localStorage.getItem(y(e,"isLocal"))&&l.setAttribute("checked","checked"),t(),d.bind(l,"change",function(){e.useLocalStorage=!e.useLocalStorage,t()})}var f=document.getElementById("dg-new-constructor");d.bind(f,"keydown",function(e){!e.metaKey||67!==e.which&&67!=e.keyCode||C.hide()}),d.bind(r,"click",function(){f.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),C.show(),f.focus(),f.select()}),d.bind(i,"click",function(){e.save()}),d.bind(o,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),d.bind(a,"click",function(){e.revert()})}function w(e){function t(t){return t.preventDefault(),i=t.clientX,d.addClass(e.__closeButton,U.CLASS_DRAG),d.bind(window,"mousemove",n),d.bind(window,"mouseup",r),!1}function n(t){return t.preventDefault(),e.width+=i-t.clientX,e.onResize(),i=t.clientX,!1}function r(){d.removeClass(e.__closeButton,U.CLASS_DRAG),d.unbind(window,"mousemove",n),d.unbind(window,"mouseup",r)}e.__resize_handle=document.createElement("div"),p.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var i;d.bind(e.__resize_handle,"mousedown",t),d.bind(e.__closeButton,"mousedown",t),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function E(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function x(e,t){var n={};return p.each(e.__rememberedObjects,function(r,i){var o={},a=e.__rememberedObjectIndecesToControllers[i];p.each(a,function(e,n){o[n]=t?e.initialValue:e.getValue()}),n[i]=o}),n}function A(e,t,n){var r=document.createElement("option");r.innerHTML=t,r.value=t,e.__preset_select.appendChild(r),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function T(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value==e.preset&&(e.__preset_select.selectedIndex=t)}function S(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];t?n.innerHTML=n.value+"*":n.innerHTML=n.value}function R(e){0!=e.length&&f(function(){R(e)}),p.each(e,function(e){e.updateDisplay()})}e.inject(n);var C,M,O="dg",P=72,I=20,N="Default",D=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}(),L=!0,F=!1,k=[],U=function(e){function t(){localStorage.setItem(y(r,"gui"),JSON.stringify(r.getSaveObject()))}function n(){var e=r.getRoot();e.width+=1,p.defer(function(){e.width-=1})}var r=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),d.addClass(this.domElement,O),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],e=e||{},e=p.defaults(e,{autoPlace:!0,width:U.DEFAULT_WIDTH}),e=p.defaults(e,{resizable:e.autoPlace,hideable:e.autoPlace}),p.isUndefined(e.load)?e.load={preset:N}:e.preset&&(e.load.preset=e.preset),p.isUndefined(e.parent)&&e.hideable&&k.push(this),e.resizable=p.isUndefined(e.parent)&&e.resizable,e.autoPlace&&p.isUndefined(e.scrollable)&&(e.scrollable=!0);var i=D&&"true"===localStorage.getItem(y(this,"isLocal"));if(Object.defineProperties(this,{parent:{get:function(){return e.parent}},scrollable:{get:function(){return e.scrollable}},autoPlace:{get:function(){return e.autoPlace}},preset:{get:function(){return r.parent?r.getRoot().preset:e.load.preset},set:function(t){r.parent?r.getRoot().preset=t:e.load.preset=t,T(this),r.revert()}},width:{get:function(){return e.width},set:function(t){e.width=t,E(r,t)}},name:{get:function(){return e.name},set:function(t){e.name=t,a&&(a.innerHTML=e.name)}},closed:{get:function(){return e.closed},set:function(t){e.closed=t,e.closed?d.addClass(r.__ul,U.CLASS_CLOSED):d.removeClass(r.__ul,U.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=t?U.TEXT_OPEN:U.TEXT_CLOSED)}},load:{get:function(){return e.load}},useLocalStorage:{get:function(){return i},set:function(e){D&&(i=e,e?d.bind(window,"unload",t):d.unbind(window,"unload",t),localStorage.setItem(y(r,"isLocal"),e))}}}),p.isUndefined(e.parent)){if(e.closed=!1,d.addClass(this.domElement,U.CLASS_MAIN),d.makeSelectable(this.domElement,!1),D&&i){r.useLocalStorage=!0;var o=localStorage.getItem(y(this,"gui"));o&&(e.load=JSON.parse(o))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=U.TEXT_CLOSED,d.addClass(this.__closeButton,U.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),d.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{void 0===e.closed&&(e.closed=!0);var a=document.createTextNode(e.name);d.addClass(a,"controller-name");var s=g(r,a),c=function(e){return e.preventDefault(),r.closed=!r.closed,!1};d.addClass(this.__ul,U.CLASS_CLOSED),d.addClass(s,"title"),d.bind(s,"click",c),e.closed||(this.closed=!1)}e.autoPlace&&(p.isUndefined(e.parent)&&(L&&(M=document.createElement("div"),d.addClass(M,O),d.addClass(M,U.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(M),L=!1),M.appendChild(this.domElement),d.addClass(this.domElement,U.CLASS_AUTO_PLACE)),this.parent||E(r,e.width)),d.bind(window,"resize",function(){r.onResize()}),d.bind(this.__ul,"webkitTransitionEnd",function(){r.onResize()}),d.bind(this.__ul,"transitionend",function(){r.onResize()}),d.bind(this.__ul,"oTransitionEnd",function(){r.onResize()}),this.onResize(),e.resizable&&w(this);r.getRoot();e.parent||n()};return U.toggleHide=function(){F=!F,p.each(k,function(e){e.domElement.style.zIndex=F?-999:999,e.domElement.style.opacity=F?0:1})},U.CLASS_AUTO_PLACE="a",U.CLASS_AUTO_PLACE_CONTAINER="ac",U.CLASS_MAIN="main",U.CLASS_CONTROLLER_ROW="cr",U.CLASS_TOO_TALL="taller-than-window",U.CLASS_CLOSED="closed",U.CLASS_CLOSE_BUTTON="close-button",U.CLASS_DRAG="drag",U.DEFAULT_WIDTH=245,U.TEXT_CLOSED="Close Controls",U.TEXT_OPEN="Open Controls",d.bind(window,"keydown",function(e){"text"===document.activeElement.type||e.which!==P&&e.keyCode!=P||U.toggleHide()},!1),p.extend(U.prototype,{add:function(e,t){return v(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return v(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.slice(this.__controllers.indexOf(e),1);var t=this;p.defer(function(){t.onResize()})},destroy:function(){this.autoPlace&&M.removeChild(this.domElement)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new U(t);this.__folders[e]=n;var r=g(this,n.domElement);return d.addClass(r,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=d.getOffset(e.__ul).top,n=0;p.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(n+=d.getHeight(t))}),window.innerHeight-t-I<n?(d.addClass(e.domElement,U.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-I+"px"):(d.removeClass(e.domElement,U.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&p.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},remember:function(){if(p.isUndefined(C)&&(C=new h,C.domElement.innerHTML=t),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;p.each(Array.prototype.slice.call(arguments),function(t){0==e.__rememberedObjects.length&&b(e),e.__rememberedObjects.indexOf(t)==-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&E(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=x(this)),e.folders={},p.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=x(this),S(this,!1)},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[N]=x(this,!0)),this.load.remembered[e]=x(this),this.preset=e,A(this,e,!0)},revert:function(e){p.each(this.__controllers,function(t){this.getRoot().load.remembered?_(e||this.getRoot(),t):t.setValue(t.initialValue)},this),p.each(this.__folders,function(e){e.revert(e)}),e||S(this.getRoot(),!1)},listen:function(e){var t=0==this.__listening.length;this.__listening.push(e),t&&R(this.__listening)}}),U}(n.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",n.controllers.factory=function(e,t,n,r,i,o,a){return function(s,c){var u=s[c];return a.isArray(arguments[2])||a.isObject(arguments[2])?new e(s,c,arguments[2]):a.isNumber(u)?a.isNumber(arguments[2])&&a.isNumber(arguments[3])?new n(s,c,arguments[2],arguments[3]):new t(s,c,{min:arguments[2],max:arguments[3]}):a.isString(u)?new r(s,c):a.isFunction(u)?new i(s,c,""):a.isBoolean(u)?new o(s,c):void 0}}(n.controllers.OptionController,n.controllers.NumberControllerBox,n.controllers.NumberControllerSlider,n.controllers.StringController=function(e,t,n){var r=function(e,n){function i(){a.setValue(a.__input.value)}function o(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}r.superclass.call(this,e,n);var a=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"keyup",i),t.bind(this.__input,"change",i),t.bind(this.__input,"blur",o),t.bind(this.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=e,n.extend(r.prototype,e.prototype,{updateDisplay:function(){return t.isActive(this.__input)||(this.__input.value=this.getValue()),r.superclass.prototype.updateDisplay.call(this)}}),r}(n.controllers.Controller,n.dom.dom,n.utils.common),n.controllers.FunctionController,n.controllers.BooleanController,n.utils.common),n.controllers.Controller,n.controllers.BooleanController,n.controllers.FunctionController,n.controllers.NumberControllerBox,n.controllers.NumberControllerSlider,n.controllers.OptionController,n.controllers.ColorController=function(e,t,n,r,i){function o(e,t,n,r){e.style.background="",i.each(c,function(i){e.style.cssText+="background: "+i+"linear-gradient("+t+", "+n+" 0%, "+r+" 100%); "})}function a(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var s=function(e,c){function u(e){d(e),t.bind(window,"mousemove",d),t.bind(window,"mouseup",l)}function l(){t.unbind(window,"mousemove",d),t.unbind(window,"mouseup",l)}function f(){var e=r(this.value);e!==!1?(v.__color.__state=e,v.setValue(v.__color.toOriginal())):this.value=v.__color.toString()}function h(){t.unbind(window,"mousemove",p),t.unbind(window,"mouseup",h)}function d(e){e.preventDefault();var n=t.getWidth(v.__saturation_field),r=t.getOffset(v.__saturation_field),i=(e.clientX-r.left+document.body.scrollLeft)/n,o=1-(e.clientY-r.top+document.body.scrollTop)/n;return o>1?o=1:o<0&&(o=0),i>1?i=1:i<0&&(i=0),v.__color.v=o,v.__color.s=i,v.setValue(v.__color.toOriginal()),!1}function p(e){e.preventDefault();var n=t.getHeight(v.__hue_field),r=t.getOffset(v.__hue_field),i=1-(e.clientY-r.top+document.body.scrollTop)/n;return i>1?i=1:i<0&&(i=0),v.__color.h=360*i,v.setValue(v.__color.toOriginal()),!1}s.superclass.call(this,e,c),this.__color=new n(this.getValue()),this.__temp=new n(0);var v=this;this.domElement=document.createElement("div"),t.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",t.bind(this.__input,"keydown",function(e){13===e.keyCode&&f.call(this)}),t.bind(this.__input,"blur",f),t.bind(this.__selector,"mousedown",function(e){t.addClass(this,"drag").bind(window,"mouseup",function(e){t.removeClass(v.__selector,"drag")})});var g=document.createElement("div");i.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),i.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),i.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),i.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),i.extend(g.style,{width:"100%",height:"100%",background:"none"}),o(g,"top","rgba(0,0,0,0)","#000"),i.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),a(this.__hue_field),i.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),t.bind(this.__saturation_field,"mousedown",u),t.bind(this.__field_knob,"mousedown",u),t.bind(this.__hue_field,"mousedown",function(e){p(e),t.bind(window,"mousemove",p),t.bind(window,"mouseup",h)}),this.__saturation_field.appendChild(g),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};s.superclass=e,i.extend(s.prototype,e.prototype,{updateDisplay:function(){var e=r(this.getValue());if(e!==!1){var t=!1;i.each(n.COMPONENTS,function(n){if(!i.isUndefined(e[n])&&!i.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}},this),t&&i.extend(this.__color.__state,e)}i.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var a=this.__color.v<.5||this.__color.s>.5?255:0,s=255-a;i.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+a+","+a+","+a+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,o(this.__saturation_field,"left","#fff",this.__temp.toString()),i.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+a+","+a+","+a+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}});var c=["-moz-","-o-","-webkit-","-ms-",""];return s}(n.controllers.Controller,n.dom.dom,n.color.Color=function(e,t,n,r){function i(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(a(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(a(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function o(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(s(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[t]=e}})}function a(e,n,i){if("HEX"===e.__state.space)e.__state[n]=t.component_from_hex(e.__state.hex,i);else{if("HSV"!==e.__state.space)throw"Corrupted color state";r.extend(e.__state,t.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}}function s(e){var n=t.rgb_to_hsv(e.r,e.g,e.b);r.extend(e.__state,{s:n.s,v:n.v}),r.isNaN(n.h)?r.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=n.h}var c=function(){if(this.__state=e.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return c.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(c.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),i(c.prototype,"r",2),i(c.prototype,"g",1),i(c.prototype,"b",0),o(c.prototype,"h"),o(c.prototype,"s"),o(c.prototype,"v"),Object.defineProperty(c.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(c.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=t.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),c}(n.color.interpret,n.color.math=function(){var e;return{hsv_to_rgb:function(e,t,n){var r=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),o=n*(1-t),a=n*(1-i*t),s=n*(1-(1-i)*t),c=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];
return{r:255*c[0],g:255*c[1],b:255*c[2]}},rgb_to_hsv:function(e,t,n){var r,i,o=Math.min(e,t,n),a=Math.max(e,t,n),s=a-o;return 0==a?{h:NaN,s:0,v:0}:(i=s/a,r=e==a?(t-n)/s:t==a?2+(n-e)/s:4+(e-t)/s,r/=6,r<0&&(r+=1),{h:360*r,s:i,v:a/255})},rgb_to_hex:function(e,t,n){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),r=this.hex_with_component(r,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(t,n,r){return r<<(e=8*n)|t&~(255<<e)}}}(),n.color.toString,n.utils.common),n.color.interpret,n.utils.common),n.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}(),n.dom.CenteredDiv=function(e,t){var n=function(){this.backgroundElement=document.createElement("div"),t.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),e.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),t.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;e.bind(this.backgroundElement,"click",function(){n.hide()})};return n.prototype.show=function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),t.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})},n.prototype.hide=function(){var t=this,n=function(){t.domElement.style.display="none",t.backgroundElement.style.display="none",e.unbind(t.domElement,"webkitTransitionEnd",n),e.unbind(t.domElement,"transitionend",n),e.unbind(t.domElement,"oTransitionEnd",n)};e.bind(this.domElement,"webkitTransitionEnd",n),e.bind(this.domElement,"transitionend",n),e.bind(this.domElement,"oTransitionEnd",n),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},n.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-e.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-e.getHeight(this.domElement)/2+"px"},n}(n.dom.dom,n.utils.common),n.dom.dom,n.utils.common)},function(e,t){var n=e.exports=n||{};n.color=n.color||{},n.utils=n.utils||{},n.utils.common=function(){var e=Array.prototype.forEach,t=Array.prototype.slice;return{BREAK:{},extend:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(t[n])||(e[n]=t[n])},this),e},defaults:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(e[n])&&(e[n]=t[n])},this),e},compose:function(){var e=t.call(arguments);return function(){for(var n=t.call(arguments),r=e.length-1;r>=0;r--)n=[e[r].apply(this,n)];return n[0]}},each:function(t,n,r){if(e&&t.forEach===e)t.forEach(n,r);else if(t.length===t.length+0){for(var i=0,o=t.length;i<o;i++)if(i in t&&n.call(r,t[i],i)===this.BREAK)return}else for(var i in t)if(n.call(r,t[i],i)===this.BREAK)return},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():t.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){return e!==e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}}}(),n.color.toString=function(e){return function(t){if(1==t.a||e.isUndefined(t.a)){for(var n=t.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+","+t.a+")"}}(n.utils.common),n.Color=n.color.Color=function(e,t,n,r){function i(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(a(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(a(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function o(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(s(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[t]=e}})}function a(e,n,i){if("HEX"===e.__state.space)e.__state[n]=t.component_from_hex(e.__state.hex,i);else{if("HSV"!==e.__state.space)throw"Corrupted color state";r.extend(e.__state,t.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}}function s(e){var n=t.rgb_to_hsv(e.r,e.g,e.b);r.extend(e.__state,{s:n.s,v:n.v}),r.isNaN(n.h)?r.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=n.h}var c=function(){if(this.__state=e.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return c.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(c.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),i(c.prototype,"r",2),i(c.prototype,"g",1),i(c.prototype,"b",0),o(c.prototype,"h"),o(c.prototype,"s"),o(c.prototype,"v"),Object.defineProperty(c.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(c.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=t.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),c}(n.color.interpret=function(e,t){var n,r,i=function(){r=!1;var e=arguments.length>1?t.toArray(arguments):arguments[0];return t.each(o,function(i){if(i.litmus(e))return t.each(i.conversions,function(i,o){if(n=i.read(e),r===!1&&n!==!1)return r=n,n.conversionName=o,n.conversion=i,t.BREAK}),t.BREAK}),r},o=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString())}},write:e},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString())}},write:e},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:e},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:e}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4==e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return i}(n.color.toString,n.utils.common),n.color.math=function(){var e;return{hsv_to_rgb:function(e,t,n){var r=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),o=n*(1-t),a=n*(1-i*t),s=n*(1-(1-i)*t),c=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];return{r:255*c[0],g:255*c[1],b:255*c[2]}},rgb_to_hsv:function(e,t,n){var r,i,o=Math.min(e,t,n),a=Math.max(e,t,n),s=a-o;return 0==a?{h:NaN,s:0,v:0}:(i=s/a,r=e==a?(t-n)/s:t==a?2+(n-e)/s:4+(e-t)/s,r/=6,r<0&&(r+=1),{h:360*r,s:i,v:a/255})},rgb_to_hex:function(e,t,n){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),r=this.hex_with_component(r,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(t,n,r){return r<<(e=8*n)|t&~(255<<e)}}}(),n.color.toString,n.utils.common)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Tendrils=t.glSettings=t.defaults=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(54),u=r(c),l=n(80),f=r(l),h=n(82),d=r(h),p=n(97),v=r(p),g=n(113),m=n(115),_=r(m),y=n(117),b=n(118),w=r(b),E=n(119),x=r(E),A=n(120),T=r(A),S=n(121),R=r(S),C=n(122),M=r(C),O=n(123),P=r(O),I=n(124),N=r(I),D=n(114),L=r(D),F=n(125),k=r(F),U=n(126),j=r(U),B=t.defaults=function(){return{state:{rootNum:Math.pow(2,9),paused:!1,timeStep:1e3/60,autoClearView:!1,showFlow:!0,minSpeed:1e-6,maxSpeed:.01,damping:.045,flowDecay:5e-4,flowWidth:5,noiseSpeed:25e-5,noiseScale:2.125,forceWeight:.015,flowWeight:1,wanderWeight:.001,color:[1,1,1,.01],baseColor:[0,0,0,0],fadeAlpha:-1,speedAlpha:1e-6,lineWidth:1,respawnAmount:.02},logicShader:null,renderShader:[T["default"],R["default"]],flowShader:[M["default"],N["default"]],flowScreenShader:[P["default"],N["default"]],fadeShader:[L["default"],j["default"]]}},V=(t.glSettings={preserveDrawingBuffer:!0},t.Tendrils=function(){function e(t,n){o(this,e);var r=a({},B(),n);this.gl=t,this.state=r.state,this.screen=new w["default"](this.gl),this.flow=(0,f["default"])(this.gl,[1,1],{"float":!0}),this.buffers=[(0,f["default"])(this.gl,[1,1]),(0,f["default"])(this.gl,[1,1])],this.baseShader=(0,u["default"])(this.gl,L["default"],k["default"]),this.logicShader=null,this.renderShader=Array.isArray(r.renderShader)?u["default"].apply(void 0,[this.gl].concat(i(r.renderShader))):r.renderShader,this.flowShader=Array.isArray(r.flowShader)?u["default"].apply(void 0,[this.gl].concat(i(r.flowShader))):r.flowShader,this.flowScreenShader=Array.isArray(r.flowScreenShader)?u["default"].apply(void 0,[this.gl].concat(i(r.flowScreenShader))):r.flowScreenShader,this.fadeShader=Array.isArray(r.fadeShader)?u["default"].apply(void 0,[this.gl].concat(i(r.fadeShader))):r.fadeShader,this.uniforms={render:{},update:{}},this.particles=null,this.viewRes=[0,0],this.viewSize=[0,0],this.time=this.start=Date.now(),this.tempData=[],this.respawnOffset=[0,0],this.respawnShape=[0,0],this.spawnCache=null,this.spawnCacheOffset=0}return s(e,[{key:"setup",value:function(){this.setupParticles.apply(this,arguments),this.setupRespawn.apply(this,arguments)}},{key:"reset",value:function(){this.resetParticles(),this.setupRespawn()}},{key:"dispose",value:function(){this.particles.dispose(),delete this.particles,delete this.spawnCache}},{key:"setupParticles",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.state.rootNum:arguments[0],t=[e,e];this.particles=new v["default"](this.gl,{shape:t,geomShape:[t[0],2*t[1]],logicFrag:x["default"],render:this.renderShader}),this.logicShader=this.particles.logic,this.particles.setup(this.state.numBuffers||2)}},{key:"resetParticles",value:function(){var e=arguments.length<=0||void 0===arguments[0]?_["default"]:arguments[0];this.particles.spawn(e)}},{key:"clear",value:function(){this.clearView(),this.clearFlow()}},{key:"clearView",value:function(){var e=this;this.buffers.forEach(function(t){t.bind(),e.gl.clear(e.gl.COLOR_BUFFER_BIT)}),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clear(this.gl.COLOR_BUFFER_BIT)}},{key:"clearFlow",value:function(){this.flow.bind(),this.gl.clear(this.gl.COLOR_BUFFER_BIT)}},{key:"restart",value:function(){this.clear(),this.reset()}},{key:"draw",value:function(){var e=this.directDraw();this.resize(e);var t=this.tick();this.state.paused||(this.particles.logic=this.logicShader,this.gl.disable(this.gl.BLEND),Object.assign(this.uniforms.update,this.state,{dt:t,time:this.time,start:this.start,flow:this.flow.color[0].bind(1),viewSize:this.viewSize,viewRes:this.viewRes}),this.particles.step(this.uniforms.update),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)),Object.assign(this.uniforms.render,this.state,{time:this.time,previous:this.particles.buffers[1].color[0].bind(2),dataRes:this.particles.shape,viewSize:this.viewSize,viewRes:this.viewRes}),this.particles.render=this.flowShader,this.flow.bind(),this.gl.lineWidth(this.state.flowWidth),this.particles.draw(this.uniforms.render,this.gl.LINES),this.state.baseColor[3]>0&&(this.baseShader.bind(),this.baseShader.uniforms.color=this.state.baseColor,this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.screen.render()),this.state.showFlow&&(this.particles.render=this.flowScreenShader,this.state.lineWidth>0&&this.gl.lineWidth(this.state.lineWidth),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.particles.draw(this.uniforms.render,this.gl.LINES)),this.particles.render=this.renderShader,this.gl.lineWidth(this.state.lineWidth),e?(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.state.autoClearView&&this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.particles.draw(this.uniforms.render,this.gl.LINES)):(this.buffers[0].bind(),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.fadeShader.bind(),Object.assign(this.fadeShader.uniforms,{opacity:this.state.fadeAlpha,view:this.buffers[1].color[0].bind(1),viewRes:this.viewRes}),this.screen.render(),this.particles.draw(this.uniforms.render,this.gl.LINES),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.fadeShader.bind(),Object.assign(this.fadeShader.uniforms,{opacity:1,view:this.buffers[0].color[0].bind(2),viewRes:this.viewRes}),this.screen.render(),(0,g.step)(this.buffers))}},{key:"resize",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?this.directDraw():arguments[0];this.viewRes[0]=this.gl.drawingBufferWidth,this.viewRes[1]=this.gl.drawingBufferHeight,(0,y.maxAspect)(this.viewSize,this.viewRes),t||this.buffers.forEach(function(t){return t.shape=e.viewRes}),this.flow.shape=this.viewRes,this.gl.viewport(0,0,this.viewRes[0],this.viewRes[1])}},{key:"directDraw",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.state:arguments[0];return e.autoClearView||e.fadeAlpha<0}},{key:"respawn",value:function(){var e,t,n=arguments.length<=0||void 0===arguments[0]?_["default"]:arguments[0];this.offsetRespawn(this.respawnOffset,this.respawnShape,this.particles.shape),this.particles.spawn(n,(e=(t=this.particles.pixels).lo.apply(t,i(this.respawnOffset))).hi.apply(e,i(this.respawnShape)),this.respawnOffset)}},{key:"respawnShader",value:function(e,t){this.resize(!1),this.particles.logic=e,this.gl.disable(this.gl.BLEND),this.particles.step(v["default"].applyUpdate(a({},this.state,{time:this.time,viewSize:this.viewSize,viewRes:this.viewRes}),t)),this.particles.logic=this.logicShader,this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)}},{key:"respawnCached",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?_["default"]:arguments[0];this.offsetRespawn(this.respawnOffset,this.spawnCache.shape,this.particles.shape),this.particles.buffers.forEach(function(t){return t.color[0].setPixels(e.spawnCache,e.respawnOffset)}),this.spawnCacheOffset+=4*this.spawnCache.shape[0],this.spawnCacheOffset>=this.spawnCache.data.length&&(this.spawnCacheOffset=0),this.spawnCacheOffset=Math.min(this.spawnCacheOffset,this.spawnCache.data.length-4*this.spawnCache.shape[0]);for(var n=0;n<this.spawnCache.shape[1];n+=4)this.spawnCache.data.set(t(this.tempData),this.spawnCacheOffset+n)}},{key:"setupRespawn",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.state.rootNum:arguments[0],t=arguments.length<=1||void 0===arguments[1]?this.state.respawnAmount:arguments[1],n=Math.ceil(e*t);this.respawnShape.fill(n),this.respawnOffset.fill(0)}},{key:"setupSpawnCache",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.respawnShape:arguments[0];this.spawnCache=(0,d["default"])(new Float32Array(e[0]*e[1]*4),[e[0],e[1],4])}},{key:"resetSpawnCache",value:function(){for(var e=arguments.length<=0||void 0===arguments[0]?_["default"]:arguments[0],t=0;t<this.spawnCache.shape[0];++t)for(var n=0;n<this.spawnCache.shape[1];++n){var r=e(this.tempData);this.spawnCache.set(t,n,0,r[0]),this.spawnCache.set(t,n,1,r[1]),this.spawnCache.set(t,n,2,r[2]),this.spawnCache.set(t,n,3,r[3])}}},{key:"offsetRespawn",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.respawnOffset:arguments[0],t=arguments.length<=1||void 0===arguments[1]?this.respawnShape:arguments[1],n=arguments.length<=2||void 0===arguments[2]?this.particles.shape:arguments[2];return e[0]+=t[0],e[0]>=n[0]&&(e[0]=0,e[1]+=t[1]),e[0]=Math.min(e[0],n[0]-t[0]),e[1]>=n[1]&&(e[1]=0),e[1]=Math.min(e[1],n[1]-t[1]),e}},{key:"getTime",value:function(){var e=arguments.length<=0||void 0===arguments[0]?Date.now():arguments[0];return e-this.start}},{key:"tick",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.state.timeStep:arguments[0],t=this.time;return this.time=this.getTime(),this.dt=e||this.time-t}}]),e}());t["default"]=V},function(e,t,n){"use strict";function r(e){this.gl=e,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}function i(e,t){return e.name<t.name?-1:1}function o(e,t,n,i,o){var a=new r(e);return a.update(t,n,i,o),a}var a=n(55),s=n(58),c=n(56),u=n(59),l=n(79),f=n(57),h=r.prototype;h.bind=function(){this.program||this._relink();var e,t=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),n=this.gl.lastAttribCount;if(t>n)for(e=n;e<t;e++)this.gl.enableVertexAttribArray(e);else if(n>t)for(e=t;e<n;e++)this.gl.disableVertexAttribArray(e);this.gl.lastAttribCount=t,this.gl.useProgram(this.program)},h.dispose=function(){for(var e=this.gl.lastAttribCount,t=0;t<e;t++)this.gl.disableVertexAttribArray(t);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},h.update=function(e,t,n,r){function o(){d.program=u.program(p,d._vref,d._fref,w,E);for(var e=0;e<n.length;++e)C[e]=p.getUniformLocation(d.program,n[e].name)}if(!t||1===arguments.length){var h=e;e=h.vertex,t=h.fragment,n=h.uniforms,r=h.attributes}var d=this,p=d.gl,v=d._vref;d._vref=u.shader(p,p.VERTEX_SHADER,e),v&&v.dispose(),d.vertShader=d._vref.shader;var g=this._fref;if(d._fref=u.shader(p,p.FRAGMENT_SHADER,t),g&&g.dispose(),d.fragShader=d._fref.shader,!n||!r){var m=p.createProgram();if(p.attachShader(m,d.fragShader),p.attachShader(m,d.vertShader),p.linkProgram(m),!p.getProgramParameter(m,p.LINK_STATUS)){var _=p.getProgramInfoLog(m);throw new f(_,"Error linking program:"+_)}n=n||l.uniforms(p,m),r=r||l.attributes(p,m),p.deleteProgram(m)}r=r.slice(),r.sort(i);var y,b=[],w=[],E=[];for(y=0;y<r.length;++y){var x=r[y];if(x.type.indexOf("mat")>=0){for(var A=0|x.type.charAt(x.type.length-1),T=new Array(A),S=0;S<A;++S)T[S]=E.length,w.push(x.name+"["+S+"]"),"number"==typeof x.location?E.push(x.location+S):Array.isArray(x.location)&&x.location.length===A&&"number"==typeof x.location[S]?E.push(0|x.location[S]):E.push(-1);b.push({name:x.name,type:x.type,locations:T})}else b.push({name:x.name,type:x.type,locations:[E.length]}),w.push(x.name),"number"==typeof x.location?E.push(0|x.location):E.push(-1)}var R=0;for(y=0;y<E.length;++y)if(E[y]<0){for(;E.indexOf(R)>=0;)R+=1;E[y]=R}var C=new Array(n.length);o(),d._relink=o,d.types={uniforms:c(n),attributes:c(r)},d.attributes=s(p,d,b,E),Object.defineProperty(d,"uniforms",a(p,d,n,C))},e.exports=o},function(e,t,n){"use strict";function r(e){var t=new Function("y","return function(){return y}");return t(e)}function i(e,t){for(var n=new Array(e),r=0;r<e;++r)n[r]=t;return n}function o(e,t,n,o){function c(n){var r=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+n+"])}");return r(e,t,o)}function u(e,t,n){switch(n){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+t+"],obj"+e+")";case"float":return"gl.uniform1f(locations["+t+"],obj"+e+")";default:var r=n.indexOf("vec");if(!(0<=r&&r<=1&&n.length===4+r)){if(0===n.indexOf("mat")&&4===n.length){var i=n.charCodeAt(n.length-1)-48;if(i<2||i>4)throw new s("","Invalid uniform dimension type for matrix "+name+": "+n);return"gl.uniformMatrix"+i+"fv(locations["+t+"],false,obj"+e+")"}throw new s("","Unknown uniform data type for "+name+": "+n)}var i=n.charCodeAt(n.length-1)-48;if(i<2||i>4)throw new s("","Invalid data type");switch(n.charAt(0)){case"b":case"i":return"gl.uniform"+i+"iv(locations["+t+"],obj"+e+")";case"v":return"gl.uniform"+i+"fv(locations["+t+"],obj"+e+")";default:throw new s("","Unrecognized data type for vector "+name+": "+n)}}}function l(e,t){if("object"!=typeof t)return[[e,t]];var n=[];for(var r in t){var i=t[r],o=e;o+=parseInt(r)+""===r?"["+r+"]":"."+r,"object"==typeof i?n.push.apply(n,l(o,i)):n.push([o,i])}return n}function f(t){for(var r=["return function updateProperty(obj){"],i=l("",t),a=0;a<i.length;++a){var s=i[a],c=s[0],f=s[1];o[f]&&r.push(u(c,f,n[f].type))}r.push("return obj}");var h=new Function("gl","locations",r.join("\n"));return h(e,o)}function h(e){switch(e){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var t=e.indexOf("vec");if(0<=t&&t<=1&&e.length===4+t){var n=e.charCodeAt(e.length-1)-48;if(n<2||n>4)throw new s("","Invalid data type");return"b"===e.charAt(0)?i(n,!1):i(n,0)}if(0===e.indexOf("mat")&&4===e.length){var n=e.charCodeAt(e.length-1)-48;if(n<2||n>4)throw new s("","Invalid uniform dimension type for matrix "+name+": "+e);return i(n*n,0)}throw new s("","Unknown uniform data type for "+name+": "+e)}}function d(e,t,i){if("object"==typeof i){var a=p(i);Object.defineProperty(e,t,{get:r(a),set:f(i),enumerable:!0,configurable:!1})}else o[i]?Object.defineProperty(e,t,{get:c(i),set:f(i),enumerable:!0,configurable:!1}):e[t]=h(n[i].type)}function p(e){var t;if(Array.isArray(e)){t=new Array(e.length);for(var n=0;n<e.length;++n)d(t,n,e[n])}else{t={};for(var r in e)d(t,r,e[r])}return t}var v=a(n,!0);return{get:r(p(v)),set:f(v),enumerable:!0,configurable:!0}}var a=n(56),s=n(57);e.exports=o},function(e,t){"use strict";function n(e,t){for(var n={},r=0;r<e.length;++r)for(var i=e[r].name,o=i.split("."),a=n,s=0;s<o.length;++s){var c=o[s].split("[");if(c.length>1){c[0]in a||(a[c[0]]=[]),a=a[c[0]];for(var u=1;u<c.length;++u){var l=parseInt(c[u]);u<c.length-1||s<o.length-1?(l in a||(u<c.length-1?a[l]=[]:a[l]={}),a=a[l]):t?a[l]=r:a[l]=e[r].type}}else s<o.length-1?(c[0]in a||(a[c[0]]={}),a=a[c[0]]):t?a[c[0]]=r:a[c[0]]=e[r].type}return n}e.exports=n},function(e,t){function n(e,t,n){this.shortMessage=t||"",this.longMessage=n||"",this.rawError=e||"",this.message="gl-shader: "+(t||e||"")+(n?"\n"+n:""),this.stack=(new Error).stack}n.prototype=new Error,n.prototype.name="GLError",n.prototype.constructor=n,e.exports=n},function(e,t,n){"use strict";function r(e,t,n,r,i,o){this._gl=e,this._wrapper=t,this._index=n,this._locations=r,this._dimension=i,this._constFunc=o}function i(e,t,n,i,o,a,s){for(var c=["gl","v"],u=[],l=0;l<o;++l)c.push("x"+l),u.push("x"+l);c.push("if(x0.length===void 0){return gl.vertexAttrib"+o+"f(v,"+u.join()+")}else{return gl.vertexAttrib"+o+"fv(v,x0)}");var f=Function.apply(null,c),h=new r(e,t,n,i,o,f);Object.defineProperty(a,s,{set:function(t){return e.disableVertexAttribArray(i[n]),f(e,i[n],t),t},get:function(){return h},enumerable:!0})}function o(e,t,n,r,o,a,s){for(var c=new Array(o),u=new Array(o),l=0;l<o;++l)i(e,t,n[l],r,o,c,l),u[l]=c[l];Object.defineProperty(c,"location",{set:function(e){if(Array.isArray(e))for(var t=0;t<o;++t)u[t].location=e[t];else for(var t=0;t<o;++t)u[t].location=e+t;return e},get:function(){for(var e=new Array(o),t=0;t<o;++t)e[t]=r[n[t]];return e},enumerable:!0}),c.pointer=function(t,i,a,s){t=t||e.FLOAT,i=!!i,a=a||o*o,s=s||0;for(var c=0;c<o;++c){var u=r[n[c]];e.vertexAttribPointer(u,o,t,i,a,s+c*o),e.enableVertexAttribArray(u)}};var f=new Array(o),h=e["vertexAttrib"+o+"fv"];Object.defineProperty(a,s,{set:function(t){for(var i=0;i<o;++i){var a=r[n[i]];if(e.disableVertexAttribArray(a),Array.isArray(t[0]))h.call(e,a,t[i]);else{for(var s=0;s<o;++s)f[s]=t[o*i+s];h.call(e,a,f)}}return t},get:function(){return c},enumerable:!0})}function a(e,t,n,r){for(var a={},c=0,u=n.length;c<u;++c){var l=n[c],f=l.name,h=l.type,d=l.locations;switch(h){case"bool":case"int":case"float":i(e,t,d[0],r,1,a,f);break;default:if(h.indexOf("vec")>=0){var p=h.charCodeAt(h.length-1)-48;if(p<2||p>4)throw new s("","Invalid data type for attribute "+f+": "+h);i(e,t,d[0],r,p,a,f)}else{if(!(h.indexOf("mat")>=0))throw new s("","Unknown data type for attribute "+f+": "+h);var p=h.charCodeAt(h.length-1)-48;if(p<2||p>4)throw new s("","Invalid data type for attribute "+f+": "+h);o(e,t,d,r,p,a,f)}}}return a}e.exports=a;var s=n(57),c=r.prototype;c.pointer=function(e,t,n,r){var i=this,o=i._gl,a=i._locations[i._index];o.vertexAttribPointer(a,i._dimension,e||o.FLOAT,!!t,n||0,r||0),o.enableVertexAttribArray(a)},c.set=function(e,t,n,r){return this._constFunc(this._locations[this._index],e,t,n,r)},Object.defineProperty(c,"location",{get:function(){return this._locations[this._index]},set:function(e){return e!==this._locations[this._index]&&(this._locations[this._index]=0|e,this._wrapper.program=null),0|e}})},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){this.id=e,this.src=t,this.type=n,this.shader=r,this.count=o,this.programs=[],this.cache=a}function i(e){this.gl=e,this.shaders=[{},{}],this.programs={}}function o(e,t,n){var r=e.createShader(t);if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(r);try{var o=f(i,n,t)}catch(a){throw console.warn("Failed to format compiler error: "+a),new l(i,"Error compiling shader:\n"+i)}throw new l(i,o["short"],o["long"])}return r}function a(e,t,n,r,i){var o=e.createProgram();e.attachShader(o,t),e.attachShader(o,n);for(var a=0;a<r.length;++a)e.bindAttribLocation(o,i[a],r[a]);if(e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS)){var s=e.getProgramInfoLog(o);throw new l(s,"Error linking program: "+s)}return o}function s(e){var t=d.get(e);return t||(t=new i(e),d.set(e,t)),t}function c(e,t,n){return s(e).getShaderReference(t,n)}function u(e,t,n,r,i){return s(e).getProgram(t,n,r,i)}t.shader=c,t.program=u;var l=n(57),f=n(60),h="undefined"==typeof WeakMap?n(76):WeakMap,d=new h,p=0;r.prototype.dispose=function(){if(0===--this.count){for(var e=this.cache,t=e.gl,n=this.programs,r=0,i=n.length;r<i;++r){var o=e.programs[n[r]];o&&(delete e.programs[r],t.deleteProgram(o))}t.deleteShader(this.shader),delete e.shaders[this.type===t.FRAGMENT_SHADER|0][this.src]}};var v=i.prototype;v.getShaderReference=function(e,t){var n=this.gl,i=this.shaders[e===n.FRAGMENT_SHADER|0],a=i[t];if(a&&n.isShader(a.shader))a.count+=1;else{var s=o(n,e,t);a=i[t]=new r((p++),t,e,s,[],1,this)}return a},v.getProgram=function(e,t,n,r){var i=[e.id,t.id,n.join(":"),r.join(":")].join("@"),o=this.programs[i];return o&&this.gl.isProgram(o)||(this.programs[i]=o=a(this.gl,e.shader,t.shader,n,r),e.programs.push(i),t.programs.push(i)),o}},function(e,t,n){function r(e,t,n){"use strict";var r=a(t)||"of unknown name (see npm glsl-shader-name)",c="unknown type";void 0!==n&&(c=n===o.FRAGMENT_SHADER?"fragment":"vertex");for(var u=i("Error compiling %s shader %s:\n",c,r),l=i("%s%s",u,e),f=e.split("\n"),h={},d=0;d<f.length;d++){var p=f[d];if(""!==p){var v=parseInt(p.split(":")[2]);if(isNaN(v))throw new Error(i("Could not parse error: %s",p));h[v]=p}}for(var g=s(t).split("\n"),d=0;d<g.length;d++)if(h[d+3]||h[d+2]||h[d+1]){var m=g[d];if(u+=m+"\n",h[d+1]){var _=h[d+1];_=_.substr(_.split(":",3).join(":").length+1).trim(),u+=i("^^^ %s\n\n",_)}}return{"long":u.trim(),"short":l.trim()}}var i=n(61).sprintf,o=n(62),a=n(64),s=n(73);e.exports=r},function(e,t,n){!function(e){function n(){var e=arguments[0],t=n.cache;return t[e]&&t.hasOwnProperty(e)||(t[e]=n.parse(e)),n.format.call(null,t[e],arguments)}function r(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function i(e,t){return Array(t+1).join(e)}var o={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};n.format=function(e,t){var a,s,c,u,l,f,h,d=1,p=e.length,v="",g=[],m=!0,_="";for(s=0;s<p;s++)if(v=r(e[s]),"string"===v)g[g.length]=e[s];else if("array"===v){if(u=e[s],u[2])for(a=t[d],c=0;c<u[2].length;c++){if(!a.hasOwnProperty(u[2][c]))throw new Error(n("[sprintf] property '%s' does not exist",u[2][c]));a=a[u[2][c]]}else a=u[1]?t[u[1]]:t[d++];if("function"==r(a)&&(a=a()),o.not_string.test(u[8])&&o.not_json.test(u[8])&&"number"!=r(a)&&isNaN(a))throw new TypeError(n("[sprintf] expecting number but found %s",r(a)));switch(o.number.test(u[8])&&(m=a>=0),u[8]){case"b":a=a.toString(2);break;case"c":a=String.fromCharCode(a);break;case"d":case"i":a=parseInt(a,10);break;case"j":a=JSON.stringify(a,null,u[6]?parseInt(u[6]):0);break;case"e":a=u[7]?a.toExponential(u[7]):a.toExponential();break;case"f":a=u[7]?parseFloat(a).toFixed(u[7]):parseFloat(a);break;case"g":a=u[7]?parseFloat(a).toPrecision(u[7]):parseFloat(a);break;case"o":a=a.toString(8);break;case"s":a=(a=String(a))&&u[7]?a.substring(0,u[7]):a;break;case"u":a>>>=0;break;case"x":a=a.toString(16);break;case"X":a=a.toString(16).toUpperCase()}o.json.test(u[8])?g[g.length]=a:(!o.number.test(u[8])||m&&!u[3]?_="":(_=m?"+":"-",a=a.toString().replace(o.sign,"")),f=u[4]?"0"===u[4]?"0":u[4].charAt(1):" ",h=u[6]-(_+a).length,l=u[6]&&h>0?i(f,h):"",g[g.length]=u[5]?_+a+l:"0"===f?_+l+a:l+_+a)}return g.join("")},n.cache={},n.parse=function(e){for(var t=e,n=[],r=[],i=0;t;){if(null!==(n=o.text.exec(t)))r[r.length]=n[0];else if(null!==(n=o.modulo.exec(t)))r[r.length]="%";else{if(null===(n=o.placeholder.exec(t)))throw new SyntaxError("[sprintf] unexpected placeholder");if(n[2]){i|=1;var a=[],s=n[2],c=[];if(null===(c=o.key.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a[a.length]=c[1];""!==(s=s.substring(c[0].length));)if(null!==(c=o.key_access.exec(s)))a[a.length]=c[1];else{if(null===(c=o.index_access.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");a[a.length]=c[1]}n[2]=a}else i|=2;if(3===i)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");
r[r.length]=n}t=t.substring(n[0].length)}return r};var a=function(e,t,r){return r=(t||[]).slice(0),r.splice(0,0,e),n.apply(null,r)};t.sprintf=n,t.vsprintf=a}("undefined"==typeof window?this:window)},function(e,t,n){var r=n(63);e.exports=function(e){return r[e]}},function(e,t){e.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},function(e,t,n){function r(e){for(var t=Array.isArray(e)?e:i(e),n=0;n<t.length;n++){var r=t[n];if("preprocessor"===r.type){var a=r.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(a&&a[2]){var s=a[1],c=a[2];return(s?o(c):c).trim()}}}}var i=n(65),o=n(72);e.exports=r},function(e,t,n){function r(e,t){var n=i(t),r=[];return r=r.concat(n(e)),r=r.concat(n(null))}var i=n(66);e.exports=r},function(e,t,n){function r(e){function t(e){e.length&&z.push({type:x[B],data:e,position:X,line:G,column:H})}function n(e){U=0,W+=e,k=W.length;for(var t;L=W[U],U<k;){switch(t=U,B){case f:U=C();break;case h:U=R();break;case d:U=S();break;case p:U=M();break;case v:U=I();break;case E:U=P();break;case g:U=N();break;case l:U=D();break;case b:U=T();break;case u:U=A()}if(t!==U)switch(W[t]){case"\n":H=0,++G;break;default:++H}}return j+=U,W=W.slice(U),z}function r(e){return V.length&&t(V.join("")),B=w,t("(eof)"),z}function A(){return V=V.length?[]:V,"/"===F&&"*"===L?(X=j+U-1,B=f,F=L,U+1):"/"===F&&"/"===L?(X=j+U-1,B=h,F=L,U+1):"#"===L?(B=d,X=j+U,U):/\s/.test(L)?(B=b,X=j+U,U):(Y=/\d/.test(L),q=/[^\w_]/.test(L),X=j+U,B=Y?v:q?p:l,U)}function T(){return/[^\s]/g.test(L)?(t(V.join("")),B=u,U):(V.push(L),F=L,U+1)}function S(){return"\r"!==L&&"\n"!==L||"\\"===F?(V.push(L),F=L,U+1):(t(V.join("")),B=u,U)}function R(){return S()}function C(){return"/"===L&&"*"===F?(V.push(L),t(V.join("")),B=u,U+1):(V.push(L),F=L,U+1)}function M(){if("."===F&&/\d/.test(L))return B=g,U;if("/"===F&&"*"===L)return B=f,U;if("/"===F&&"/"===L)return B=h,U;if("."===L&&V.length){for(;O(V););return B=g,U}if(";"===L||")"===L||"("===L){if(V.length)for(;O(V););return t(L),B=u,U+1}var e=2===V.length&&"="!==L;if(/[\w_\d\s]/.test(L)||e){for(;O(V););return B=u,U}return V.push(L),F=L,U+1}function O(e){for(var n,r,i=0;;){if(n=o.indexOf(e.slice(0,e.length+i).join("")),r=o[n],n===-1){if(i--+e.length>0)continue;r=e.slice(0,1).join("")}return t(r),X+=r.length,V=V.slice(r.length),V.length}}function P(){return/[^a-fA-F0-9]/.test(L)?(t(V.join("")),B=u,U):(V.push(L),F=L,U+1)}function I(){return"."===L?(V.push(L),B=g,F=L,U+1):/[eE]/.test(L)?(V.push(L),B=g,F=L,U+1):"x"===L&&1===V.length&&"0"===V[0]?(B=E,V.push(L),F=L,U+1):/[^\d]/.test(L)?(t(V.join("")),B=u,U):(V.push(L),F=L,U+1)}function N(){return"f"===L&&(V.push(L),F=L,U+=1),/[eE]/.test(L)?(V.push(L),F=L,U+1):"-"===L&&/[eE]/.test(F)?(V.push(L),F=L,U+1):/[^\d]/.test(L)?(t(V.join("")),B=u,U):(V.push(L),F=L,U+1)}function D(){if(/[^\d\w_]/.test(L)){var e=V.join("");return B=J.indexOf(e)>-1?y:K.indexOf(e)>-1?_:m,t(V.join("")),B=u,U}return V.push(L),F=L,U+1}var L,F,k,U=0,j=0,B=u,V=[],z=[],G=1,H=0,X=0,Y=!1,q=!1,W="";e=e||{};var K=a,J=i;return"300 es"===e.version&&(K=c,J=s),function(e){return z=[],null!==e?n(e.replace?e.replace(/\r\n/g,"\n"):e):r()}}e.exports=r;var i=n(67),o=n(68),a=n(69),s=n(70),c=n(71),u=999,l=9999,f=0,h=1,d=2,p=3,v=4,g=5,m=6,_=7,y=8,b=9,w=10,E=11,x=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},function(e,t){e.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},function(e,t){e.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},function(e,t){e.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},function(e,t,n){var r=n(67);e.exports=r.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},function(e,t,n){var r=n(69);r=r.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)}),e.exports=r.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},function(e,t){e.exports=function(e){return atob(e)}},function(e,t,n){function r(e,t,n){t="number"==typeof t?t:1,n=n||": ";var r=e.split(/\r?\n/),o=String(r.length+t-1).length;return r.map(function(e,r){var a=r+t,s=String(a).length,c=i(a,o-s);return c+n+e}).join("\n")}var i=n(74);e.exports=r},function(e,t,n){/*!
	 * pad-left <https://github.com/jonschlinkert/pad-left>
	 *
	 * Copyright (c) 2014-2015, Jon Schlinkert.
	 * Licensed under the MIT license.
	 */
"use strict";var r=n(75);e.exports=function(e,t,n){return n="undefined"!=typeof n?n+"":" ",r(n,t)+e}},function(e,t){/*!
	 * repeat-string <https://github.com/jonschlinkert/repeat-string>
	 *
	 * Copyright (c) 2014-2015, Jon Schlinkert.
	 * Licensed under the MIT License.
	 */
"use strict";function n(e,t){if("string"!=typeof e)throw new TypeError("repeat-string expects a string.");if(1===t)return e;if(2===t)return e+e;var n=e.length*t;for(r===e&&"undefined"!=typeof r||(r=e,i="");n>i.length&&t>0&&(1&t&&(i+=e),t>>=1);)e+=e;return i.substr(0,n)}var r,i="";e.exports=n},function(e,t,n){function r(){var e=i();return{get:function(t,n){var r=e(t);return r.hasOwnProperty("value")?r.value:n},set:function(t,n){e(t).value=n},has:function(t){return"value"in e(t)},"delete":function(t){return delete e(t).value}}}var i=n(77);e.exports=r},function(e,t,n){function r(){var e={};return function(t){if(("object"!=typeof t||null===t)&&"function"!=typeof t)throw new Error("Weakmap-shim: Key must be object");var n=t.valueOf(e);return n&&n.identity===e?n:i(t,e)}}var i=n(78);e.exports=r},function(e,t){function n(e,t){var n={identity:t},r=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(e){return e!==t?r.apply(this,arguments):n},writable:!0}),n}e.exports=n},function(e,t){"use strict";function n(e,t){if(!a){var n=Object.keys(o);a={};for(var r=0;r<n.length;++r){var i=n[r];a[e[i]]=o[i]}}return a[t]}function r(e,t){for(var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=[],o=0;o<r;++o){var a=e.getActiveUniform(t,o);if(a){var s=n(e,a.type);if(a.size>1)for(var c=0;c<a.size;++c)i.push({name:a.name.replace("[0]","["+c+"]"),type:s});else i.push({name:a.name,type:s})}}return i}function i(e,t){for(var r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=[],o=0;o<r;++o){var a=e.getActiveAttrib(t,o);a&&i.push({name:a.name,type:n(e,a.type)})}return i}t.uniforms=r,t.attributes=i;var o={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},a=null},function(e,t,n){"use strict";function r(e){var t=e.getParameter(e.FRAMEBUFFER_BINDING),n=e.getParameter(e.RENDERBUFFER_BINDING),r=e.getParameter(e.TEXTURE_BINDING_2D);return[t,n,r]}function i(e,t){e.bindFramebuffer(e.FRAMEBUFFER,t[0]),e.bindRenderbuffer(e.RENDERBUFFER,t[1]),e.bindTexture(e.TEXTURE_2D,t[2])}function o(e,t){var n=e.getParameter(t.MAX_COLOR_ATTACHMENTS_WEBGL);_=new Array(n+1);for(var r=0;r<=n;++r){for(var i=new Array(n),o=0;o<r;++o)i[o]=e.COLOR_ATTACHMENT0+o;for(var o=r;o<n;++o)i[o]=e.NONE;_[r]=i}}function a(e){switch(e){case p:throw new Error("gl-fbo: Framebuffer unsupported");case v:throw new Error("gl-fbo: Framebuffer incomplete attachment");case g:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case m:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function s(e,t,n,r,i,o){if(!r)return null;var a=d(e,t,n,i,r);return a.magFilter=e.NEAREST,a.minFilter=e.NEAREST,a.mipSamples=1,a.bind(),e.framebufferTexture2D(e.FRAMEBUFFER,o,e.TEXTURE_2D,a.handle,0),a}function c(e,t,n,r,i){var o=e.createRenderbuffer();return e.bindRenderbuffer(e.RENDERBUFFER,o),e.renderbufferStorage(e.RENDERBUFFER,r,t,n),e.framebufferRenderbuffer(e.FRAMEBUFFER,i,e.RENDERBUFFER,o),o}function u(e){var t=r(e.gl),n=e.gl,o=e.handle=n.createFramebuffer(),u=e._shape[0],l=e._shape[1],f=e.color.length,h=e._ext,d=e._useStencil,p=e._useDepth,v=e._colorType;n.bindFramebuffer(n.FRAMEBUFFER,o);for(var g=0;g<f;++g)e.color[g]=s(n,u,l,v,n.RGBA,n.COLOR_ATTACHMENT0+g);0===f?(e._color_rb=c(n,u,l,n.RGBA4,n.COLOR_ATTACHMENT0),h&&h.drawBuffersWEBGL(_[0])):f>1&&h.drawBuffersWEBGL(_[f]);var m=n.getExtension("WEBGL_depth_texture");m?d?e.depth=s(n,u,l,m.UNSIGNED_INT_24_8_WEBGL,n.DEPTH_STENCIL,n.DEPTH_STENCIL_ATTACHMENT):p&&(e.depth=s(n,u,l,n.UNSIGNED_SHORT,n.DEPTH_COMPONENT,n.DEPTH_ATTACHMENT)):p&&d?e._depth_rb=c(n,u,l,n.DEPTH_STENCIL,n.DEPTH_STENCIL_ATTACHMENT):p?e._depth_rb=c(n,u,l,n.DEPTH_COMPONENT16,n.DEPTH_ATTACHMENT):d&&(e._depth_rb=c(n,u,l,n.STENCIL_INDEX,n.STENCIL_ATTACHMENT));var y=n.checkFramebufferStatus(n.FRAMEBUFFER);if(y!==n.FRAMEBUFFER_COMPLETE){e._destroyed=!0,n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteFramebuffer(e.handle),e.handle=null,e.depth&&(e.depth.dispose(),e.depth=null),e._depth_rb&&(n.deleteRenderbuffer(e._depth_rb),e._depth_rb=null);for(var g=0;g<e.color.length;++g)e.color[g].dispose(),e.color[g]=null;e._color_rb&&(n.deleteRenderbuffer(e._color_rb),e._color_rb=null),i(n,t),a(y)}i(n,t)}function l(e,t,n,r,i,o,a,s){this.gl=e,this._shape=[0|t,0|n],this._destroyed=!1,this._ext=s,this.color=new Array(i);for(var c=0;c<i;++c)this.color[c]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=r,this._useDepth=o,this._useStencil=a;var l=this,f=[0|t,0|n];Object.defineProperties(f,{0:{get:function(){return l._shape[0]},set:function(e){return l.width=e}},1:{get:function(){return l._shape[1]},set:function(e){return l.height=e}}}),this._shapeVector=f,u(this)}function f(e,t,n){if(e._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(e._shape[0]!==t||e._shape[1]!==n){var o=e.gl,s=o.getParameter(o.MAX_RENDERBUFFER_SIZE);if(t<0||t>s||n<0||n>s)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");e._shape[0]=t,e._shape[1]=n;for(var c=r(o),u=0;u<e.color.length;++u)e.color[u].shape=e._shape;e._color_rb&&(o.bindRenderbuffer(o.RENDERBUFFER,e._color_rb),o.renderbufferStorage(o.RENDERBUFFER,o.RGBA4,e._shape[0],e._shape[1])),e.depth&&(e.depth.shape=e._shape),e._depth_rb&&(o.bindRenderbuffer(o.RENDERBUFFER,e._depth_rb),e._useDepth&&e._useStencil?o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,e._shape[0],e._shape[1]):e._useDepth?o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_COMPONENT16,e._shape[0],e._shape[1]):e._useStencil&&o.renderbufferStorage(o.RENDERBUFFER,o.STENCIL_INDEX,e._shape[0],e._shape[1])),o.bindFramebuffer(o.FRAMEBUFFER,e.handle);var l=o.checkFramebufferStatus(o.FRAMEBUFFER);l!==o.FRAMEBUFFER_COMPLETE&&(e.dispose(),i(o,c),a(l)),i(o,c)}}function h(e,t,n,r){p||(p=e.FRAMEBUFFER_UNSUPPORTED,v=e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,g=e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,m=e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var i=e.getExtension("WEBGL_draw_buffers");if(!_&&i&&o(e,i),Array.isArray(t)&&(r=n,n=0|t[1],t=0|t[0]),"number"!=typeof t)throw new Error("gl-fbo: Missing shape parameter");var a=e.getParameter(e.MAX_RENDERBUFFER_SIZE);if(t<0||t>a||n<0||n>a)throw new Error("gl-fbo: Parameters are too large for FBO");r=r||{};var s=1;if("color"in r){if(s=Math.max(0|r.color,0),s<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(s>1){if(!i)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(s>e.getParameter(i.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+s+" draw buffers")}}var c=e.UNSIGNED_BYTE,u=e.getExtension("OES_texture_float");if(r["float"]&&s>0){if(!u)throw new Error("gl-fbo: Context does not support floating point textures");c=e.FLOAT}else r.preferFloat&&s>0&&u&&(c=e.FLOAT);var f=!0;"depth"in r&&(f=!!r.depth);var h=!1;return"stencil"in r&&(h=!!r.stencil),new l(e,t,n,c,s,f,h,i)}var d=n(81);e.exports=h;var p,v,g,m,_=null,y=l.prototype;Object.defineProperties(y,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(e){if(Array.isArray(e)||(e=[0|e,0|e]),2!==e.length)throw new Error("gl-fbo: Shape vector must be length 2");var t=0|e[0],n=0|e[1];return f(this,t,n),[t,n]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(e){return e=0|e,f(this,e,this._shape[1]),e},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(e){return e=0|e,f(this,this._shape[0],e),e},enumerable:!1}}),y.bind=function(){if(!this._destroyed){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.handle),e.viewport(0,0,this._shape[0],this._shape[1])}},y.dispose=function(){if(!this._destroyed){this._destroyed=!0;var e=this.gl;e.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(e.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var t=0;t<this.color.length;++t)this.color[t].dispose(),this.color[t]=null;this._color_rb&&(e.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},function(e,t,n){"use strict";function r(e){g=[e.LINEAR,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_NEAREST],m=[e.NEAREST,e.LINEAR,e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR],_=[e.REPEAT,e.CLAMP_TO_EDGE,e.MIRRORED_REPEAT]}function i(e,t,n){var r=e.gl,i=r.getParameter(r.MAX_TEXTURE_SIZE);if(t<0||t>i||n<0||n>i)throw new Error("gl-texture2d: Invalid texture size");return e._shape=[t,n],e.bind(),r.texImage2D(r.TEXTURE_2D,0,e.format,t,n,0,e.format,e.type,null),e._mipLevels=[0],e}function o(e,t,n,r,i,o){this.gl=e,this.handle=t,this.format=i,this.type=o,this._shape=[n,r],this._mipLevels=[0],this._magFilter=e.NEAREST,this._minFilter=e.NEAREST,this._wrapS=e.CLAMP_TO_EDGE,this._wrapT=e.CLAMP_TO_EDGE,this._anisoSamples=1;var a=this,s=[this._wrapS,this._wrapT];Object.defineProperties(s,[{get:function(){return a._wrapS},set:function(e){return a.wrapS=e}},{get:function(){return a._wrapT},set:function(e){return a.wrapT=e}}]),this._wrapVector=s;var c=[this._shape[0],this._shape[1]];Object.defineProperties(c,[{get:function(){return a._shape[0]},set:function(e){return a.width=e}},{get:function(){return a._shape[1]},set:function(e){return a.height=e}}]),this._shapeVector=c}function a(e,t){return 3===e.length?1===t[2]&&t[1]===e[0]*e[2]&&t[0]===e[2]:1===t[0]&&t[1]===e[0]}function s(e,t,n,r,i,o,s,c){var u=c.dtype,l=c.shape.slice();if(l.length<2||l.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var f=0,h=0,g=a(l,c.stride.slice());"float32"===u?f=e.FLOAT:"float64"===u?(f=e.FLOAT,g=!1,u="float32"):"uint8"===u?f=e.UNSIGNED_BYTE:(f=e.UNSIGNED_BYTE,g=!1,u="uint8");var m=1;if(2===l.length)h=e.LUMINANCE,l=[l[0],l[1],1],c=d(c.data,l,[c.stride[0],c.stride[1],1],c.offset);else{if(3!==l.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===l[2])h=e.ALPHA;else if(2===l[2])h=e.LUMINANCE_ALPHA;else if(3===l[2])h=e.RGB;else{if(4!==l[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");h=e.RGBA}m=l[2]}if(h!==e.LUMINANCE&&h!==e.ALPHA||i!==e.LUMINANCE&&i!==e.ALPHA||(h=i),h!==i)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var _=c.size,b=s.indexOf(r)<0;if(b&&s.push(r),f===o&&g)0===c.offset&&c.data.length===_?b?e.texImage2D(e.TEXTURE_2D,r,i,l[0],l[1],0,i,o,c.data):e.texSubImage2D(e.TEXTURE_2D,r,t,n,l[0],l[1],i,o,c.data):b?e.texImage2D(e.TEXTURE_2D,r,i,l[0],l[1],0,i,o,c.data.subarray(c.offset,c.offset+_)):e.texSubImage2D(e.TEXTURE_2D,r,t,n,l[0],l[1],i,o,c.data.subarray(c.offset,c.offset+_));else{var w;w=o===e.FLOAT?v.mallocFloat32(_):v.mallocUint8(_);var E=d(w,l,[l[2],l[2]*l[0],1]);f===e.FLOAT&&o===e.UNSIGNED_BYTE?y(E,c):p.assign(E,c),b?e.texImage2D(e.TEXTURE_2D,r,i,l[0],l[1],0,i,o,w.subarray(0,_)):e.texSubImage2D(e.TEXTURE_2D,r,t,n,l[0],l[1],i,o,w.subarray(0,_)),o===e.FLOAT?v.freeFloat32(w):v.freeUint8(w)}}function c(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t}function u(e,t,n,r,i){var a=e.getParameter(e.MAX_TEXTURE_SIZE);if(t<0||t>a||n<0||n>a)throw new Error("gl-texture2d: Invalid texture shape");if(i===e.FLOAT&&!e.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var s=c(e);return e.texImage2D(e.TEXTURE_2D,0,r,t,n,0,r,i,null),new o(e,s,t,n,r,i)}function l(e,t,n,r){var i=c(e);return e.texImage2D(e.TEXTURE_2D,0,n,n,r,t),new o(e,i,0|t.width,0|t.height,n,r)}function f(e,t){var n=t.dtype,r=t.shape.slice(),i=e.getParameter(e.MAX_TEXTURE_SIZE);if(r[0]<0||r[0]>i||r[1]<0||r[1]>i)throw new Error("gl-texture2d: Invalid texture size");var s=a(r,t.stride.slice()),u=0;"float32"===n?u=e.FLOAT:"float64"===n?(u=e.FLOAT,s=!1,n="float32"):"uint8"===n?u=e.UNSIGNED_BYTE:(u=e.UNSIGNED_BYTE,s=!1,n="uint8");var l=0;if(2===r.length)l=e.LUMINANCE,r=[r[0],r[1],1],t=d(t.data,r,[t.stride[0],t.stride[1],1],t.offset);else{if(3!==r.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===r[2])l=e.ALPHA;else if(2===r[2])l=e.LUMINANCE_ALPHA;else if(3===r[2])l=e.RGB;else{if(4!==r[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");l=e.RGBA}}u!==e.FLOAT||e.getExtension("OES_texture_float")||(u=e.UNSIGNED_BYTE,s=!1);var f,h,g=t.size;if(s)f=0===t.offset&&t.data.length===g?t.data:t.data.subarray(t.offset,t.offset+g);else{var m=[r[2],r[2]*r[0],1];h=v.malloc(g,n);var _=d(h,r,m,0);"float32"!==n&&"float64"!==n||u!==e.UNSIGNED_BYTE?p.assign(_,t):y(_,t),f=h.subarray(0,g)}var b=c(e);return e.texImage2D(e.TEXTURE_2D,0,l,r[0],r[1],0,l,u,f),s||v.free(h),new o(e,b,r[0],r[1],l,u)}function h(e){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(g||r(e),"number"==typeof arguments[1])return u(e,arguments[1],arguments[2],arguments[3]||e.RGBA,arguments[4]||e.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return u(e,0|arguments[1][0],0|arguments[1][1],arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var t=arguments[1];if(t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement||t instanceof ImageData)return l(e,t,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE);if(t.shape&&t.data&&t.stride)return f(e,t)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}var d=n(82),p=n(85),v=n(90);e.exports=h;var g=null,m=null,_=null,y=function(e,t){p.muls(e,t,255)},b=o.prototype;Object.defineProperties(b,{minFilter:{get:function(){return this._minFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&g.indexOf(e)>=0&&(t.getExtension("OES_texture_float_linear")||(e=t.NEAREST)),m.indexOf(e)<0)throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e),this._minFilter=e}},magFilter:{get:function(){return this._magFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&g.indexOf(e)>=0&&(t.getExtension("OES_texture_float_linear")||(e=t.NEAREST)),m.indexOf(e)<0)throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e),this._magFilter=e}},mipSamples:{get:function(){return this._anisoSamples},set:function(e){var t=this._anisoSamples;if(this._anisoSamples=0|Math.max(e,1),t!==this._anisoSamples){var n=this.gl.getExtension("EXT_texture_filter_anisotropic");n&&this.gl.texParameterf(this.gl.TEXTURE_2D,n.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(e){if(this.bind(),_.indexOf(e)<0)throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,e),this._wrapS=e}},wrapT:{get:function(){return this._wrapT},set:function(e){if(this.bind(),_.indexOf(e)<0)throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,e),this._wrapT=e}},wrap:{get:function(){return this._wrapVector},set:function(e){if(Array.isArray(e)||(e=[e,e]),2!==e.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var t=0;t<2;++t)if(_.indexOf(e[t])<0)throw new Error("gl-texture2d: Unknown wrap mode "+e);this._wrapS=e[0],this._wrapT=e[1];var n=this.gl;return this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,this._wrapS),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,this._wrapT),e}},shape:{get:function(){return this._shapeVector},set:function(e){if(Array.isArray(e)){if(2!==e.length)throw new Error("gl-texture2d: Invalid texture shape")}else e=[0|e,0|e];return i(this,0|e[0],0|e[1]),[0|e[0],0|e[1]]}},width:{get:function(){return this._shape[0]},set:function(e){return e=0|e,i(this,e,this._shape[1]),e}},height:{get:function(){return this._shape[1]},set:function(e){return e=0|e,i(this,this._shape[0],e),e}}}),b.bind=function(e){var t=this.gl;return void 0!==e&&t.activeTexture(t.TEXTURE0+(0|e)),t.bindTexture(t.TEXTURE_2D,this.handle),void 0!==e?0|e:t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0},b.dispose=function(){this.gl.deleteTexture(this.handle)},b.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var e=Math.min(this._shape[0],this._shape[1]),t=0;e>0;++t,e>>>=1)this._mipLevels.indexOf(t)<0&&this._mipLevels.push(t)},b.setPixels=function(e,t,n,r){var i=this.gl;if(this.bind(),Array.isArray(t)?(r=n,n=0|t[1],t=0|t[0]):(t=t||0,n=n||0),r=r||0,e instanceof HTMLCanvasElement||e instanceof ImageData||e instanceof HTMLImageElement||e instanceof HTMLVideoElement){var o=this._mipLevels.indexOf(r)<0;o?(i.texImage2D(i.TEXTURE_2D,0,this.format,this.format,this.type,e),this._mipLevels.push(r)):i.texSubImage2D(i.TEXTURE_2D,r,t,n,this.format,this.type,e)}else{if(!(e.shape&&e.stride&&e.data))throw new Error("gl-texture2d: Unsupported data type");if(e.shape.length<2||t+e.shape[1]>this._shape[1]>>>r||n+e.shape[0]>this._shape[0]>>>r||t<0||n<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");s(i,t,n,r,this.format,this.type,this._mipLevels,e)}}},function(e,t,n){function r(e,t){return e[0]-t[0]}function i(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(r);var i=new Array(n.length);for(e=0;e<i.length;++e)i[e]=n[e][1];return i}function o(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var r="generic"===e;if(t===-1){var o="function "+n+"(a){this.data=a;};\tvar proto="+n+".prototype;\tproto.dtype='"+e+"';\tproto.index=function(){return -1};\tproto.size=0;\tproto.dimension=-1;\tproto.shape=proto.stride=proto.order=[];\tproto.lo=proto.hi=proto.transpose=proto.step=\tfunction(){return new "+n+"(this.data);};\tproto.get=proto.set=function(){};\tproto.pick=function(){return null};\treturn function construct_"+n+"(a){return new "+n+"(a);}",a=new Function(o);return a()}if(0===t){var o="function "+n+"(a,d) {\tthis.data = a;\tthis.offset = d\t};\tvar proto="+n+".prototype;\tproto.dtype='"+e+"';\tproto.index=function(){return this.offset};\tproto.dimension=0;\tproto.size=1;\tproto.shape=\tproto.stride=\tproto.order=[];\tproto.lo=\tproto.hi=\tproto.transpose=\tproto.step=function "+n+"_copy() {\treturn new "+n+"(this.data,this.offset)\t};\tproto.pick=function "+n+"_pick(){\treturn TrivialArray(this.data);\t};\tproto.valueOf=proto.get=function "+n+"_get(){\treturn "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};\tproto.set=function "+n+"_set(v){\treturn "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"\t};\treturn function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",a=new Function("TrivialArray",o);return a(f[e][0])}var o=["'use strict'"],s=c(t),u=s.map(function(e){return"i"+e}),l="this.offset+"+s.map(function(e){return"this.stride["+e+"]*i"+e}).join("+"),h=s.map(function(e){return"b"+e}).join(","),d=s.map(function(e){return"c"+e}).join(",");o.push("function "+n+"(a,"+h+","+d+",d){this.data=a","this.shape=["+h+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),o.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){\treturn "+s.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})"),1===t?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),t<4?(o.push("function "+n+"_order(){"),2===t?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);\tif(s0>s1){\tif(s1>s2){\treturn [2,1,0];\t}else if(s0>s2){\treturn [1,2,0];\t}else{\treturn [1,0,2];\t}\t}else if(s0>s2){\treturn [2,0,1];\t}else if(s2>s1){\treturn [0,1,2];\t}else{\treturn [0,2,1];\t}}})")):o.push("ORDER})")),o.push("proto.set=function "+n+"_set("+u.join(",")+",v){"),r?o.push("return this.data.set("+l+",v)}"):o.push("return this.data["+l+"]=v}"),o.push("proto.get=function "+n+"_get("+u.join(",")+"){"),r?o.push("return this.data.get("+l+")}"):o.push("return this.data["+l+"]}"),o.push("proto.index=function "+n+"_index(",u.join(),"){return "+l+"}"),o.push("proto.hi=function "+n+"_hi("+u.join(",")+"){return new "+n+"(this.data,"+s.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+s.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var p=s.map(function(e){return"a"+e+"=this.shape["+e+"]"}),v=s.map(function(e){return"c"+e+"=this.stride["+e+"]"});o.push("proto.lo=function "+n+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+v.join(","));for(var g=0;g<t;++g)o.push("if(typeof i"+g+"==='number'&&i"+g+">=0){\td=i"+g+"|0;\tb+=c"+g+"*d;\ta"+g+"-=d}");o.push("return new "+n+"(this.data,"+s.map(function(e){return"a"+e}).join(",")+","+s.map(function(e){return"c"+e}).join(",")+",b)}"),o.push("proto.step=function "+n+"_step("+u.join(",")+"){var "+s.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+s.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var g=0;g<t;++g)o.push("if(typeof i"+g+"==='number'){\td=i"+g+"|0;\tif(d<0){\tc+=b"+g+"*(a"+g+"-1);\ta"+g+"=ceil(-a"+g+"/d)\t}else{\ta"+g+"=ceil(a"+g+"/d)\t}\tb"+g+"*=d\t}");o.push("return new "+n+"(this.data,"+s.map(function(e){return"a"+e}).join(",")+","+s.map(function(e){return"b"+e}).join(",")+",c)}");for(var m=new Array(t),_=new Array(t),g=0;g<t;++g)m[g]="a[i"+g+"]",_[g]="b[i"+g+"]";o.push("proto.transpose=function "+n+"_transpose("+u+"){"+u.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+m.join(",")+","+_.join(",")+",this.offset)}"),o.push("proto.pick=function "+n+"_pick("+u+"){var a=[],b=[],c=this.offset");for(var g=0;g<t;++g)o.push("if(typeof i"+g+"==='number'&&i"+g+">=0){c=(c+this.stride["+g+"]*i"+g+")|0}else{a.push(this.shape["+g+"]);b.push(this.stride["+g+"])}");o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+s.map(function(e){return"shape["+e+"]"}).join(",")+","+s.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var a=new Function("CTOR_LIST","ORDER",o.join("\n"));return a(f[e],i)}function a(e){if(u(e))return"buffer";if(l)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(e)?"array":"generic"}function s(e,t,n,r){if(void 0===e){var i=f.array[0];return i([])}"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var s=t.length;if(void 0===n){n=new Array(s);for(var c=s-1,u=1;c>=0;--c)n[c]=u,u*=t[c]}if(void 0===r){r=0;for(var c=0;c<s;++c)n[c]<0&&(r-=(t[c]-1)*n[c])}for(var l=a(e),h=f[l];h.length<=s+1;)h.push(o(l,h.length-1));var i=h[s+1];return i(e,t,n,r)}var c=n(83),u=n(84),l="undefined"!=typeof Float64Array,f={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};e.exports=s},function(e,t){"use strict";function n(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}e.exports=n},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function r(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}/*!
	 * Determine if an object is a Buffer
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
e.exports=function(e){return null!=e&&(n(e)||r(e)||!!e._isBuffer)}},function(e,t,n){"use strict";function r(e){if(!e)return s;for(var t=0;t<e.args.length;++t){var n=e.args[t];0===t?e.args[t]={name:n,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:e.args[t]={name:n,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function i(e){return a({args:e.args,pre:r(e.pre),body:r(e.body),post:r(e.proc),funcName:e.funcName})}function o(e){for(var t=[],n=0;n<e.args.length;++n)t.push("a"+n);var r=new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""));return r(i(e))}var a=n(86),s={body:"",args:[],thisVars:[],localVars:[]},c={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in c){var n=c[e];t[e]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:e}),t[e+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a"+n+"=b"},rvalue:!0,funcName:e+"eq"}),t[e+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:e+"s"}),t[e+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a"+n+"=s"},rvalue:!0,funcName:e+"seq"})}}();var u={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in u){var n=u[e];t[e]=o({args:["array","array"],body:{args:["a","b"],body:"a="+n+"b"},funcName:e}),t[e+"eq"]=o({args:["array"],body:{args:["a"],body:"a="+n+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var l={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in l){var n=l[e];t[e]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:e}),t[e+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:e+"s"}),t[e+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a=a"+n+"b"},rvalue:!0,count:2,funcName:e+"eq"}),t[e+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+n+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var f=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<f.length;++e){var n=f[e];t[n]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:n}),t[n+"eq"]=o({args:["array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"})}}();var h=["max","min","atan2","pow"];!function(){for(var e=0;e<h.length;++e){var n=h[e];t[n]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n}),t[n+"s"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n+"s"}),t[n+"eq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"}),t[n+"seq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"seq"})}}();var d=["atan2","pow"];!function(){for(var e=0;e<d.length;++e){var n=d[e];t[n+"op"]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"op"}),t[n+"ops"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"ops"}),t[n+"opeq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opeq"}),t[n+"opseq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opseq"})}}(),t.any=a({args:["array"],pre:s,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),t.all=a({args:["array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),t.sum=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),t.prod=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),t.norm2squared=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),t.norm2=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),t.norminf=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),t.norm1=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),t.sup=a({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.inf=a({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.argmin=a({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.argmax=a({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.random=o({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),t.assign=o({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),t.assigns=o({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),t.equals=a({args:["array","array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},function(e,t,n){"use strict";function r(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function i(e){var t=new r;t.pre=e.pre,t.body=e.body,t.post=e.post;var n=e.args.slice(0);t.argTypes=n;for(var i=0;i<n.length;++i){var a=n[i];if("array"===a||"object"==typeof a&&a.blockIndices){if(t.argTypes[i]="array",t.arrayArgs.push(i),t.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0),t.shimArgs.push("array"+i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array args");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===a)t.scalarArgs.push(i),t.shimArgs.push("scalar"+i);else if("index"===a){if(t.indexArgs.push(i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array index");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array index");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===a){if(t.shapeArgs.push(i),i<t.pre.args.length&&t.pre.args[i].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array shape");if(i<t.post.args.length&&t.post.args[i].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof a||!a.offset)throw new Error("cwise: Unknown argument type "+n[i]);t.argTypes[i]="offset",t.offsetArgs.push({array:a.array,offset:a.offset}),t.offsetArgIndex.push(i)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,o(t)}var o=n(87);e.exports=i},function(e,t,n){"use strict";function r(e){var t=["'use strict'","var CACHED={}"],n=[],r=e.funcName+"_cwise_thunk";t.push(["return function ",r,"(",e.shimArgs.join(","),"){"].join(""));for(var o=[],a=[],s=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")],c=[],u=[],l=0;l<e.arrayArgs.length;++l){var f=e.arrayArgs[l];n.push(["t",f,"=array",f,".dtype,","r",f,"=array",f,".order"].join("")),o.push("t"+f),o.push("r"+f),a.push("t"+f),a.push("r"+f+".join()"),s.push("array"+f+".data"),s.push("array"+f+".stride"),s.push("array"+f+".offset|0"),l>0&&(c.push("array"+e.arrayArgs[0]+".shape.length===array"+f+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[l]))),u.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+f+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[l])+"]"))}e.arrayArgs.length>1&&(t.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}"));for(var l=0;l<e.scalarArgs.length;++l)s.push("scalar"+e.scalarArgs[l]);n.push(["type=[",a.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),t.push("var "+n.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",s.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------");var h=new Function("compile",t.join("\n"));return h(i.bind(void 0,e))}var i=n(88);e.exports=r},function(e,t,n){"use strict";function r(e,t,n){var r,i,o=e.length,a=t.arrayArgs.length,s=t.indexArgs.length>0,c=[],u=[],l=0,f=0;for(r=0;r<o;++r)u.push(["i",r,"=0"].join(""));for(i=0;i<a;++i)for(r=0;r<o;++r)f=l,l=e[r],0===r?u.push(["d",i,"s",r,"=t",i,"p",l].join("")):u.push(["d",i,"s",r,"=(t",i,"p",l,"-s",f,"*t",i,"p",f,")"].join(""));for(c.push("var "+u.join(",")),r=o-1;r>=0;--r)l=e[r],c.push(["for(i",r,"=0;i",r,"<s",l,";++i",r,"){"].join(""));for(c.push(n),r=0;r<o;++r){for(f=l,l=e[r],i=0;i<a;++i)c.push(["p",i,"+=d",i,"s",r].join(""));s&&(r>0&&c.push(["index[",f,"]-=s",f].join("")),c.push(["++index[",l,"]"].join(""))),c.push("}")}return c.join("\n")}function i(e,t,n,i){for(var o=t.length,a=n.arrayArgs.length,s=n.blockSize,c=n.indexArgs.length>0,u=[],l=0;l<a;++l)u.push(["var offset",l,"=p",l].join(""));for(var l=e;l<o;++l)u.push(["for(var j"+l+"=SS[",t[l],"]|0;j",l,">0;){"].join("")),u.push(["if(j",l,"<",s,"){"].join("")),u.push(["s",t[l],"=j",l].join("")),u.push(["j",l,"=0"].join("")),u.push(["}else{s",t[l],"=",s].join("")),u.push(["j",l,"-=",s,"}"].join("")),c&&u.push(["index[",t[l],"]=j",l].join(""));for(var l=0;l<a;++l){for(var f=["offset"+l],h=e;h<o;++h)f.push(["j",h,"*t",l,"p",t[h]].join(""));u.push(["p",l,"=(",f.join("+"),")"].join(""))}u.push(r(t,n,i));for(var l=e;l<o;++l)u.push("}");return u.join("\n")}function o(e){for(var t=0,n=e[0].length;t<n;){for(var r=1;r<e.length;++r)if(e[r][t]!==e[0][t])return t;++t}return t}function a(e,t,n){for(var r=e.body,i=[],o=[],a=0;a<e.args.length;++a){var s=e.args[a];if(!(s.count<=0)){var c=new RegExp(s.name,"g"),u="",l=t.arrayArgs.indexOf(a);switch(t.argTypes[a]){case"offset":var f=t.offsetArgIndex.indexOf(a),h=t.offsetArgs[f];l=h.array,u="+q"+f;case"array":u="p"+l+u;var d="l"+a,p="a"+l;if(0===t.arrayBlockIndices[l])1===s.count?"generic"===n[l]?s.lvalue?(i.push(["var ",d,"=",p,".get(",u,")"].join("")),r=r.replace(c,d),o.push([p,".set(",u,",",d,")"].join(""))):r=r.replace(c,[p,".get(",u,")"].join("")):r=r.replace(c,[p,"[",u,"]"].join("")):"generic"===n[l]?(i.push(["var ",d,"=",p,".get(",u,")"].join("")),r=r.replace(c,d),s.lvalue&&o.push([p,".set(",u,",",d,")"].join(""))):(i.push(["var ",d,"=",p,"[",u,"]"].join("")),r=r.replace(c,d),s.lvalue&&o.push([p,"[",u,"]=",d].join("")));else{for(var v=[s.name],g=[u],m=0;m<Math.abs(t.arrayBlockIndices[l]);m++)v.push("\\s*\\[([^\\]]+)\\]"),g.push("$"+(m+1)+"*t"+l+"b"+m);if(c=new RegExp(v.join(""),"g"),u=g.join("+"),"generic"===n[l])throw new Error("cwise: Generic arrays not supported in combination with blocks!");r=r.replace(c,[p,"[",u,"]"].join(""))}break;case"scalar":r=r.replace(c,"Y"+t.scalarArgs.indexOf(a));break;case"index":r=r.replace(c,"index");break;case"shape":r=r.replace(c,"shape")}}}return[i.join("\n"),r,o.join("\n")].join("\n").trim()}function s(e){for(var t=new Array(e.length),n=!0,r=0;r<e.length;++r){var i=e[r],o=i.match(/\d+/);o=o?o[0]:"",0===i.charAt(0)?t[r]="u"+i.charAt(1)+o:t[r]=i.charAt(0)+o,r>0&&(n=n&&t[r]===t[r-1])}return n?t[0]:t.join("")}function c(e,t){for(var n=t[1].length-Math.abs(e.arrayBlockIndices[0])|0,c=new Array(e.arrayArgs.length),l=new Array(e.arrayArgs.length),f=0;f<e.arrayArgs.length;++f)l[f]=t[2*f],c[f]=t[2*f+1];for(var h=[],d=[],p=[],v=[],g=[],f=0;f<e.arrayArgs.length;++f){e.arrayBlockIndices[f]<0?(p.push(0),v.push(n),h.push(n),d.push(n+e.arrayBlockIndices[f])):(p.push(e.arrayBlockIndices[f]),v.push(e.arrayBlockIndices[f]+n),h.push(0),d.push(e.arrayBlockIndices[f]));for(var m=[],_=0;_<c[f].length;_++)p[f]<=c[f][_]&&c[f][_]<v[f]&&m.push(c[f][_]-p[f]);g.push(m)}for(var y=["SS"],b=["'use strict'"],w=[],_=0;_<n;++_)w.push(["s",_,"=SS[",_,"]"].join(""));for(var f=0;f<e.arrayArgs.length;++f){y.push("a"+f),y.push("t"+f),y.push("p"+f);for(var _=0;_<n;++_)w.push(["t",f,"p",_,"=t",f,"[",p[f]+_,"]"].join(""));for(var _=0;_<Math.abs(e.arrayBlockIndices[f]);++_)w.push(["t",f,"b",_,"=t",f,"[",h[f]+_,"]"].join(""))}for(var f=0;f<e.scalarArgs.length;++f)y.push("Y"+f);if(e.shapeArgs.length>0&&w.push("shape=SS.slice(0)"),e.indexArgs.length>0){for(var E=new Array(n),f=0;f<n;++f)E[f]="0";w.push(["index=[",E.join(","),"]"].join(""))}for(var f=0;f<e.offsetArgs.length;++f){for(var x=e.offsetArgs[f],A=[],_=0;_<x.offset.length;++_)0!==x.offset[_]&&(1===x.offset[_]?A.push(["t",x.array,"p",_].join("")):A.push([x.offset[_],"*t",x.array,"p",_].join("")));0===A.length?w.push("q"+f+"=0"):w.push(["q",f,"=",A.join("+")].join(""))}var T=u([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));w=w.concat(T),b.push("var "+w.join(","));for(var f=0;f<e.arrayArgs.length;++f)b.push("p"+f+"|=0");e.pre.body.length>3&&b.push(a(e.pre,e,l));var S=a(e.body,e,l),R=o(g);R<n?b.push(i(R,g[0],e,S)):b.push(r(g[0],e,S)),e.post.body.length>3&&b.push(a(e.post,e,l)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+b.join("\n")+"\n----------");var C=[e.funcName||"unnamed","_cwise_loop_",c[0].join("s"),"m",R,s(l)].join(""),M=new Function(["function ",C,"(",y.join(","),"){",b.join("\n"),"} return ",C].join(""));return M()}var u=n(89);e.exports=c},function(e,t){"use strict";function n(e,t){for(var n=1,r=e.length,i=e[0],o=e[0],a=1;a<r;++a)if(o=i,i=e[a],t(i,o)){if(a===n){n++;continue}e[n++]=i}return e.length=n,e}function r(e){for(var t=1,n=e.length,r=e[0],i=e[0],o=1;o<n;++o,i=r)if(i=r,r=e[o],r!==i){if(o===t){t++;continue}e[t++]=r}return e.length=t,e}function i(e,t,i){return 0===e.length?e:t?(i||e.sort(t),n(e,t)):(i||e.sort(),r(e))}e.exports=i},function(e,t,n){(function(e,r){"use strict";function i(e){if(e){var t=e.length||e.byteLength,n=_.log2(t);E[n].push(e)}}function o(e){i(e.buffer)}function a(e){var e=_.nextPow2(e),t=_.log2(e),n=E[t];return n.length>0?n.pop():new ArrayBuffer(e)}function s(e){return new Uint8Array(a(e),0,e)}function c(e){return new Uint16Array(a(2*e),0,e)}function u(e){return new Uint32Array(a(4*e),0,e)}function l(e){return new Int8Array(a(e),0,e)}function f(e){return new Int16Array(a(2*e),0,e)}function h(e){return new Int32Array(a(4*e),0,e)}function d(e){return new Float32Array(a(4*e),0,e)}function p(e){return new Float64Array(a(8*e),0,e)}function v(e){return b?new Uint8ClampedArray(a(e),0,e):s(e)}function g(e){return new DataView(a(e),0,e)}function m(e){e=_.nextPow2(e);var t=_.log2(e),n=x[t];return n.length>0?n.pop():new r(e)}var _=n(95),y=n(96);e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:y([32,0]),UINT16:y([32,0]),UINT32:y([32,0]),INT8:y([32,0]),INT16:y([32,0]),INT32:y([32,0]),FLOAT:y([32,0]),DOUBLE:y([32,0]),DATA:y([32,0]),UINT8C:y([32,0]),BUFFER:y([32,0])});var b="undefined"!=typeof Uint8ClampedArray,w=e.__TYPEDARRAY_POOL;w.UINT8C||(w.UINT8C=y([32,0])),w.BUFFER||(w.BUFFER=y([32,0]));var E=w.DATA,x=w.BUFFER;t.free=function(e){if(r.isBuffer(e))x[_.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,n=0|_.log2(t);E[n].push(e)}},t.freeUint8=t.freeUint16=t.freeUint32=t.freeInt8=t.freeInt16=t.freeInt32=t.freeFloat32=t.freeFloat=t.freeFloat64=t.freeDouble=t.freeUint8Clamped=t.freeDataView=o,t.freeArrayBuffer=i,t.freeBuffer=function(e){x[_.log2(e.length)].push(e)},t.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return a(e);switch(t){case"uint8":return s(e);case"uint16":return c(e);case"uint32":return u(e);case"int8":return l(e);case"int16":return f(e);case"int32":return h(e);case"float":case"float32":return d(e);case"double":case"float64":return p(e);case"uint8_clamped":return v(e);case"buffer":return m(e);case"data":case"dataview":return g(e);default:return null}return null},t.mallocArrayBuffer=a,t.mallocUint8=s,t.mallocUint16=c,t.mallocUint32=u,t.mallocInt8=l,t.mallocInt16=f,t.mallocInt32=h,t.mallocFloat32=t.mallocFloat=d,t.mallocFloat64=t.mallocDouble=p,t.mallocUint8Clamped=v,t.mallocDataView=g,t.mallocBuffer=m,t.clearCache=function(){for(var e=0;e<32;++e)w.UINT8[e].length=0,w.UINT16[e].length=0,w.UINT32[e].length=0,w.INT8[e].length=0,w.INT16[e].length=0,w.INT32[e].length=0,w.FLOAT[e].length=0,w.DOUBLE[e].length=0,w.UINT8C[e].length=0,E[e].length=0,x[e].length=0}}).call(t,function(){return this}(),n(91).Buffer)},function(e,t,n){(function(e,r){/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
"use strict";function i(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}function o(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,n){if(o()<n)throw new RangeError("Invalid typed array length");return e.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(n),t.__proto__=e.prototype):(null===t&&(t=new e(n)),t.length=n),t}function e(t,n,r){if(!(e.TYPED_ARRAY_SUPPORT||this instanceof e))return new e(t,n,r);if("number"==typeof t){if("string"==typeof n)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return s(this,t,n,r)}function s(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?d(e,t,n,r):"string"==typeof t?f(e,t,n):p(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,n,r){return c(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}function l(t,n){if(c(n),t=a(t,n<0?0:0|v(n)),!e.TYPED_ARRAY_SUPPORT)for(var r=0;r<n;++r)t[r]=0;return t}function f(t,n,r){if("string"==typeof r&&""!==r||(r="utf8"),!e.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|m(n,r);t=a(t,i);var o=t.write(n,r);return o!==i&&(t=t.slice(0,o)),t}function h(e,t){var n=t.length<0?0:0|v(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(t,n,r,i){if(n.byteLength,r<0||n.byteLength<r)throw new RangeError("'offset' is out of bounds");if(n.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");return n=void 0===r&&void 0===i?new Uint8Array(n):void 0===i?new Uint8Array(n,r):new Uint8Array(n,r,i),e.TYPED_ARRAY_SUPPORT?(t=n,t.__proto__=e.prototype):t=h(t,n),t}function p(t,n){if(e.isBuffer(n)){var r=0|v(n.length);return t=a(t,r),0===t.length?t:(n.copy(t,0,0,r),t)}if(n){if("undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer||"length"in n)return"number"!=typeof n.length||J(n.length)?a(t,0):h(t,n);if("Buffer"===n.type&&Q(n.data))return h(t,n.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function v(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function g(t){return+t!=t&&(t=0),e.alloc(+t)}function m(t,n){if(e.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var i=!1;;)switch(n){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return X(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return W(t).length;default:if(i)return X(t).length;n=(""+n).toLowerCase(),i=!0}}function _(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return P(this,t,n);case"latin1":case"binary":return I(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function b(t,n,r,i,o){if(0===t.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof n&&(n=e.from(n,i)),e.isBuffer(n))return 0===n.length?-1:w(t,n,r,i,o);if("number"==typeof n)return n=255&n,e.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,n,r):Uint8Array.prototype.lastIndexOf.call(t,n,r):w(t,[n],r,i,o);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,i){function o(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,s=e.length,c=t.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}var u;if(i){var l=-1;for(u=n;u<s;u++)if(o(e,u)===o(t,l===-1?0:u-l)){if(l===-1&&(l=u),u-l+1===c)return l*a}else l!==-1&&(u-=u-l),l=-1}else for(n+c>s&&(n=s-c),u=n;u>=0;u--){for(var f=!0,h=0;h<c;h++)if(o(e,u+h)!==o(t,h)){f=!1;break}if(f)return u}return-1}function E(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function x(e,t,n,r){return K(X(t,e.length-n),e,n,r)}function A(e,t,n,r){return K(Y(t),e,n,r)}function T(e,t,n,r){return A(e,t,n,r)}function S(e,t,n,r){return K(W(t),e,n,r)}function R(e,t,n,r){return K(q(t,e.length-n),e,n,r)}function C(e,t,n){return 0===t&&n===e.length?$.fromByteArray(e):$.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o=e[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s<=n){var c,u,l,f;switch(s){case 1:o<128&&(a=o);break;case 2:c=e[i+1],128===(192&c)&&(f=(31&o)<<6|63&c,f>127&&(a=f));break;case 3:c=e[i+1],u=e[i+2],128===(192&c)&&128===(192&u)&&(f=(15&o)<<12|(63&c)<<6|63&u,f>2047&&(f<55296||f>57343)&&(a=f));break;case 4:c=e[i+1],u=e[i+2],l=e[i+3],128===(192&c)&&128===(192&u)&&128===(192&l)&&(f=(15&o)<<18|(63&c)<<12|(63&u)<<6|63&l,f>65535&&f<1114112&&(a=f))}}null===a?(a=65533,s=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),i+=s}return O(r)}function O(e){var t=e.length;if(t<=ee)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=ee));return n}function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function I(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function N(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=H(e[o]);return i}function D(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function L(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function F(t,n,r,i,o,a){if(!e.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>o||n<a)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function k(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function U(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function j(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,r,i){return i||j(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(e,t,n,r,23,4),n+4}function V(e,t,n,r,i){return i||j(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(e,t,n,r,52,8),n+8}function z(e){if(e=G(e).replace(te,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function G(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function H(e){return e<16?"0"+e.toString(16):e.toString(16)}function X(e,t){t=t||1/0;for(var n,r=e.length,i=null,o=[],a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=(i-55296<<10|n-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function Y(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function q(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function W(e){return $.toByteArray(z(e))}function K(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function J(e){return e!==e}var $=n(92),Z=n(93),Q=n(94);t.Buffer=e,t.SlowBuffer=g,t.INSPECT_MAX_BYTES=50,e.TYPED_ARRAY_SUPPORT=void 0!==r.TYPED_ARRAY_SUPPORT?r.TYPED_ARRAY_SUPPORT:i(),t.kMaxLength=o(),e.poolSize=8192,e._augment=function(t){return t.__proto__=e.prototype,t},e.from=function(e,t,n){return s(null,e,t,n)},e.TYPED_ARRAY_SUPPORT&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0})),e.alloc=function(e,t,n){return u(null,e,t,n)},e.allocUnsafe=function(e){return l(null,e)},e.allocUnsafeSlow=function(e){return l(null,e)},e.isBuffer=function(e){return!(null==e||!e._isBuffer)},e.compare=function(t,n){if(!e.isBuffer(t)||!e.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var r=t.length,i=n.length,o=0,a=Math.min(r,i);o<a;++o)if(t[o]!==n[o]){r=t[o],i=n[o];break}return r<i?-1:i<r?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,n){if(!Q(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return e.alloc(0);var r;if(void 0===n)for(n=0,r=0;r<t.length;++r)n+=t[r].length;var i=e.allocUnsafe(n),o=0;for(r=0;r<t.length;++r){var a=t[r];if(!e.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i},e.byteLength=m,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},e.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},e.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},e.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?M(this,0,e):_.apply(this,arguments)},e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===e.compare(this,t)},e.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},e.prototype.compare=function(t,n,r,i,o){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),n<0||r>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&n>=r)return 0;if(i>=o)return-1;if(n>=r)return 1;if(n>>>=0,r>>>=0,i>>>=0,o>>>=0,this===t)return 0;for(var a=o-i,s=r-n,c=Math.min(a,s),u=this.slice(i,o),l=t.slice(n,r),f=0;f<c;++f)if(u[f]!==l[f]){a=u[f],s=l[f];break}return a<s?-1:s<a?1:0},e.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1},e.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},e.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},e.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t=0|t,isFinite(n)?(n=0|n,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return E(this,e,t,n);case"utf8":case"utf-8":return x(this,e,t,n);case"ascii":return A(this,e,t,n);case"latin1":case"binary":return T(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ee=4096;e.prototype.slice=function(t,n){var r=this.length;t=~~t,n=void 0===n?r:~~n,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),n<0?(n+=r,n<0&&(n=0)):n>r&&(n=r),n<t&&(n=t);var i;if(e.TYPED_ARRAY_SUPPORT)i=this.subarray(t,n),i.__proto__=e.prototype;else{var o=n-t;i=new e(o,(void 0));for(var a=0;a<o;++a)i[a]=this[a+t]}return i},e.prototype.readUIntLE=function(e,t,n){e=0|e,t=0|t,n||L(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},e.prototype.readUIntBE=function(e,t,n){e=0|e,t=0|t,n||L(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},e.prototype.readUInt8=function(e,t){return t||L(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return t||L(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return t||L(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return t||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,n){e=0|e,t=0|t,n||L(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},e.prototype.readIntBE=function(e,t,n){e=0|e,t=0|t,n||L(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},e.prototype.readInt8=function(e,t){return t||L(e,1,this.length),128&this[e]?(255-this[e]+1)*-1:this[e]},e.prototype.readInt16LE=function(e,t){t||L(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt16BE=function(e,t){t||L(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt32LE=function(e,t){return t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return t||L(e,4,this.length),Z.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return t||L(e,4,this.length),Z.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return t||L(e,8,this.length),Z.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return t||L(e,8,this.length),Z.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t=0|t,n=0|n,!r){var i=Math.pow(2,8*n)-1;F(this,e,t,n,i,0)}var o=1,a=0;for(this[t]=255&e;++a<n&&(o*=256);)this[t+a]=e/o&255;return t+n},e.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t=0|t,n=0|n,!r){var i=Math.pow(2,8*n)-1;F(this,e,t,n,i,0)}var o=n-1,a=1;for(this[t+o]=255&e;--o>=0&&(a*=256);)this[t+o]=e/a&255;return t+n},e.prototype.writeUInt8=function(t,n,r){return t=+t,n=0|n,r||F(this,t,n,1,255,0),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},e.prototype.writeUInt16LE=function(t,n,r){return t=+t,n=0|n,r||F(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):k(this,t,n,!0),n+2},e.prototype.writeUInt16BE=function(t,n,r){return t=+t,n=0|n,r||F(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):k(this,t,n,!1),n+2},e.prototype.writeUInt32LE=function(t,n,r){return t=+t,n=0|n,r||F(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):U(this,t,n,!0),n+4},e.prototype.writeUInt32BE=function(t,n,r){return t=+t,n=0|n,r||F(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):U(this,t,n,!1),n+4},e.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t=0|t,!r){var i=Math.pow(2,8*n-1);F(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},e.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t=0|t,!r){var i=Math.pow(2,8*n-1);F(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},e.prototype.writeInt8=function(t,n,r){return t=+t,n=0|n,r||F(this,t,n,1,127,-128),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=255&t,n+1},e.prototype.writeInt16LE=function(t,n,r){return t=+t,n=0|n,r||F(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):k(this,t,n,!0),n+2},e.prototype.writeInt16BE=function(t,n,r){return t=+t,n=0|n,r||F(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):k(this,t,n,!1),n+2},e.prototype.writeInt32LE=function(t,n,r){return t=+t,n=0|n,r||F(this,t,n,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):U(this,t,n,!0),n+4},e.prototype.writeInt32BE=function(t,n,r){return t=+t,n=0|n,r||F(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):U(this,t,n,!1),n+4},e.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},e.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},e.prototype.writeDoubleLE=function(e,t,n){return V(this,e,t,!0,n)},e.prototype.writeDoubleBE=function(e,t,n){return V(this,e,t,!1,n)},e.prototype.copy=function(t,n,r,i){if(r||(r=0),i||0===i||(i=this.length),n>=t.length&&(n=t.length),n||(n=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-n<i-r&&(i=t.length-n+r);var o,a=i-r;if(this===t&&r<n&&n<i)for(o=a-1;o>=0;--o)t[o+n]=this[o+r];else if(a<1e3||!e.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)t[o+n]=this[o+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+a),n);return a},e.prototype.fill=function(t,n,r,i){if("string"==typeof t){if("string"==typeof n?(i=n,n=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!e.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t=255&t);if(n<0||this.length<n||this.length<r)throw new RangeError("Out of range index");if(r<=n)return this;n>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0);var a;if("number"==typeof t)for(a=n;a<r;++a)this[a]=t;else{var s=e.isBuffer(t)?t:X(new e(t,i).toString()),c=s.length;for(a=0;a<r-n;++a)this[a+n]=s[a%c]}return this};var te=/[^+\/0-9A-Za-z-_]/g}).call(t,n(91).Buffer,function(){return this}())},function(e,t){"use strict";function n(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;t<n;++t)s[t]=e[t],c[e.charCodeAt(t)]=t;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63}function r(e){var t,n,r,i,o,a,s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[s-2]?2:"="===e[s-1]?1:0,a=new u(3*s/4-o),r=o>0?s-4:s;var l=0;for(t=0,n=0;t<r;t+=4,n+=3)i=c[e.charCodeAt(t)]<<18|c[e.charCodeAt(t+1)]<<12|c[e.charCodeAt(t+2)]<<6|c[e.charCodeAt(t+3)],a[l++]=i>>16&255,a[l++]=i>>8&255,a[l++]=255&i;return 2===o?(i=c[e.charCodeAt(t)]<<2|c[e.charCodeAt(t+1)]>>4,a[l++]=255&i):1===o&&(i=c[e.charCodeAt(t)]<<10|c[e.charCodeAt(t+1)]<<4|c[e.charCodeAt(t+2)]>>2,a[l++]=i>>8&255,a[l++]=255&i),a}function i(e){return s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e]}function o(e,t,n){for(var r,o=[],a=t;a<n;a+=3)r=(e[a]<<16)+(e[a+1]<<8)+e[a+2],o.push(i(r));return o.join("")}function a(e){for(var t,n=e.length,r=n%3,i="",a=[],c=16383,u=0,l=n-r;u<l;u+=c)a.push(o(e,u,u+c>l?l:u+c));return 1===r?(t=e[n-1],i+=s[t>>2],i+=s[t<<4&63],i+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],i+=s[t>>10],i+=s[t>>4&63],i+=s[t<<2&63],i+="="),a.push(i),a.join("")}t.toByteArray=r,t.fromByteArray=a;var s=[],c=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array;n()},function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,c=(1<<s)-1,u=c>>1,l=-7,f=n?i-1:0,h=n?-1:1,d=e[t+f];for(f+=h,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+f],f+=h,l-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:(d?-1:1)*(1/0);a+=Math.pow(2,r),o-=u}return(d?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,c,u=8*o-i-1,l=(1<<u)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),t+=a+f>=1?h/c:h*Math.pow(2,1-f),t*c>=2&&(a++,c/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*c-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[n+d]=255&a,d+=p,a/=256,u-=8);e[n+d-p]|=128*v}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){"use strict";"use restrict";function n(e){var t=32;return e&=-e,e&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}var r=32;t.INT_BITS=r,t.INT_MAX=2147483647,t.INT_MIN=-1<<r-1,t.sign=function(e){return(e>0)-(e<0)},t.abs=function(e){var t=e>>r-1;return(e^t)-t},t.min=function(e,t){return t^(e^t)&-(e<t)},t.max=function(e,t){return e^(e^t)&-(e<t)},t.isPow2=function(e){return!(e&e-1||!e)},t.log2=function(e){var t,n;return t=(e>65535)<<4,e>>>=t,n=(e>255)<<3,e>>>=n,t|=n,n=(e>15)<<2,e>>>=n,t|=n,n=(e>3)<<1,e>>>=n,t|=n,t|e>>1},t.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},t.popCount=function(e){return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24},t.countTrailingZeros=n,t.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1},t.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e-(e>>>1)},t.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,e&=15,27030>>>e&1};var i=new Array(256);!function(e){for(var t=0;t<256;++t){var n=t,r=t,i=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--i;e[t]=r<<i&255}}(i),t.reverse=function(e){return i[255&e]<<24|i[e>>>8&255]<<16|i[e>>>16&255]<<8|i[e>>>24&255]},t.interleave2=function(e,t){return e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},t.deinterleave2=function(e,t){return e=e>>>t&1431655765,e=858993459&(e|e>>>1),e=252645135&(e|e>>>2),e=16711935&(e|e>>>4),e=65535&(e|e>>>16),e<<16>>16},t.interleave3=function(e,t,n){return e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e|=t<<1,n&=1023,n=4278190335&(n|n<<16),n=251719695&(n|n<<8),n=3272356035&(n|n<<4),n=1227133513&(n|n<<2),e|n<<2},t.deinterleave3=function(e,t){return e=e>>>t&1227133513,e=3272356035&(e|e>>>2),e=251719695&(e|e>>>4),e=4278190335&(e|e>>>8),e=1023&(e|e>>>16),e<<22>>22},t.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>n(e)+1}},function(e,t){"use strict";function n(e,t,r){var i=0|e[r];if(i<=0)return[];var o,a=new Array(i);if(r===e.length-1)for(o=0;o<i;++o)a[o]=t;else for(o=0;o<i;++o)a[o]=n(e,t,r+1);return a}function r(e,t){var n,r;for(n=new Array(e),r=0;r<e;++r)n[r]=t;return n}function i(e,t){switch("undefined"==typeof t&&(t=0),typeof e){case"number":if(e>0)return r(0|e,t);break;case"object":if("number"==typeof e.length)return n(e,t,0)}return[]}e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Particles=t.defaults=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(98),u=r(c),l=n(54),f=r(l),h=n(80),d=r(h),p=n(111),v=r(p),g=n(82),m=r(g),_=n(112),y=r(_),b=n(113),w=n(114),E=r(w),x=t.defaults=function(){return{shape:[64,64],geomShape:null,logic:null,logicVert:E["default"],logicFrag:null,render:null,renderVert:null,renderFrag:null}},A=t.Particles=function(){function e(t,n){o(this,e);var r=a({},x(),n);this.gl=t,this.triangle=(0,v["default"])(this.gl),this.shape=r.shape,this.geomShape=r.geomShape||[].concat(i(this.shape));var s=r.logic||[r.logicVert,r.logicFrag];this.logic=Array.isArray(s)?f["default"].apply(void 0,[t].concat(i(s))):s;var c=r.render||[r.renderVert,r.renderFrag];this.render=Array.isArray(c)?f["default"].apply(void 0,[t].concat(i(c))):c,this.geom=(0,u["default"])(t),this.geom.attr("uv",e.generateLUT(this.geomShape),{size:2}),this.buffers=[],this.pixels=(0,m["default"])(new Float32Array(this.shape[0]*this.shape[1]*4),[this.shape[0],this.shape[1],4])}return s(e,[{key:"setup",value:function(){for(var e=arguments.length<=0||void 0===arguments[0]?1:arguments[0];this.buffers.length<e;)this.buffers.push((0,d["default"])(this.gl,[this.shape[0],this.shape[1]],{"float":!0}));for(;this.buffers.length>e;)this.buffers.pop().dispose()}},{key:"spawn",value:function(e){for(var t=arguments.length<=1||void 0===arguments[1]?this.pixels:arguments[1],n=arguments.length<=2||void 0===arguments[2]?[0,0]:arguments[2],r=new Float32Array(4),i=t.shape,o=t.data,a=0,s=0;s<i[0];++s)for(var c=0;c<i[1];++c)r[0]=r[1]=r[2]=r[3]=0,e(r,s,c),o[a++]=r[0],o[a++]=r[1],o[a++]=r[2],o[a++]=r[3];this.buffers.forEach(function(e){return e.color[0].setPixels(t,n)})}},{key:"step",value:function(t){(0,b.step)(this.buffers),this.buffers[0].bind(),this.gl.viewport(0,0,this.shape[0],this.shape[1]),this.logic.bind(),e.applyUpdate(Object.assign(this.logic.uniforms,{dataRes:this.shape,particles:this.buffers[1].color[0].bind(0)}),t),this.triangle.bind(),this.triangle.draw(),this.triangle.unbind(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}},{key:"draw",value:function(t){var n=arguments.length<=1||void 0===arguments[1]?this.gl.POINTS:arguments[1];this.geom.bind(this.render),this.render.uniforms.particles=this.buffers[0].color[0].bind(0),e.applyUpdate(this.render.uniforms,t),this.geom.draw(n)}},{key:"updateLogic",value:function(e){this.logic.update(E["default"],e)}},{key:"updateRender",value:function(e,t){this.render.update(t,e)}},{key:"dispose",value:function(){}}],[{key:"generateLUT",value:function(e){for(var t=e[0]*e[1]*2,n=new Float32Array(t),r=0,i=Math.max(e[0],2),o=Math.max(e[1],2),a=1/(i-1),s=1/(o-1),c=0;c<i;++c)for(var u=0;u<o;++u)n[r++]=c*a,n[r++]=u*s;return n}},{key:"applyUpdate",value:function(e,t){return(0,y["default"])(t)?t(e):Object.assign(e,t)}}]),e}();t["default"]=A},function(e,t,n){function r(e){return this instanceof r?(this._elementsType=5123,this._elementsBytes=2,this._attributes=[],this._dirty=!0,this._attrLength=0,this._facesLength=0,this._index=null,this._vao=null,this._keys=[],void(this.gl=e)):new r(e)}var i=n(99),o=n(106),a=n(107),s=n(105);e.exports=r,r.prototype.dispose=function(){for(var e=0;e<this._attributes.length;e++)this._attributes[e].buffer.dispose();this._attributes=[],this._keys=[],this._attrLength=0,this._facesLength=0,this._dirty=!0,this._index&&(this._index.dispose(),this._index=null),this._vao&&(this._vao.dispose(),this._vao=null)},r.prototype.faces=function(e,t){var n=t&&t.size||3;return e=e.cells?e.cells:e,this._dirty=!0,this._index&&this._index.dispose(),this._index=i.create(this.gl,e,n,this.gl.ELEMENT_ARRAY_BUFFER,"uint16"),this._facesLength=this._index.length*n,this._index=this._index.buffer,this},r.prototype.attr=function(e,t,n){if(t.cells&&t.positions)return this.attr(e,t.positions).faces(t.cells,n);n=n||{};var r=n.size||3,o=this._keys.indexOf(e);if(o>-1){var a=this._attributes[o].buffer,s=n.offset||void 0;return i.update(a,t,r,"float32",s),this._attrLength=a.length/r/4,this}this._dirty=!0;var c=this.gl,u=!this._attributes.length,l=i.create(c,t,r,c.ARRAY_BUFFER,"float32");if(!l)throw new Error("Unexpected attribute format: needs an ndarray, array, typed array, gl-buffer or simplicial complex");var f=l.buffer,h=l.length;return this._keys.push(e),this._attributes.push({size:r,buffer:f}),u&&(this._attrLength=h),this},r.prototype.bind=function(e){if(this.update(),this._vao.bind(),this._keys&&e){for(var t=0;t<this._keys.length;t++){var n=e.attributes[this._keys[t]];n&&(n.location=t)}e.bind()}},r.prototype.draw=function(e,t,n){t="undefined"==typeof t?0:t,e="undefined"==typeof e?this.gl.TRIANGLES:e,this.update(),this._vao._useElements?(n="undefined"==typeof n?this._facesLength:n,this.gl.drawElements(e,n-t,this._elementsType,t*this._elementsBytes)):(n="undefined"==typeof n?this._attrLength:n,this.gl.drawArrays(e,t,n-t))},r.prototype.unbind=function(){this.update(),this._vao.unbind()},r.prototype.update=function(){this._dirty&&(this._dirty=!1,this._vao&&this._vao.dispose(),this._vao=a(this.gl,this._attributes,this._index),this._elementsType=this._vao._elementsType,this._elementsBytes=s(o(this._elementsType)||"array").BYTES_PER_ELEMENT||2)}},function(e,t,n){function r(e,t,n,r,i){if(t.handle instanceof WebGLBuffer)return{buffer:t,length:t.length/n/4};var a=o(t,n,i);return{buffer:l(e,a.data,r),length:a.length}}function i(e,t,n,r,i){if(t.handle instanceof WebGLBuffer)throw new Error("Unhandled update case: WebGLBuffer");var a=o(t,n,r);e.update(a.data,i)}function o(e,t,n){return Array.isArray(e)&&Array.isArray(e[0])?{data:c(e,n),length:e.length}:Array.isArray(e)&&u(e[0])?{data:c(e,n),length:e.length*e[0].length/t}:Array.isArray(e)?{data:new(h(n))(e),length:e.length/t}:f(e)?{data:e,length:a(e.shape)/t}:u(e)?(!n||e instanceof h(n)||(e=s(e,h(n))),{data:e,length:e.length/t}):void 0}function a(e){for(var t=1,n=0;n<e.length;n++)t*=e[n];return t}function s(e,t){for(var n=new t(e.length),r=0;r<e.length;r++)n[r]=e[r];return n}var c=n(100),u=n(102),l=n(103),f=n(104),h=n(105);e.exports.create=r,e.exports.update=i},function(e,t,n){function r(e,t){if(t=t||"float32",!e[0]||!e[0].length)return e;for(var n="string"==typeof t?i(t):t,r=e[0].length,o=new n(e.length*r),a=0,s=0;s<e.length;s++)for(var c=0;c<r;c++)o[a++]=e[s][c];return o}var i=n(101);e.exports=r},function(e,t,n){(function(t){e.exports=function(e){switch(e){case"int8":return Int8Array;
case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray;case"generic":case"data":case"dataview":return ArrayBuffer;case"buffer":return"undefined"==typeof t?ArrayBuffer:t}}}).call(t,n(91).Buffer)},function(e,t){function n(e){return r(e)||i(e)}function r(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function i(e){return a[o.call(e)]}e.exports=n,n.strict=r,n.loose=i;var o=Object.prototype.toString,a={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0}},function(e,t,n){"use strict";function r(e,t,n,r,i){this.gl=e,this.type=t,this.handle=n,this.length=r,this.usage=i}function i(e,t,n,r,i,o){var a=i.length*i.BYTES_PER_ELEMENT;if(o<0)return e.bufferData(t,i,r),a;if(a+o>n)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return e.bufferSubData(t,o,i),n}function o(e,t){for(var n=c.malloc(e.length,t),r=e.length,i=0;i<r;++i)n[i]=e[i];return n}function a(e,t){for(var n=1,r=t.length-1;r>=0;--r){if(t[r]!==n)return!1;n*=e[r]}return!0}function s(e,t,n,i){if(n=n||e.ARRAY_BUFFER,i=i||e.DYNAMIC_DRAW,n!==e.ARRAY_BUFFER&&n!==e.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(i!==e.DYNAMIC_DRAW&&i!==e.STATIC_DRAW&&i!==e.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var o=e.createBuffer(),a=new r(e,n,o,0,i);return a.update(t),a}var c=n(90),u=n(85),l=n(82),f=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"],h=r.prototype;h.bind=function(){this.gl.bindBuffer(this.type,this.handle)},h.unbind=function(){this.gl.bindBuffer(this.type,null)},h.dispose=function(){this.gl.deleteBuffer(this.handle)},h.update=function(e,t){if("number"!=typeof t&&(t=-1),this.bind(),"object"==typeof e&&"undefined"!=typeof e.shape){var n=e.dtype;if(f.indexOf(n)<0&&(n="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var r=gl.getExtension("OES_element_index_uint");n=r&&"uint16"!==n?"uint32":"uint16"}if(n===e.dtype&&a(e.shape,e.stride))0===e.offset&&e.data.length===e.shape[0]?this.length=i(this.gl,this.type,this.length,this.usage,e.data,t):this.length=i(this.gl,this.type,this.length,this.usage,e.data.subarray(e.offset,e.shape[0]),t);else{var s=c.malloc(e.size,n),h=l(s,e.shape);u.assign(h,e),t<0?this.length=i(this.gl,this.type,this.length,this.usage,s,t):this.length=i(this.gl,this.type,this.length,this.usage,s.subarray(0,e.size),t),c.free(s)}}else if(Array.isArray(e)){var d;d=this.type===this.gl.ELEMENT_ARRAY_BUFFER?o(e,"uint16"):o(e,"float32"),t<0?this.length=i(this.gl,this.type,this.length,this.usage,d,t):this.length=i(this.gl,this.type,this.length,this.usage,d.subarray(0,e.length),t),c.free(d)}else if("object"==typeof e&&"number"==typeof e.length)this.length=i(this.gl,this.type,this.length,this.usage,e,t);else{if("number"!=typeof e&&void 0!==e)throw new Error("gl-buffer: Invalid data type");if(t>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");e=0|e,e<=0&&(e=1),this.gl.bufferData(this.type,0|e,this.usage),this.length=e}},e.exports=s},function(e,t){e.exports=function(e){if(!e)return!1;if(!e.dtype)return!1;var t=new RegExp("function View[0-9]+d(:?"+e.dtype+")+");return t.test(String(e.constructor))}},function(e,t){e.exports=function(e){switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array}}},function(e,t){function n(e){switch(e){case 5126:return"float32";case 5125:return"uint32";case 5124:return"int32";case 5123:return"uint16";case 32819:return"uint16";case 32820:return"uint16";case 33635:return"uint16";case 5122:return"int16";case 5121:return"uint8";case 5120:return"int8";default:return null}}e.exports=n},function(e,t,n){"use strict";function r(e){this.bindVertexArrayOES=e.bindVertexArray.bind(e),this.createVertexArrayOES=e.createVertexArray.bind(e),this.deleteVertexArrayOES=e.deleteVertexArray.bind(e)}function i(e,t,n,i){var s,c=e.createVertexArray?new r(e):e.getExtension("OES_vertex_array_object");return s=c?o(e,c):a(e),s.update(t,n,i),s}var o=n(108),a=n(110);e.exports=i},function(e,t,n){"use strict";function r(e,t,n,r,i,o){this.location=e,this.dimension=t,this.a=n,this.b=r,this.c=i,this.d=o}function i(e,t,n){this.gl=e,this._ext=t,this.handle=n,this._attribs=[],this._useElements=!1,this._elementsType=e.UNSIGNED_SHORT}function o(e,t){return new i(e,t,t.createVertexArrayOES())}var a=n(109);r.prototype.bind=function(e){switch(this.dimension){case 1:e.vertexAttrib1f(this.location,this.a);break;case 2:e.vertexAttrib2f(this.location,this.a,this.b);break;case 3:e.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:e.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},i.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var e=0;e<this._attribs.length;++e)this._attribs[e].bind(this.gl)},i.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},i.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},i.prototype.update=function(e,t,n){if(this.bind(),a(this.gl,t,e),this.unbind(),this._attribs.length=0,e)for(var i=0;i<e.length;++i){var o=e[i];"number"==typeof o?this._attribs.push(new r(i,1,o)):Array.isArray(o)&&this._attribs.push(new r(i,o.length,o[0],o[1],o[2],o[3]))}this._useElements=!!t,this._elementsType=n||this.gl.UNSIGNED_SHORT},i.prototype.draw=function(e,t,n){n=n||0;var r=this.gl;this._useElements?r.drawElements(e,t,this._elementsType,n):r.drawArrays(e,n,t)},e.exports=o},function(e,t){"use strict";function n(e,t,n){t?t.bind():e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);var r=0|e.getParameter(e.MAX_VERTEX_ATTRIBS);if(n){if(n.length>r)throw new Error("gl-vao: Too many vertex attributes");for(var i=0;i<n.length;++i){var o=n[i];if(o.buffer){var a=o.buffer,s=o.size||4,c=o.type||e.FLOAT,u=!!o.normalized,l=o.stride||0,f=o.offset||0;a.bind(),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,s,c,u,l,f)}else{if("number"==typeof o)e.vertexAttrib1f(i,o);else if(1===o.length)e.vertexAttrib1f(i,o[0]);else if(2===o.length)e.vertexAttrib2f(i,o[0],o[1]);else if(3===o.length)e.vertexAttrib3f(i,o[0],o[1],o[2]);else{if(4!==o.length)throw new Error("gl-vao: Invalid vertex attribute");e.vertexAttrib4f(i,o[0],o[1],o[2],o[3])}e.disableVertexAttribArray(i)}}for(;i<r;++i)e.disableVertexAttribArray(i)}else{e.bindBuffer(e.ARRAY_BUFFER,null);for(var i=0;i<r;++i)e.disableVertexAttribArray(i)}}e.exports=n},function(e,t,n){"use strict";function r(e){this.gl=e,this._elements=null,this._attributes=null,this._elementsType=e.UNSIGNED_SHORT}function i(e){return new r(e)}var o=n(109);r.prototype.bind=function(){o(this.gl,this._elements,this._attributes)},r.prototype.update=function(e,t,n){this._elements=t,this._attributes=e,this._elementsType=n||this.gl.UNSIGNED_SHORT},r.prototype.dispose=function(){},r.prototype.unbind=function(){},r.prototype.draw=function(e,t,n){n=n||0;var r=this.gl;this._elements?r.drawElements(e,t,this._elementsType,n):r.drawArrays(e,n,t)},e.exports=i},function(e,t,n){function r(e){return this instanceof r?(this.gl=e,void(this.vao=o(e,[{size:2,type:e.FLOAT,buffer:i(e,new Float32Array([-1,-1,-1,4,4,-1]))}]))):new r(e)}var i=n(103),o=n(107);e.exports=r,r.prototype.bind=function(){this.vao.bind()},r.prototype.draw=function(){this.gl.drawArrays(this.gl.TRIANGLES,0,3)},r.prototype.unbind=function(){this.vao.unbind()}},function(e,t,n){function r(e){var t=i(e)?c.call(e):"";return t==o||t==a}var i=n(34),o="[object Function]",a="[object GeneratorFunction]",s=Object.prototype,c=s.toString;e.exports=r},function(e,t){"use strict";function n(e){var t=Array.prototype.pop.call(e);return Array.prototype.unshift.call(e,t),t}Object.defineProperty(t,"__esModule",{value:!0}),t.step=n;var r=1/Math.log(2);t.nextPow2=function(e){return Math.pow(2,Math.ceil(Math.log(e)*r))}},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nvoid main() {\n    gl_Position = vec4(position, 1.0, 1.0);\n}\n"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(116),o=r(i);t["default"]=function(e){return e[0]=e[1]=o["default"],e[2]=e[3]=0,e}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=-1e6},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.maxAspect=t.minAspect=t.aspect=void 0;var i=n(49),o=r(i),a=t.aspect=function(e,t,n){return o["default"].scale(e,o["default"].inverse(e,t),n)};t.minAspect=function(e,t){return a(e,t,Math.min(t[0],t[1]))},t.maxAspect=function(e,t){return a(e,t,Math.max(t[0],t[1]))};t["default"]=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Screen=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function h(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:h(i,t,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},u=n(111),l=r(u),f=t.Screen=function(e){function t(e){var n,r;return i(this,t),r=n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),o(n,r)}return a(t,e),s(t,[{key:"render",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"bind",this).call(this),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unbind",this).call(this)}}]),t}(l["default"]);t["default"]=f},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D particles;\nuniform sampler2D flow;\n\nuniform vec2 dataRes;\n\nuniform vec2 viewSize;\n\nuniform float time;\nuniform float dt;\n\nuniform float minSpeed;\nuniform float maxSpeed;\nuniform float damping;\n\nuniform float flowDecay;\n\nuniform float noiseSpeed;\nuniform float noiseScale;\n\nuniform float forceWeight;\nuniform float flowWeight;\nuniform float wanderWeight;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nconst vec2 inert = vec2(-1000000.0);\n\n/**\n * @requires {float} levels The number of samples to take at different LODs\n * @requires {float} stride The step up to take between each LOD\n */\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec2 map(vec2 value, vec2 inMin, vec2 inMax, vec2 outMin, vec2 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec3 map(vec3 value, vec3 inMin, vec3 inMax, vec3 outMin, vec3 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec4 map(vec4 value, vec4 inMin, vec4 inMax, vec4 outMin, vec4 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nconst vec4 posRange = vec4(-1.0, -1.0, 1.0, 1.0);\n\nconst vec4 uvRange = vec4(0.0, 0.0, 1.0, 1.0);\n\nvec2 posToUV(vec2 pos) {\n    return map(pos, posRange.xy, posRange.zw, uvRange.xy, uvRange.zw);\n}\n\n// Time/decay\n\nvec2 get(vec3 data, float time, float decay) {\n    return data.xy*max(0.0, 1.0-((time-data.z)*decay));\n}\n\nvec2 get(vec4 data, float time, float decay) {\n    return get(data.xyz, time, decay);\n}\n\n// No time/decay\n\nvec2 get(vec2 data) {\n    return data.xy;\n}\n\nvec2 get(vec3 data) {\n    return get(data.xy);\n}\n\nvec2 get(vec4 data) {\n    return get(data.xy);\n}\n\n/**\n * @return The flow velocity and age for a given screen position, sampling\n *         several scales.\n */\nvec2 flowAtScreenPos(vec2 pos, sampler2D flow, float time, float flowDecay) {\n    vec2 uv = posToUV(pos);\n    vec2 flowForce = vec2(0.0);\n    float flowMax = 0.0;\n\n    for(float level = 0.0; level < 1.0*1.0; level += 1.0) {\n        vec4 flowData = texture2D(flow, uv, level);\n        float factor = 1.0/(level+1.0);\n\n        flowForce += get(flowData, time, flowDecay)*factor;\n        flowMax += factor;\n    }\n\n    return flowForce/flowMax;\n}\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy/dataRes;\n\n    vec4 state = texture2D(particles, uv);\n    vec2 pos = state.xy;\n    vec2 vel = state.zw;\n\n    vec2 newPos = pos;\n    vec2 newVel = vel;\n\n    if(pos != inert) {\n        // Wander force\n\n        vec2 noisePos = pos*noiseScale;\n        float noiseTime = time*noiseSpeed;\n\n        vec2 wanderForce = vec2(snoise(vec3(noisePos, uv.x+noiseTime)),\n                snoise(vec3(noisePos, uv.y+noiseTime+1234.5678)));\n\n        // Flow force - left by preceeding particles\n        // (Ensure this is checked before the next flow step is rendered, to avoid\n        // self-influence.)\n\n        vec2 flowForce = flowAtScreenPos(pos*viewSize, flow, time, flowDecay);\n\n        // Accumulate weighted forces and damping\n        newVel = (vel*damping*dt)+\n            (forceWeight*\n                ((flowForce*flowWeight*dt)+\n                    (wanderForce*wanderWeight*dt)));\n        \n        // Normalize and clamp the velocity\n        /**\n         * @todo This seems to cause some problems when dealing with larger max\n         *       speeds - the particles no longer follow flow forces somehow...\n         */\n        float speed = length(newVel);\n\n        newVel *= min(speed, maxSpeed)/speed;\n\n        // Integrate motion\n        newPos = pos+newVel;\n    }\n\n    gl_FragColor = vec4(newPos, newVel);\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D previous;\nuniform sampler2D particles;\n\nuniform vec2 dataRes;\n\nuniform vec2 viewSize;\n\nuniform float speedAlpha;\n\nattribute vec2 uv;\n\nvarying float speedRate;\n\nconst vec2 inert = vec2(-1000000.0);\n\nfloat length2(vec2 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec3 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec4 vec) {\n    return dot(vec, vec);\n}\n\nconst float frameOffset = 0.25;\n\n/**\n * For every data point, we have two vertices - current and previous state.\n * Every other vertex looks up previous data. In this way, (vertical)\n * neighbours alternate from previous to current state.\n * (Vertical neighbours, because WebGL iterates column-major.)\n *\n * @return State data for the vertex, either current or previous.\n */\n\nvec4 stateAtFrame(vec2 uv, vec2 shape, sampler2D previous, sampler2D current) {\n    float nearIndex = uv.y*shape.y;\n    float offset = fract(nearIndex);\n    vec2 lookup = vec2(uv.x, floor(nearIndex)/shape.y);\n\n    return texture2D(((offset > frameOffset)? current : previous), lookup);\n}\n\nvoid main() {\n    vec4 state = stateAtFrame(uv, dataRes, previous, particles);\n\n    if(state.xy != inert) {\n        speedRate = min(length2(state.zw)/speedAlpha, 1.0);\n\n        gl_Position = vec4(state.xy*viewSize, 0.0, 1.0);\n    }\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvarying float speedRate;\n\nvoid main() {\n    gl_FragColor = vec4(color.rgb, color.a*speedRate);\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D previous;\nuniform sampler2D data;\n\nuniform vec2 dataRes;\n\nuniform vec2 viewSize;\n\nuniform float time;\nuniform float maxSpeed;\nuniform float flowDecay;\n\nattribute vec2 uv;\n\nvarying vec4 color;\n\n/**\n * @requires {float} time The current time in ms\n */\n\nvec4 flow(vec2 vel) {\n    // Faster particles leave a greater influence (opacity).\n    // Linear interpolation - inaccurate for vectors, will it be OK without\n    // sudden turns, or do we need a per-fragment lookup?\n    return vec4(vel, time, length(vel));\n}\n\nvec4 flow(vec2 vel, float maxSpeed) {\n    vec4 values = flow(vel);\n\n    return vec4(values.xyz, min(values.a/maxSpeed, 1.0));\n}\n\n/**\n * @requires `./head.vert`\n * @requires {function} apply A function applying a `vec4` state into a `vec3`\n *                            color to be drawn.\n */\n\nconst vec2 inert = vec2(-1000000.0);\n\nconst float frameOffset = 0.25;\n\n/**\n * For every data point, we have two vertices - current and previous state.\n * Every other vertex looks up previous data. In this way, (vertical)\n * neighbours alternate from previous to current state.\n * (Vertical neighbours, because WebGL iterates column-major.)\n *\n * @return State data for the vertex, either current or previous.\n */\n\nvec4 stateAtFrame(vec2 uv, vec2 shape, sampler2D previous, sampler2D current) {\n    float nearIndex = uv.y*shape.y;\n    float offset = fract(nearIndex);\n    vec2 lookup = vec2(uv.x, floor(nearIndex)/shape.y);\n\n    return texture2D(((offset > frameOffset)? current : previous), lookup);\n}\n\nvoid main() {\n    vec4 state = stateAtFrame(uv, dataRes, previous, data);\n\n    if(state.xy != inert) {\n        gl_Position = vec4(state.xy*viewSize, 1.0, 1.0);\n        color = flow(state.zw, maxSpeed);\n    }\n}\n\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D previous;\nuniform sampler2D data;\n\nuniform vec2 dataRes;\n\nuniform vec2 viewSize;\n\nuniform float time;\nuniform float maxSpeed;\nuniform float flowDecay;\n\nattribute vec2 uv;\n\nvarying vec4 color;\n\n/**\n * @requires {float} time The current time in ms\n * @requires {float} flowDecay The amount the flow decays over time\n */\n\nfloat length2(vec2 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec3 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec4 vec) {\n    return dot(vec, vec);\n}\n\nvec4 flow(vec2 vel) {\n    return vec4(((vel*100.0)+vec2(1.0))*0.5, sin(time*flowDecay), length2(vel));\n}\n\nvec4 flow(vec2 vel, float maxSpeed) {\n    vec4 values = flow(vel);\n\n    return vec4(values.xyz, min(values.a/(maxSpeed*maxSpeed), 1.0));\n}\n\n/**\n * @requires `./head.vert`\n * @requires {function} apply A function applying a `vec4` state into a `vec3`\n *                            color to be drawn.\n */\n\nconst vec2 inert = vec2(-1000000.0);\n\nconst float frameOffset = 0.25;\n\n/**\n * For every data point, we have two vertices - current and previous state.\n * Every other vertex looks up previous data. In this way, (vertical)\n * neighbours alternate from previous to current state.\n * (Vertical neighbours, because WebGL iterates column-major.)\n *\n * @return State data for the vertex, either current or previous.\n */\n\nvec4 stateAtFrame(vec2 uv, vec2 shape, sampler2D previous, sampler2D current) {\n    float nearIndex = uv.y*shape.y;\n    float offset = fract(nearIndex);\n    vec2 lookup = vec2(uv.x, floor(nearIndex)/shape.y);\n\n    return texture2D(((offset > frameOffset)? current : previous), lookup);\n}\n\nvoid main() {\n    vec4 state = stateAtFrame(uv, dataRes, previous, data);\n\n    if(state.xy != inert) {\n        gl_Position = vec4(state.xy*viewSize, 1.0, 1.0);\n        color = flow(state.zw, maxSpeed);\n    }\n}\n\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 color;\n\nvoid main() {\n    // @todo SDF from line, to weaken force further away\n    gl_FragColor = color.rgba;\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n    gl_FragColor = color.rgba;\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D view;\nuniform vec2 viewRes;\nuniform float opacity;\n\n// #pragma glslify: fxaa = require(glsl-fxaa)\n\nvoid main() {\n    vec4 fragment = texture2D(view, gl_FragCoord.xy/viewRes);\n    // vec4 fragment = fxaa(view, gl_FragCoord.xy, viewRes);\n\n    float a = opacity*fragment.a;\n    // float a = pow(fragment.a, opacity);\n    // float a = pow(opacity, fragment.a);\n\n    gl_FragColor = mix(vec4(0.0), fragment, clamp(a, 0.0, 1.0));\n    // gl_FragColor = vec4(fragment.rgb, clamp(a, 0.0, 1.0));\n}\n"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(t.pipe=function(e,t){return e.reduce(function(e,t){return t(e)},t)},t.compose=function(e,t){return e.reduceRight(function(e,t){return t(e)},t)},t.reduce=function(e,t,n){return void 0===n?Array.prototype.reduce.call(t,e):Array.prototype.reduce.call(t,e,n)});t.map=function(e,t){var r=arguments.length<=2||void 0===arguments[2]?[]:arguments[2];return n(function(n,r,i){return n[i]=e(r,i,t),n},t,r)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SpawnPixels=t.defaults=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(80),u=r(c),l=n(54),f=r(l),h=n(47),d=r(h),p=n(49),v=r(p),g=n(117),m=r(g),_=n(114),y=r(_),b=n(129),w=r(b),E=t.defaults=function(){return{shader:[y["default"],w["default"]],buffer:[[1,1],{"float":!0}],spawnSize:[1,1]}},x=t.SpawnPixels=function(){function e(t,n){o(this,e),this.gl=t;var r=a({},E(),n);this.shader=Array.isArray(r.shader)?f["default"].apply(void 0,[this.gl].concat(i(r.shader))):r.shader,this.buffer=Array.isArray(r.buffer)?u["default"].apply(void 0,[this.gl].concat(i(r.buffer))):r.buffer,this.jitterRad=4,this.jitter=v["default"].create(),this.spawnSize=r.spawnSize,this.spawnMatrix=d["default"].create()}return s(e,[{key:"update",value:function(e){return Object.assign(e,{spawnData:this.buffer.color[0].bind(1),spawnSize:this.spawnSize,spawnMatrix:this.spawnMatrix,jitter:(0,m["default"])(this.jitter,e.viewRes,this.jitterRad),bias:1})}},{key:"respawn",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?this.update.bind(this):arguments[1];return e.respawnShader(this.shader,t)}},{key:"setPixels",value:function(e){return this.buffer.color[0].setPixels(e)}}]),e}();t["default"]=x},function(e,t){e.exports="/**\n * Tries a number of times to randomly select a pixel scored highest by a given\n * function.\n *\n * @todo Break this up more so we can use the same basic logic to filter images\n *       differently. Seems to be a problem using `glslify-import` here; it\n *       doesn't recognise `node_modules` imports any more, thinks they're\n *       relative; we'll see later about that.\n */\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D particles;\nuniform sampler2D spawnData;\n\nuniform vec2 dataRes;\n\nuniform vec2 spawnSize;\n\nuniform vec2 jitter;\nuniform float time;\n\n// Over 1 favours changing to new data; under 1 favours current data.\nuniform float bias;\n\nuniform mat3 spawnMatrix;\n\n/**\n * Directly uses a normal image - brightness being speed in a direction defined\n * by the `rgba` channels.\n */\n\nconst vec4 k = vec4(0.0, -1.0/3.0, 2.0/3.0, -1.0);\nconst float e = 1.0e-10;\n\nvec3 rgb2hsv(vec3 c) {\n    vec4 p = ((c.g < c.b)? vec4(c.bg, k.wz) : vec4(c.gb, k.xy));\n    vec4 q = ((c.r < p.x)? vec4(p.xyw, c.r) : vec4(c.r, p.yzx));\n\n    float d = q.x-min(q.w, q.y);\n\n    return vec3(abs(q.z+(q.w-q.y)/(6.0*d+e)), d/(q.x+e), q.x);\n}\n\nconst float tau = 6.28318530717958647692;\n\nvec2 angleToPos(float rad) {\n    return vec2(cos(rad), sin(rad));\n}\n\nvec4 apply(vec2 uv, vec2 pos, vec4 pixel) {\n    vec3 hsv = rgb2hsv(pixel.rgb);\n\n    return vec4(pos, angleToPos(hsv.r*hsv.g*hsv.b*tau)*hsv.g*hsv.b*pixel.a);\n}\n\n// @todo Tweak shape of vignette falloff.\n\nfloat length2(vec2 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec3 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec4 vec) {\n    return dot(vec, vec);\n}\n\nconst vec2 midUV = vec2(0.5);\nconst float limit = 0.5*0.5;\n\nvec4 pass(vec2 uv, vec4 pixel) {\n    return vec4(pixel*max(0.0, limit-length2(uv-midUV)));\n}\n\n// const float limit = 0.5;\n\n// vec4 pass(vec2 uv, vec4 pixel) {\n//     return vec4(pixel*max(0.0, limit-length(uv-midUV)));\n// }\n\n/**\n * A way to easily compose filter passes on the pixel before applying it.\n *\n * @see `../../../filter/`\n * @see `./`\n * @requires {function} pass The filter pass function, given the pixel.\n * @requires {function} apply The apply function, given the result of `pass`.\n */\n\nvec4 compose(vec2 uv, vec2 pos, vec4 pixel) {\n    return apply(uv, pos, pass(uv, pixel));\n}\n\n/**\n * Pick the Highest velocity.\n * Uses the same data structure as the particles.\n */\n\nfloat test(vec4 data) {\n    return length2(data.zw);\n}\n\nconst float samples = 5.0;\n\n/**\n * Tries a number of times to randomly select a pixel scored highest by a given\n * function.\n *\n * @requires {function} apply A function that transforms a `vec4` of data into a\n *                            valid `vec4` state.\n * @requires {function} test A function that returns a float value for a given\n                             `vec4` state; greater values win the comparison.\n *\n * @todo Some bug with `glslify-import` & sons breaks `node_mosules` aliased\n *       `require`s in `import`ed files, so we need to do it the looooooong way.\n */\n// #pragma glslify: random = require(glsl-random)\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec2 map(vec2 value, vec2 inMin, vec2 inMax, vec2 outMin, vec2 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec3 map(vec3 value, vec3 inMin, vec3 inMax, vec3 outMin, vec3 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec4 map(vec4 value, vec4 inMin, vec4 inMax, vec4 outMin, vec4 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nconst vec4 uvRange = vec4(0.0, 0.0, 1.0, 1.0);\n\nconst vec4 posRange = vec4(-1.0, -1.0, 1.0, 1.0);\n\nvec2 uvToPos(vec2 uv) {\n    return map(uv, uvRange.xy, uvRange.zw, posRange.xy, posRange.zw);\n}\n\nfloat transform(mat2 m, float v) {\n    return (m*vec2(v, 1.0)).x;\n}\n\nvec2 transform(mat3 m, vec2 v) {\n    return (m*vec3(v, 1.0)).xy;\n}\n\nvec3 transform(mat4 m, vec3 v) {\n    return (m*vec4(v, 1.0)).xyz;\n}\n\nconst vec2 flipUV = vec2(1.0, -1.0);\n\nvec2 spawnToPos(vec2 uv) {\n    // Jittering around a UV cell to get rid of boxy scaled sampling artefacts\n    vec2 off = mix(-jitter, jitter, random(uv+time*0.001));\n\n    return transform(spawnMatrix, uvToPos(uv+off)*flipUV*spawnSize);\n}\n\nvec4 pick(vec4 current, vec4 next) {\n    return ((test(current) > bias*test(next))? current : next);\n}\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy/dataRes;\n    vec4 state = texture2D(particles, uv);\n\n    for(float n = 0.0; n < samples; n += 1.0) {\n        vec4 off = state+vec4(n+1.2345+time*0.001);\n        vec2 spawnUV = mod(vec2(random(off.xy+uv), random(off.zw+uv)), 1.0);\n\n        state = pick(state,\n            compose(spawnUV, spawnToPos(spawnUV), texture2D(spawnData, spawnUV)));\n    }\n\n    gl_FragColor = state;\n}\n";
},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D particles;\nuniform sampler2D spawnData;\n\nuniform vec2 dataRes;\n\nuniform vec2 spawnSize;\n\nuniform vec2 jitter;\nuniform float time;\n\n// Over 1 favours changing to new data; under 1 favours current data.\nuniform float bias;\n\nuniform mat3 spawnMatrix;\n\nuniform float flowDecay;\n\n/**\n * Use the pixel position, and the particle velocity.\n * Same data structure as the flow.\n *\n * @requires {float} time The current time\n * @requires {float} decay The rate of decay of the flow over time\n */\n\n// Time/decay\n\nvec2 get(vec3 data, float time, float decay) {\n    return data.xy*max(0.0, 1.0-((time-data.z)*decay));\n}\n\nvec2 get(vec4 data, float time, float decay) {\n    return get(data.xyz, time, decay);\n}\n\n// No time/decay\n\nvec2 get(vec2 data) {\n    return data.xy;\n}\n\nvec2 get(vec3 data) {\n    return get(data.xy);\n}\n\nvec2 get(vec4 data) {\n    return get(data.xy);\n}\n\nvec4 apply(vec2 uv, vec2 pos, vec4 pixel) {\n    return vec4(pos, get(pixel, time, flowDecay));\n}\n\n/**\n * Pick the Highest velocity.\n * Uses the same data structure as the particles.\n */\n\nfloat length2(vec2 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec3 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec4 vec) {\n    return dot(vec, vec);\n}\n\nfloat test(vec4 data) {\n    return length2(data.zw);\n}\n\nconst float samples = 5.0;\n\n/**\n * Tries a number of times to randomly select a pixel scored highest by a given\n * function.\n *\n * @requires {function} apply A function that transforms a `vec4` of data into a\n *                            valid `vec4` state.\n * @requires {function} test A function that returns a float value for a given\n                             `vec4` state; greater values win the comparison.\n *\n * @todo Some bug with `glslify-import` & sons breaks `node_mosules` aliased\n *       `require`s in `import`ed files, so we need to do it the looooooong way.\n */\n// #pragma glslify: random = require(glsl-random)\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec2 map(vec2 value, vec2 inMin, vec2 inMax, vec2 outMin, vec2 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec3 map(vec3 value, vec3 inMin, vec3 inMax, vec3 outMin, vec3 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec4 map(vec4 value, vec4 inMin, vec4 inMax, vec4 outMin, vec4 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nconst vec4 uvRange = vec4(0.0, 0.0, 1.0, 1.0);\n\nconst vec4 posRange = vec4(-1.0, -1.0, 1.0, 1.0);\n\nvec2 uvToPos(vec2 uv) {\n    return map(uv, uvRange.xy, uvRange.zw, posRange.xy, posRange.zw);\n}\n\nfloat transform(mat2 m, float v) {\n    return (m*vec2(v, 1.0)).x;\n}\n\nvec2 transform(mat3 m, vec2 v) {\n    return (m*vec3(v, 1.0)).xy;\n}\n\nvec3 transform(mat4 m, vec3 v) {\n    return (m*vec4(v, 1.0)).xyz;\n}\n\nconst vec2 flipUV = vec2(1.0, -1.0);\n\nvec2 spawnToPos(vec2 uv) {\n    // Jittering around a UV cell to get rid of boxy scaled sampling artefacts\n    vec2 off = mix(-jitter, jitter, random(uv+time*0.001));\n\n    return transform(spawnMatrix, uvToPos(uv+off)*flipUV*spawnSize);\n}\n\nvec4 pick(vec4 current, vec4 next) {\n    return ((test(current) > bias*test(next))? current : next);\n}\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy/dataRes;\n    vec4 state = texture2D(particles, uv);\n\n    for(float n = 0.0; n < samples; n += 1.0) {\n        vec4 off = state+vec4(n+1.2345+time*0.001);\n        vec2 spawnUV = mod(vec2(random(off.xy+uv), random(off.zw+uv)), 1.0);\n\n        state = pick(state,\n            apply(spawnUV, spawnToPos(spawnUV), texture2D(spawnData, spawnUV)));\n    }\n\n    gl_FragColor = state;\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D particles;\nuniform sampler2D spawnData;\n\nuniform vec2 dataRes;\n\nuniform vec2 spawnSize;\n\nuniform vec2 jitter;\nuniform float time;\n\n// Over 1 favours changing to new data; under 1 favours current data.\nuniform float bias;\n\nuniform mat3 spawnMatrix;\n\n/**\n * Identity\n */\nvec4 apply(vec2 uv, vec2 pos, vec4 pixel) {\n    return pixel;\n}\n\n// @todo Tweak shape of vignette falloff.\n\nfloat length2(vec2 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec3 vec) {\n    return dot(vec, vec);\n}\n\nfloat length2(vec4 vec) {\n    return dot(vec, vec);\n}\n\nconst vec2 midUV = vec2(0.5);\nconst float limit = 0.5*0.5;\n\nvec4 pass(vec2 uv, vec4 pixel) {\n    return vec4(pixel*max(0.0, limit-length2(uv-midUV)));\n}\n\n// const float limit = 0.5;\n\n// vec4 pass(vec2 uv, vec4 pixel) {\n//     return vec4(pixel*max(0.0, limit-length(uv-midUV)));\n// }\n\n/**\n * A way to easily compose filter passes on the pixel before applying it.\n *\n * @see `../../../filter/`\n * @see `./`\n * @requires {function} pass The filter pass function, given the pixel.\n * @requires {function} apply The apply function, given the result of `pass`.\n */\n\nvec4 compose(vec2 uv, vec2 pos, vec4 pixel) {\n    return apply(uv, pos, pass(uv, pixel));\n}\n\n/**\n * Pick the Highest velocity.\n * Uses the same data structure as the particles.\n */\n\nfloat test(vec4 data) {\n    return length2(data.zw);\n}\n\nconst float samples = 3.0;\n\n/**\n * Tries a number of times to randomly select a pixel scored highest by a given\n * function.\n *\n * @requires {function} apply A function that transforms a `vec4` of data into a\n *                            valid `vec4` state.\n * @requires {function} test A function that returns a float value for a given\n                             `vec4` state; greater values win the comparison.\n *\n * @todo Some bug with `glslify-import` & sons breaks `node_mosules` aliased\n *       `require`s in `import`ed files, so we need to do it the looooooong way.\n */\n// #pragma glslify: random = require(glsl-random)\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec2 map(vec2 value, vec2 inMin, vec2 inMax, vec2 outMin, vec2 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec3 map(vec3 value, vec3 inMin, vec3 inMax, vec3 outMin, vec3 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvec4 map(vec4 value, vec4 inMin, vec4 inMax, vec4 outMin, vec4 outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nconst vec4 uvRange = vec4(0.0, 0.0, 1.0, 1.0);\n\nconst vec4 posRange = vec4(-1.0, -1.0, 1.0, 1.0);\n\nvec2 uvToPos(vec2 uv) {\n    return map(uv, uvRange.xy, uvRange.zw, posRange.xy, posRange.zw);\n}\n\nfloat transform(mat2 m, float v) {\n    return (m*vec2(v, 1.0)).x;\n}\n\nvec2 transform(mat3 m, vec2 v) {\n    return (m*vec3(v, 1.0)).xy;\n}\n\nvec3 transform(mat4 m, vec3 v) {\n    return (m*vec4(v, 1.0)).xyz;\n}\n\nconst vec2 flipUV = vec2(1.0, -1.0);\n\nvec2 spawnToPos(vec2 uv) {\n    // Jittering around a UV cell to get rid of boxy scaled sampling artefacts\n    vec2 off = mix(-jitter, jitter, random(uv+time*0.001));\n\n    return transform(spawnMatrix, uvToPos(uv+off)*flipUV*spawnSize);\n}\n\nvec4 pick(vec4 current, vec4 next) {\n    return ((test(current) > bias*test(next))? current : next);\n}\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy/dataRes;\n    vec4 state = texture2D(particles, uv);\n\n    for(float n = 0.0; n < samples; n += 1.0) {\n        vec4 off = state+vec4(n+1.2345+time*0.001);\n        vec2 spawnUV = mod(vec2(random(off.xy+uv), random(off.zw+uv)), 1.0);\n\n        state = pick(state,\n            compose(spawnUV, spawnToPos(spawnUV), texture2D(spawnData, spawnUV)));\n    }\n\n    gl_FragColor = state;\n}\n"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.spawnBall=t.defaults=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(133),s=i(a),c=n(135),u=r(c),l=t.defaults=function(){return{shader:[s.defaults().shader[0],u["default"]],uniforms:{radius:1,speed:0}}},f=t.spawnBall=function(e,t){return s.spawner(e,o({},l(),t))};t["default"]=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.spawner=t.defaults=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(54),s=r(a),c=n(114),u=r(c),l=n(134),f=r(l),h=t.defaults=function(){return{shader:[u["default"],f["default"]],uniforms:null}},d=t.spawner=function(e,t){var n=o({},h(),t);return{gl:e,uniforms:n.uniforms,shader:Array.isArray(n.shader)?s["default"].apply(void 0,[e].concat(i(n.shader))):n.shader,respawn:function(e){e.respawnShader(this.shader,this.uniforms)}}};t["default"]=d},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nconst vec2 inert = vec2(-1000000.0);\n\nconst vec2 pos = vec2(inert);\nconst vec2 vel = vec2(0.0);\n\nvoid main() {\n    gl_FragColor = vec4(pos, vel);\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform float radius;\nuniform float speed;\n\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nvec2 angleToPos(float rad) {\n    return vec2(cos(rad), sin(rad));\n}\n\nconst float tau = 6.28318530717958647692;\n\nvoid main() {\n    vec4 randoms = vec4(random(gl_FragCoord.xy*1.7654+2.3675),\n        random(gl_FragCoord.xy*1.23494+0.36434),\n        random(gl_FragCoord.xy*0.327789+3.498787),\n        random(gl_FragCoord.xy*9.0374+0.2773));\n\n    gl_FragColor = vec4(angleToPos(randoms.x*tau)*randoms.y*radius,\n        angleToPos(randoms.z*tau)*randoms.w*speed);\n}\n"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.FlowLine=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(137),c=r(s),u=n(248),l=r(u),f=n(249),h=r(f),d=function(e,t){return e<0?t+e:e%t},p=t.FlowLine=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];i(this,e),this.line=new c["default"](t,o({shader:[l["default"],h["default"]],uniforms:o({},(0,s.defaults)().uniforms,{speed:3,maxSpeed:.01,rad:.1,crestShape:.6}),attributes:o({},(0,s.defaults)().attributes,{previous:{getSize:function(e){return e.vertSize}},time:{size:1},dt:{size:1}})},n)),this.times=n.times||[],this.drawnTimes=null}return a(e,[{key:"update",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.setAttributes.bind(this):arguments[0];return this.drawnTimes=this.line.closed&&this.line.path.length?this.times.concat(this.times[0]):this.times,this.line.update(e),this}},{key:"draw",value:function(){var e;return(e=this.line).draw.apply(e,arguments),this}},{key:"setAttributes",value:function(e,t,n,r){r.setAttributes(e,t,n,r);var i=r.closed?d(t.path-1,r.path.length):Math.max(0,t.path-1);n.previous.data.set(r.path[i],t.data*n.previous.size);var o=this.drawnTimes[t.path];n.time.data[t.data]=o,n.dt.data[t.data]=o-this.drawnTimes[i]}},{key:"trimOld",value:function(e){for(var t=arguments.length<=1||void 0===arguments[1]?Date.now():arguments[1],n=this.times,r=this.line.path,i=t-e;n[0]<i;)n.shift(),r.shift();return this}}]),e}();t["default"]=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Line=t.defaults=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(98),u=r(c),l=n(138),f=r(l),h=n(54),d=r(h),p=n(145),v=r(p),g=n(246),m=r(g),_=n(247),y=r(_),b=t.defaults=function(){return{shader:[m["default"],y["default"]],uniforms:{color:[1,1,1,1],rad:.1,viewSize:[1,1]},attributes:null,vertNum:2,vertSize:2,path:[],closed:!1}},w=t.Line=function(){function e(t,n){var r=this;o(this,e);var s=a({},b(),n);this.gl=t,this.uniforms=s.uniforms,this.shader=Array.isArray(s.shader)?d["default"].apply(void 0,[t].concat(i(s.shader))):s.shader,this.vertNum=s.vertNum,this.vertSize=s.vertSize,this.path=s.path||[],this.closed=s.closed,this.attributes=a({position:{data:null,getSize:function(){return r.vertSize}},normal:{data:null,getSize:function(){return r.vertSize}},miter:{data:null,size:1}},s.attributes),this.drawnPath=this.drawnNormals=null,this.geom=(0,u["default"])(t)}return s(e,[{key:"update",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?this.setAttributes:arguments[0];this.drawnPath=this.path,this.drawnNormals=(0,f["default"])(this.drawnPath,this.closed),this.closed&&this.path.length&&(this.drawnPath=this.drawnPath.concat(this.drawnPath[0]),this.drawnNormals.push(this.drawnNormals[0])),this.initAttributes();for(var n=this.drawnPath,r=this.drawnNormals,i=this.attributes,o=this.vertNum,a={},s={},c=0,u=r.length;c<u;++c){var l=r[c];a.point=n[c],a.normal=l[0],a.miter=l[1],s.path=c,s.point=c*o;for(var h=0;h<o;++h)s.vert=h,s.data=s.point+h,t(a,s,i,this)}return(0,v["default"])(i,function(t,n){return e.geom.attr(n,t.data,{size:t.size})}),this}},{key:"draw",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.gl.TRIANGLE_STRIP:arguments[0];if(this.path.length>0){var t;this.geom.bind(this.shader),Object.assign(this.shader.uniforms,this.uniforms);for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.geom).draw.apply(t,[e].concat(r))}return this}},{key:"initAttributes",value:function(){var e=this,t=this.drawnPath.length*this.vertNum,n=this.attributes;return(0,v["default"])(n,function(n){n.getSize&&(n.size=n.getSize(e));var r=t*n.size;n.data&&n.data.length===r||(n.data=new Float32Array(r))}),this}},{key:"setAttributes",value:function(e,t,n){n.position.data.set(e.point,t.data*n.position.size),n.normal.data.set(e.normal,t.data*n.normal.size),n.miter.data[t.data]=e.miter*(t.data%2*2-1)}}]),e}();t["default"]=w},function(e,t,n){function r(e,t,n){e.push([[t[0],t[1]],n])}var i=n(139),o=[0,0],a=[0,0],s=[0,0],c=[0,0];e.exports=function(e,t){var n=null,u=[];t&&(e=e.slice(),e.push(e[0]));for(var l=e.length,f=1;f<l;f++){var h=e[f-1],d=e[f],p=f<e.length-1?e[f+1]:null;if(i.direction(o,d,h),n||(n=[0,0],i.normal(n,o)),1===f&&r(u,n,1),p){i.direction(a,p,d);var v=i.computeMiter(s,c,o,a,1);r(u,c,v)}else i.normal(n,o),r(u,n,1)}if(e.length>2&&t){var g=e[l-2],m=e[0],_=e[1];i.direction(o,m,g),i.direction(a,_,m),i.normal(n,o);var y=i.computeMiter(s,c,o,a,1);u[0][0]=c.slice(),u[l-1][0]=c.slice(),u[0][1]=y,u[l-1][1]=y,u.pop()}return u}},function(e,t,n){var r=n(140),i=n(141),o=n(142),a=n(143),s=n(144),c=[0,0];e.exports.computeMiter=function(e,t,n,a,u){return r(e,n,a),o(e,e),i(t,-e[1],e[0]),i(c,-n[1],n[0]),u/s(t,c)},e.exports.normal=function(e,t){return i(e,-t[1],t[0]),e},e.exports.direction=function(e,t,n){return a(e,t,n),o(e,e),e}},function(e,t){function n(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}e.exports=n},function(e,t){function n(e,t,n){return e[0]=t,e[1]=n,e}e.exports=n},function(e,t){function n(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e}e.exports=n},function(e,t){function n(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}e.exports=n},function(e,t){function n(e,t){return e[0]*t[0]+e[1]*t[1]}e.exports=n},function(e,t,n){function r(e,t){return e&&i(e,o(t,3))}var i=n(146),o=n(162);e.exports=r},function(e,t,n){function r(e,t){return e&&i(e,t,o)}var i=n(147),o=n(149);e.exports=r},function(e,t,n){var r=n(148),i=r();e.exports=i},function(e,t){function n(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(n(o[c],c,o)===!1)break}return t}}e.exports=n},function(e,t,n){function r(e){return a(e)?i(e):o(e)}var i=n(150),o=n(158),a=n(154);e.exports=r},function(e,t,n){function r(e,t){var n=a(e)||o(e)?i(e.length,String):[],r=n.length,c=!!r;for(var l in e)!t&&!u.call(e,l)||c&&("length"==l||s(l,r))||n.push(l);return n}var i=n(151),o=n(152),a=n(156),s=n(157),c=Object.prototype,u=c.hasOwnProperty;e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}e.exports=n},function(e,t,n){function r(e){return i(e)&&s.call(e,"callee")&&(!u.call(e,"callee")||c.call(e)==o)}var i=n(153),o="[object Arguments]",a=Object.prototype,s=a.hasOwnProperty,c=a.toString,u=a.propertyIsEnumerable;e.exports=r},function(e,t,n){function r(e){return o(e)&&i(e)}var i=n(154),o=n(40);e.exports=r},function(e,t,n){function r(e){return null!=e&&o(e.length)&&!i(e)}var i=n(112),o=n(155);e.exports=r},function(e,t){function n(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}var r=9007199254740991;e.exports=n},function(e,t){var n=Array.isArray;e.exports=n},function(e,t){function n(e,t){return t=null==t?r:t,!!t&&("number"==typeof e||i.test(e))&&e>-1&&e%1==0&&e<t}var r=9007199254740991,i=/^(?:0|[1-9]\d*)$/;e.exports=n},function(e,t,n){function r(e){if(!i(e))return o(e);var t=[];for(var n in Object(e))s.call(e,n)&&"constructor"!=n&&t.push(n);return t}var i=n(159),o=n(160),a=Object.prototype,s=a.hasOwnProperty;e.exports=r},function(e,t){function n(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||r;return e===n}var r=Object.prototype;e.exports=n},function(e,t,n){var r=n(161),i=r(Object.keys,Object);e.exports=i},function(e,t){function n(e,t){return function(n){return e(t(n))}}e.exports=n},function(e,t,n){function r(e){return"function"==typeof e?e:null==e?a:"object"==typeof e?s(e)?o(e[0],e[1]):i(e):c(e)}var i=n(163),o=n(229),a=n(242),s=n(156),c=n(243);e.exports=r},function(e,t,n){function r(e){var t=o(e);return 1==t.length&&t[0][2]?a(t[0][0],t[0][1]):function(n){return n===e||i(n,e,t)}}var i=n(164),o=n(226),a=n(228);e.exports=r},function(e,t,n){function r(e,t,n,r){var c=n.length,u=c,l=!r;if(null==e)return!u;for(e=Object(e);c--;){var f=n[c];if(l&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++c<u;){f=n[c];var h=f[0],d=e[h],p=f[1];if(l&&f[2]){if(void 0===d&&!(h in e))return!1}else{var v=new i;if(r)var g=r(d,p,h,e,t,v);if(!(void 0===g?o(p,d,r,a|s,v):g))return!1}}return!0}var i=n(165),o=n(202),a=1,s=2;e.exports=r},function(e,t,n){function r(e){this.__data__=new i(e)}var i=n(166),o=n(174),a=n(175),s=n(176),c=n(177),u=n(178);r.prototype.clear=o,r.prototype["delete"]=a,r.prototype.get=s,r.prototype.has=c,r.prototype.set=u,e.exports=r},function(e,t,n){function r(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var i=n(167),o=n(168),a=n(171),s=n(172),c=n(173);r.prototype.clear=i,r.prototype["delete"]=o,r.prototype.get=a,r.prototype.has=s,r.prototype.set=c,e.exports=r},function(e,t){function n(){this.__data__=[]}e.exports=n},function(e,t,n){function r(e){var t=this.__data__,n=i(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():a.call(t,n,1),!0}var i=n(169),o=Array.prototype,a=o.splice;e.exports=r},function(e,t,n){function r(e,t){for(var n=e.length;n--;)if(i(e[n][0],t))return n;return-1}var i=n(170);e.exports=r},function(e,t){function n(e,t){return e===t||e!==e&&t!==t}e.exports=n},function(e,t,n){function r(e){var t=this.__data__,n=i(t,e);return n<0?void 0:t[n][1]}var i=n(169);e.exports=r},function(e,t,n){function r(e){return i(this.__data__,e)>-1}var i=n(169);e.exports=r},function(e,t,n){function r(e,t){var n=this.__data__,r=i(n,e);return r<0?n.push([e,t]):n[r][1]=t,this}var i=n(169);e.exports=r},function(e,t,n){function r(){this.__data__=new i}var i=n(166);e.exports=r},function(e,t){function n(e){return this.__data__["delete"](e)}e.exports=n},function(e,t){function n(e){return this.__data__.get(e)}e.exports=n},function(e,t){function n(e){return this.__data__.has(e)}e.exports=n},function(e,t,n){function r(e,t){var n=this.__data__;if(n instanceof i){var r=n.__data__;if(!o||r.length<s-1)return r.push([e,t]),this;n=this.__data__=new a(r)}return n.set(e,t),this}var i=n(166),o=n(179),a=n(187),s=200;e.exports=r},function(e,t,n){var r=n(180),i=n(36),o=r(i,"Map");e.exports=o},function(e,t,n){function r(e,t){var n=o(e,t);return i(n)?n:void 0}var i=n(181),o=n(186);e.exports=r},function(e,t,n){function r(e){if(!s(e)||a(e))return!1;var t=i(e)||o(e)?v:l;return t.test(c(e))}var i=n(112),o=n(182),a=n(183),s=n(34),c=n(185),u=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,f=Function.prototype,h=Object.prototype,d=f.toString,p=h.hasOwnProperty,v=RegExp("^"+d.call(p).replace(u,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=r},function(e,t){function n(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}e.exports=n},function(e,t,n){function r(e){return!!o&&o in e}var i=n(184),o=function(){var e=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=r},function(e,t,n){var r=n(36),i=r["__core-js_shared__"];e.exports=i},function(e,t){function n(e){if(null!=e){try{return i.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var r=Function.prototype,i=r.toString;e.exports=n},function(e,t){function n(e,t){return null==e?void 0:e[t]}e.exports=n},function(e,t,n){function r(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var i=n(188),o=n(196),a=n(199),s=n(200),c=n(201);r.prototype.clear=i,r.prototype["delete"]=o,r.prototype.get=a,r.prototype.has=s,r.prototype.set=c,e.exports=r},function(e,t,n){function r(){this.__data__={hash:new i,map:new(a||o),string:new i}}var i=n(189),o=n(166),a=n(179);e.exports=r},function(e,t,n){function r(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var i=n(190),o=n(192),a=n(193),s=n(194),c=n(195);r.prototype.clear=i,r.prototype["delete"]=o,r.prototype.get=a,r.prototype.has=s,r.prototype.set=c,e.exports=r},function(e,t,n){function r(){this.__data__=i?i(null):{}}var i=n(191);e.exports=r},function(e,t,n){var r=n(180),i=r(Object,"create");e.exports=i},function(e,t){function n(e){return this.has(e)&&delete this.__data__[e]}e.exports=n},function(e,t,n){function r(e){var t=this.__data__;if(i){var n=t[e];return n===o?void 0:n}return s.call(t,e)?t[e]:void 0}var i=n(191),o="__lodash_hash_undefined__",a=Object.prototype,s=a.hasOwnProperty;e.exports=r},function(e,t,n){function r(e){var t=this.__data__;return i?void 0!==t[e]:a.call(t,e)}var i=n(191),o=Object.prototype,a=o.hasOwnProperty;e.exports=r},function(e,t,n){function r(e,t){var n=this.__data__;return n[e]=i&&void 0===t?o:t,this}var i=n(191),o="__lodash_hash_undefined__";e.exports=r},function(e,t,n){function r(e){return i(this,e)["delete"](e)}var i=n(197);e.exports=r},function(e,t,n){function r(e,t){var n=e.__data__;return i(t)?n["string"==typeof t?"string":"hash"]:n.map}var i=n(198);e.exports=r},function(e,t){function n(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}e.exports=n},function(e,t,n){function r(e){return i(this,e).get(e)}var i=n(197);e.exports=r},function(e,t,n){function r(e){return i(this,e).has(e)}var i=n(197);e.exports=r},function(e,t,n){function r(e,t){return i(this,e).set(e,t),this}var i=n(197);e.exports=r},function(e,t,n){function r(e,t,n,s,c){return e===t||(null==e||null==t||!o(e)&&!a(t)?e!==e&&t!==t:i(e,t,r,n,s,c))}var i=n(203),o=n(34),a=n(40);e.exports=r},function(e,t,n){function r(e,t,n,r,g,_){var y=u(e),b=u(t),w=p,E=p;y||(w=c(e),w=w==d?v:w),b||(E=c(t),E=E==d?v:E);var x=w==v&&!l(e),A=E==v&&!l(t),T=w==E;if(T&&!x)return _||(_=new i),y||f(e)?o(e,t,n,r,g,_):a(e,t,w,n,r,g,_);if(!(g&h)){var S=x&&m.call(e,"__wrapped__"),R=A&&m.call(t,"__wrapped__");if(S||R){var C=S?e.value():e,M=R?t.value():t;return _||(_=new i),n(C,M,r,g,_)}}return!!T&&(_||(_=new i),s(e,t,n,r,g,_))}var i=n(165),o=n(204),a=n(209),s=n(214),c=n(215),u=n(156),l=n(182),f=n(221),h=2,d="[object Arguments]",p="[object Array]",v="[object Object]",g=Object.prototype,m=g.hasOwnProperty;e.exports=r},function(e,t,n){function r(e,t,n,r,c,u){var l=c&s,f=e.length,h=t.length;if(f!=h&&!(l&&h>f))return!1;var d=u.get(e);if(d&&u.get(t))return d==t;var p=-1,v=!0,g=c&a?new i:void 0;for(u.set(e,t),u.set(t,e);++p<f;){var m=e[p],_=t[p];if(r)var y=l?r(_,m,p,t,e,u):r(m,_,p,e,t,u);if(void 0!==y){if(y)continue;v=!1;break}if(g){if(!o(t,function(e,t){if(!g.has(t)&&(m===e||n(m,e,r,c,u)))return g.add(t)})){v=!1;break}}else if(m!==_&&!n(m,_,r,c,u)){v=!1;break}}return u["delete"](e),u["delete"](t),v}var i=n(205),o=n(208),a=1,s=2;e.exports=r},function(e,t,n){function r(e){var t=-1,n=e?e.length:0;for(this.__data__=new i;++t<n;)this.add(e[t])}var i=n(187),o=n(206),a=n(207);r.prototype.add=r.prototype.push=o,r.prototype.has=a,e.exports=r},function(e,t){function n(e){return this.__data__.set(e,r),this}var r="__lodash_hash_undefined__";e.exports=n},function(e,t){function n(e){return this.__data__.has(e)}e.exports=n},function(e,t){function n(e,t){for(var n=-1,r=e?e.length:0;++n<r;)if(t(e[n],n,e))return!0;return!1}e.exports=n},function(e,t,n){function r(e,t,n,r,i,x,T){switch(n){case E:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case w:return!(e.byteLength!=t.byteLength||!r(new o(e),new o(t)));case h:case d:case g:return a(+e,+t);case p:return e.name==t.name&&e.message==t.message;case m:case y:return e==t+"";case v:var S=c;case _:var R=x&f;if(S||(S=u),e.size!=t.size&&!R)return!1;var C=T.get(e);if(C)return C==t;x|=l,T.set(e,t);var M=s(S(e),S(t),r,i,x,T);return T["delete"](e),M;case b:if(A)return A.call(e)==A.call(t)}return!1}var i=n(210),o=n(211),a=n(170),s=n(204),c=n(212),u=n(213),l=1,f=2,h="[object Boolean]",d="[object Date]",p="[object Error]",v="[object Map]",g="[object Number]",m="[object RegExp]",_="[object Set]",y="[object String]",b="[object Symbol]",w="[object ArrayBuffer]",E="[object DataView]",x=i?i.prototype:void 0,A=x?x.valueOf:void 0;e.exports=r},function(e,t,n){var r=n(36),i=r.Symbol;e.exports=i},function(e,t,n){var r=n(36),i=r.Uint8Array;e.exports=i},function(e,t){function n(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}e.exports=n},function(e,t){function n(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}e.exports=n},function(e,t,n){function r(e,t,n,r,a,c){var u=a&o,l=i(e),f=l.length,h=i(t),d=h.length;if(f!=d&&!u)return!1;for(var p=f;p--;){var v=l[p];if(!(u?v in t:s.call(t,v)))return!1}var g=c.get(e);if(g&&c.get(t))return g==t;var m=!0;c.set(e,t),c.set(t,e);for(var _=u;++p<f;){v=l[p];var y=e[v],b=t[v];if(r)var w=u?r(b,y,v,t,e,c):r(y,b,v,e,t,c);if(!(void 0===w?y===b||n(y,b,r,a,c):w)){m=!1;break}_||(_="constructor"==v)}if(m&&!_){var E=e.constructor,x=t.constructor;E!=x&&"constructor"in e&&"constructor"in t&&!("function"==typeof E&&E instanceof E&&"function"==typeof x&&x instanceof x)&&(m=!1)}return c["delete"](e),c["delete"](t),m}var i=n(149),o=2,a=Object.prototype,s=a.hasOwnProperty;e.exports=r},function(e,t,n){var r=n(216),i=n(179),o=n(217),a=n(218),s=n(219),c=n(220),u=n(185),l="[object Map]",f="[object Object]",h="[object Promise]",d="[object Set]",p="[object WeakMap]",v="[object DataView]",g=Object.prototype,m=g.toString,_=u(r),y=u(i),b=u(o),w=u(a),E=u(s),x=c;(r&&x(new r(new ArrayBuffer(1)))!=v||i&&x(new i)!=l||o&&x(o.resolve())!=h||a&&x(new a)!=d||s&&x(new s)!=p)&&(x=function(e){var t=m.call(e),n=t==f?e.constructor:void 0,r=n?u(n):void 0;if(r)switch(r){case _:return v;case y:return l;case b:return h;case w:return d;case E:return p}return t}),e.exports=x},function(e,t,n){var r=n(180),i=n(36),o=r(i,"DataView");e.exports=o},function(e,t,n){var r=n(180),i=n(36),o=r(i,"Promise");e.exports=o},function(e,t,n){var r=n(180),i=n(36),o=r(i,"Set");e.exports=o},function(e,t,n){var r=n(180),i=n(36),o=r(i,"WeakMap");e.exports=o},function(e,t){function n(e){return i.call(e)}var r=Object.prototype,i=r.toString;e.exports=n},function(e,t,n){var r=n(222),i=n(223),o=n(224),a=o&&o.isTypedArray,s=a?i(a):r;e.exports=s},function(e,t,n){function r(e){return o(e)&&i(e.length)&&!!O[I.call(e)]}var i=n(155),o=n(40),a="[object Arguments]",s="[object Array]",c="[object Boolean]",u="[object Date]",l="[object Error]",f="[object Function]",h="[object Map]",d="[object Number]",p="[object Object]",v="[object RegExp]",g="[object Set]",m="[object String]",_="[object WeakMap]",y="[object ArrayBuffer]",b="[object DataView]",w="[object Float32Array]",E="[object Float64Array]",x="[object Int8Array]",A="[object Int16Array]",T="[object Int32Array]",S="[object Uint8Array]",R="[object Uint8ClampedArray]",C="[object Uint16Array]",M="[object Uint32Array]",O={};O[w]=O[E]=O[x]=O[A]=O[T]=O[S]=O[R]=O[C]=O[M]=!0,O[a]=O[s]=O[y]=O[c]=O[b]=O[u]=O[l]=O[f]=O[h]=O[d]=O[p]=O[v]=O[g]=O[m]=O[_]=!1;var P=Object.prototype,I=P.toString;e.exports=r},function(e,t){function n(e){return function(t){return e(t)}}e.exports=n},function(e,t,n){(function(e){var r=n(37),i="object"==typeof t&&t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=o&&o.exports===i,s=a&&r.process,c=function(){try{return s&&s.binding("util")}catch(e){}}();e.exports=c}).call(t,n(225)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){function r(e){for(var t=o(e),n=t.length;n--;){var r=t[n],a=e[r];t[n]=[r,a,i(a)]}return t}var i=n(227),o=n(149);e.exports=r},function(e,t,n){function r(e){return e===e&&!i(e)}var i=n(34);e.exports=r},function(e,t){function n(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}e.exports=n},function(e,t,n){function r(e,t){return s(e)&&c(t)?u(l(e),t):function(n){var r=o(n,e);return void 0===r&&r===t?a(n,e):i(t,r,void 0,f|h)}}var i=n(202),o=n(230),a=n(239),s=n(237),c=n(227),u=n(228),l=n(238),f=1,h=2;e.exports=r},function(e,t,n){function r(e,t,n){var r=null==e?void 0:i(e,t);return void 0===r?n:r}var i=n(231);e.exports=r},function(e,t,n){function r(e,t){t=o(t,e)?[t]:i(t);for(var n=0,r=t.length;null!=e&&n<r;)e=e[a(t[n++])];return n&&n==r?e:void 0;
}var i=n(232),o=n(237),a=n(238);e.exports=r},function(e,t,n){function r(e){return i(e)?e:o(e)}var i=n(156),o=n(233);e.exports=r},function(e,t,n){var r=n(234),i=n(235),o=/^\./,a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,c=r(function(e){e=i(e);var t=[];return o.test(e)&&t.push(""),e.replace(a,function(e,n,r,i){t.push(r?i.replace(s,"$1"):n||e)}),t});e.exports=c},function(e,t,n){function r(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a),a};return n.cache=new(r.Cache||i),n}var i=n(187),o="Expected a function";r.Cache=i,e.exports=r},function(e,t,n){function r(e){return null==e?"":i(e)}var i=n(236);e.exports=r},function(e,t,n){function r(e){if("string"==typeof e)return e;if(o(e))return c?c.call(e):"";var t=e+"";return"0"==t&&1/e==-a?"-0":t}var i=n(210),o=n(39),a=1/0,s=i?i.prototype:void 0,c=s?s.toString:void 0;e.exports=r},function(e,t,n){function r(e,t){if(i(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||(s.test(e)||!a.test(e)||null!=t&&e in Object(t))}var i=n(156),o=n(39),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=r},function(e,t,n){function r(e){if("string"==typeof e||i(e))return e;var t=e+"";return"0"==t&&1/e==-o?"-0":t}var i=n(39),o=1/0;e.exports=r},function(e,t,n){function r(e,t){return null!=e&&o(e,t,i)}var i=n(240),o=n(241);e.exports=r},function(e,t){function n(e,t){return null!=e&&t in Object(e)}e.exports=n},function(e,t,n){function r(e,t,n){t=c(t,e)?[t]:i(t);for(var r,f=-1,h=t.length;++f<h;){var d=l(t[f]);if(!(r=null!=e&&n(e,d)))break;e=e[d]}if(r)return r;var h=e?e.length:0;return!!h&&u(h)&&s(d,h)&&(a(e)||o(e))}var i=n(232),o=n(152),a=n(156),s=n(157),c=n(237),u=n(155),l=n(238);e.exports=r},function(e,t){function n(e){return e}e.exports=n},function(e,t,n){function r(e){return a(e)?i(s(e)):o(e)}var i=n(244),o=n(245),a=n(237),s=n(238);e.exports=r},function(e,t){function n(e){return function(t){return null==t?void 0:t[e]}}e.exports=n},function(e,t,n){function r(e){return function(t){return i(t,e)}}var i=n(231);e.exports=r},function(e,t){e.exports="/**\n * Drawing lines in a vertex shader, from https://mattdesl.svbtle.com/drawing-lines-is-hard#expanding-in-a-vertex-shader_2\n * Pushes a point along its normal by its radius.\n */\n\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec2 normal;\nattribute float miter;\n\nuniform float rad;\nuniform vec2 viewSize;\n\nvarying float sdf;\n\n/**\n * Drawing lines, from https://mattdesl.svbtle.com/drawing-lines-is-hard#expanding-in-a-vertex-shader_2\n * Pushes a point along its normal by its radius, in the direction of miter.\n */\n\nvec2 expand(vec2 position, vec2 normal, float rad, float miter) {\n    return position+(normal*rad*miter);\n}\n\nvoid main() {\n    vec2 pos = expand(position, normal, rad, miter);\n\n    sdf = sign(miter);\n\n    gl_Position = vec4(pos*viewSize, 0.0, 1.0);\n}\n"},function(e,t){e.exports="/**\n * For a smooth line, check distance from line per-fragment.\n */\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvarying float sdf;\n\nvoid main() {\n    gl_FragColor = vec4(color.rgb, color.a-abs(sdf));\n}\n"},function(e,t){e.exports="/**\n * Drawing lines in a vertex shader, from https://mattdesl.svbtle.com/drawing-lines-is-hard#expanding-in-a-vertex-shader_2\n * Pushes a point along its normal by its radius.\n */\n\nprecision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec2 normal;\nattribute float miter;\n\nuniform float rad;\nuniform vec2 viewSize;\n\nuniform float speed;\nuniform float maxSpeed;\n// uniform float time;\n\nattribute vec2 previous;\nattribute float time;\nattribute float dt;\n\nvarying vec4 values;\nvarying vec2 crest;\nvarying float sdf;\n\n/**\n * @requires {float} time The current time in ms\n */\n\nvec4 flow(vec2 vel) {\n    // Faster particles leave a greater influence (opacity).\n    // Linear interpolation - inaccurate for vectors, will it be OK without\n    // sudden turns, or do we need a per-fragment lookup?\n    return vec4(vel, time, length(vel));\n}\n\nvec4 flow(vec2 vel, float maxSpeed) {\n    vec4 values = flow(vel);\n\n    return vec4(values.xyz, min(values.a/maxSpeed, 1.0));\n}\n\n// #pragma glslify: flow = require(../flow/apply/screen, time = time, flowDecay = 0.001)\n\nvec2 perp(vec2 vec) {\n    return vec2(-vec.y, vec.x);\n}\n\nvec2 perp(vec2 vec, bool anti) {\n    return ((anti)? vec2(vec.y, -vec.x) : perp(vec));\n}\n\n/**\n * Drawing lines, from https://mattdesl.svbtle.com/drawing-lines-is-hard#expanding-in-a-vertex-shader_2\n * Pushes a point along its normal by its radius, in the direction of miter.\n */\n\nvec2 expand(vec2 position, vec2 normal, float rad, float miter) {\n    return position+(normal*rad*miter);\n}\n\nvoid main() {\n    sdf = sign(miter);\n\n    float rate = speed/max(dt, 1.0);\n\n    // @note For some reason, using these have different effects.\n    vec2 vel = (position-previous)*rate;\n    // vec2 vel = perp(normal, true)*length(position-previous)*rate;\n\n    values = flow(vel, maxSpeed);\n\n    crest = normal*miter;\n\n    vec2 vert = expand(position, normal, rad*values.a, miter);\n\n    gl_Position = vec4(vert*viewSize, 0.0, 1.0);\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\n// Where the crest limit is (0 is the path direction, 1 is perpendicular/away).\nuniform float crestShape;\n\nvarying vec4 values;\nvarying vec2 crest;\nvarying float sdf;\n\nvoid main() {\n    float d = abs(sdf);\n    float speed = length(values.rg)*(1.0-d);\n\n    vec2 vel = normalize(mix(values.rg, crest, d*crestShape))*speed;\n\n    gl_FragColor = vec4(vel, values.b, values.a-d);\n}\n"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.makeData=function(e){var t=arguments.length<=1||void 0===arguments[1]?Uint8Array:arguments[1];return new t((e.analyser?e.analyser[0]||e.analyser:e[0]||e).frequencyBinCount)};t["default"]=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.makeOrderLog=t.makeLog=void 0;var i=n(252),o=r(i),a=t.makeLog=function(e){var t=arguments.length<=1||void 0===arguments[1]?function(){return[]}:arguments[1];return(0,o["default"])(e,t)},s=t.makeOrderLog=function(e){var t=arguments.length<=1||void 0===arguments[1]?a:arguments[1];return(0,o["default"])(e,function(n){return t(e-n)})};t["default"]=s},function(e,t,n){function r(e,t){if(e=a(e),e<1||e>s)return[];var n=c,r=u(e,c);t=i(t),e-=c;for(var l=o(r,t);++n<e;)t(n);return l}var i=n(162),o=n(151),a=n(253),s=9007199254740991,c=4294967295,u=Math.min;e.exports=r},function(e,t,n){function r(e){var t=i(e),n=t%1;return t===t?n?t-n:t:0}var i=n(254);e.exports=r},function(e,t,n){function r(e){if(!e)return 0===e?e:0;if(e=i(e),e===o||e===-o){var t=e<0?-1:1;return t*a}return e===e?e:0}var i=n(38),o=1/0,a=1.7976931348623157e308;e.exports=r},function(e,t,n){"use strict";function r(e){for(var t=arguments.length<=1||void 0===arguments[1]?1:arguments[1],n=1,r=e.length;n<r;++n)s(e[n-1][1],e[n-1][0],t,(0,a.step)(e[n]));return e}Object.defineProperty(t,"__esModule",{value:!0}),t.weightedMean=t.mean=t.weightedSum=t.sum=t.peakPos=t.peak=t.logRates=void 0,t.orderLogRates=r;var i=n(256),o=n(127),a=n(113),s=t.logRates=function(e,t,n){var r=arguments.length<=3||void 0===arguments[3]?new Uint8Array(e.length):arguments[3];return(0,o.map)(function(e,r){return(0,i.eulerDyDt)(e,t[r],n)},e,r)},c=(t.peak=function(e){return(0,o.reduce)(function(e,t){return Math.max(Math.abs(t),e)},e,-1)},t.peakPos=function(e){return(0,o.reduce)(function(e,t,n){var r=Math.abs(t);return r>e.peak&&(e.peak=r,e.pos=n),e},e,{peak:-1,pos:-1})},t.sum=function(e){return(0,o.reduce)(function(e,t){return e+Math.abs(t)},e,0)}),u=t.weightedSum=function(e,t){return(0,o.reduce)(function(n,r,i){return n+Math.abs(r*(1-Math.abs(i-t)/(e.length-1)))},e,0)};t.mean=function(e){return c(e)/e.length},t.weightedMean=function(e,t){return u(e,t)/e.length}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.euler=function(e,t,n){return t+e*n};t.eulerDyDt=function(e,t,n){return(t-e)/n};t["default"]=n}]);
//# sourceMappingURL=tendrils.js.map